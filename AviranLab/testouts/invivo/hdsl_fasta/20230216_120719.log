2023-02-16 12:07 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/invivo.shape
              fasta: data/Manfredonia_2020/XML/invivo.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-16 12:07 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/invivo.shape
	fasta: data/Manfredonia_2020/XML/invivo.fa

Configuration parameters:
	output: testouts/invivo/hdsl_fasta/
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-16 12:07 - INFO - cli : 50 - Loading input data
2023-02-16 12:07 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-16 12:07 - INFO - cli : 104 - Spawning training set
2023-02-16 12:07 - INFO - Dataset : 102 -  ... sorting
2023-02-16 12:07 - INFO - Dataset : 105 -  ... selecting
2023-02-16 12:07 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-16 12:07 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     29607
       KL div                     0
2023-02-16 12:07 - INFO - TrainingManager : 104 - Training with k=6
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12155352 0.05200561 0.05915757 0.07020906 0.0787175  0.09033883
  0.09830794 0.32970997 0.1       ]
 [0.32836172 0.09965846 0.08868508 0.08092569 0.06950865 0.06142304
  0.05097018 0.12046717 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 0: logL = -64900.4
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.75 0.25]
 [0.25 0.75]]
chi:
[[0.08847227 0.04474822 0.05364145 0.0678404  0.08013473 0.09511352
  0.10579391 0.3642555  0.1       ]
 [0.36100801 0.10681706 0.09413599 0.08326925 0.06811057 0.05670975
  0.04358344 0.08636592 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 1: logL = -60184.8
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.79 0.21]
 [0.21 0.79]]
chi:
[[0.05750187 0.03708548 0.04744845 0.06511254 0.08174819 0.10056112
  0.11383112 0.39671124 0.1       ]
 [0.39078603 0.11420195 0.10013542 0.08591956 0.06655227 0.05144135
  0.03582839 0.05513504 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 2: logL = -59457.4
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.82 0.18]
 [0.17 0.83]]
chi:
[[0.03620347 0.03111728 0.04223498 0.06277458 0.08304568 0.10515671
  0.12021545 0.41925184 0.1       ]
 [0.41033955 0.11974729 0.10503909 0.08813004 0.06534034 0.0471297
  0.02987817 0.03439583 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 3: logL = -58659.1
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.02498867 0.02789847 0.03916142 0.06141842 0.08366026 0.10775157
  0.12374551 0.43137568 0.1       ]
 [0.41996987 0.12257654 0.10781657 0.08936375 0.06480286 0.04480222
  0.02675147 0.02391672 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 4: logL = -58163.1
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[0.0195227  0.02661464 0.03777197 0.06084121 0.08376784 0.10875995
  0.12521304 0.43750864 0.1       ]
 [0.42420999 0.12356733 0.10897951 0.0898484  0.06474912 0.0439934
  0.0255888  0.01906344 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 5: logL = -57992.7
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[0.01656822 0.0261757  0.03718036 0.06060625 0.08366917 0.10903503
  0.12575008 0.44101519 0.1       ]
 [0.42616645 0.12377656 0.109393   0.09001102 0.0648864  0.04387115
  0.02529081 0.01660461 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 6: logL = -57951.2
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[0.01468274 0.02599991 0.03687397 0.06047067 0.0835237  0.10906867
  0.12597378 0.44340656 0.1       ]
 [0.42717867 0.12375487 0.10954644 0.0900839  0.06506292 0.04396611
  0.02527203 0.01513506 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 7: logL = -57939.4
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[0.01330446 0.02587241 0.03665217 0.06035027 0.08338535 0.10904957
  0.12611906 0.44526672 0.1       ]
 [0.42776533 0.12370319 0.10962967 0.09014657 0.06522824 0.04410015
  0.02531193 0.01411493 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 8: logL = -57933.8
2023-02-16 12:07 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.793e+04
2023-02-16 12:07 - INFO - TrainingManager : 71 -  >> BIC: 1.160e+05
2023-02-16 12:07 - INFO - TrainingManager : 104 - Training with k=7
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12144989 0.04394127 0.04890426 0.05653774 0.064127   0.07121954
  0.0783175  0.08565893 0.32984388 0.1       ]
 [0.32843154 0.08716869 0.07820215 0.07124686 0.06421422 0.05731311
  0.04985978 0.04319616 0.1203675  0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 0: logL = -68383.4
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.75 0.25]
 [0.25 0.75]]
chi:
[[0.08827048 0.03739523 0.04363861 0.05380522 0.06407393 0.0733158
  0.08295117 0.09211525 0.36443431 0.1       ]
 [0.36120894 0.09363229 0.08340866 0.07394934 0.06426696 0.05524334
  0.04528166 0.03682093 0.08618788 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 1: logL = -62458.4
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.79 0.21]
 [0.21 0.79]]
chi:
[[0.05730132 0.03053304 0.03783908 0.05067174 0.06405265 0.07569521
  0.08815901 0.09897613 0.39677182 0.1       ]
 [0.39110089 0.10026789 0.08903886 0.07699516 0.06428748 0.05293842
  0.04023146 0.03018393 0.05495591 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 2: logL = -61725.9
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.82 0.18]
 [0.17 0.83]]
chi:
[[0.03610978 0.02522011 0.03309006 0.04799714 0.06407021 0.07763464
  0.0924879  0.10434393 0.41904624 0.1       ]
 [0.4107327  0.1052401  0.09352347 0.07952991 0.06426938 0.05111363
  0.03614813 0.02515438 0.03428831 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 3: logL = -60926.4
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.02500624 0.02233432 0.03038713 0.04642782 0.06410917 0.07861316
  0.09492733 0.10725077 0.43094406 0.1       ]
 [0.42040211 0.10780772 0.09597405 0.08096389 0.06423069 0.05024107
  0.03394211 0.02256358 0.02387478 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 4: logL = -60434.0
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[0.01961369 0.02113822 0.02922397 0.04572775 0.06413825 0.07887045
  0.09590398 0.10842036 0.43696333 0.1       ]
 [0.42464205 0.1087538  0.09693848 0.08155687 0.06420212 0.05006285
  0.03314729 0.02164127 0.01905528 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 5: logL = -60266.4
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[0.01670514 0.02069019 0.02876512 0.0454204  0.06413747 0.07882778
  0.09620568 0.10882338 0.44042485 0.1       ]
 [0.42657914 0.10899754 0.0972358  0.08177667 0.06420273 0.05016655
  0.0329913  0.02143928 0.01661099 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 6: logL = -60225.8
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[0.01485031 0.0204897  0.02854493 0.04524057 0.06410714 0.07871107
  0.0962804  0.10897836 0.44279752 0.1       ]
 [0.42757037 0.10901916 0.09731497 0.08187934 0.06423184 0.05033475
  0.03304214 0.02145972 0.01514772 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 7: logL = -60214.4
2023-02-16 12:07 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-16 12:07 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[0.01349403 0.02034786 0.02838626 0.04509254 0.06405608 0.07859773
  0.0963007  0.10907884 0.44464595 0.1       ]
 [0.42814125 0.10899844 0.09734544 0.08195655 0.06428065 0.0504939
  0.03313475 0.02151837 0.01413065 0.1       ]]

2023-02-16 12:07 - DEBUG - TrainingManager : 134 - 8: logL = -60208.9
2023-02-16 12:07 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -6.021e+04
2023-02-16 12:07 - INFO - TrainingManager : 71 -  >> BIC: 1.206e+05
2023-02-16 12:07 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-16 12:07 - INFO - cli : 125 - Training phase done in 00:00:12
2023-02-16 12:07 - INFO - cli : 155 - Process done in 00:00:13
2023-02-16 12:07 - INFO - cli : 156 - Output written to  -> testouts/invivo/hdsl_fasta/
