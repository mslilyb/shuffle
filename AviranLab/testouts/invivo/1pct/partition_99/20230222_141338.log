2023-02-22 14:13 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/99.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/99.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:13 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/99.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/99.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_99
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:13 - INFO - cli : 50 - Loading input data
2023-02-22 14:13 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 104 - Spawning training set
2023-02-22 14:13 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:13 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:13 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     168
       KL div                     0
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.45 0.55]
A:
[[0.73 0.27]
 [0.28 0.72]]
chi:
[[0.10066222 0.05190759 0.06079518 0.07642875 0.0846478  0.09571824
  0.10211917 0.32772105 0.1       ]
 [0.35265261 0.09870805 0.08958352 0.07353316 0.06509499 0.05372942
  0.04715784 0.11954042 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -443.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.41 0.59]
A:
[[0.79 0.21]
 [0.24 0.76]]
chi:
[[0.0496572  0.04453573 0.05555669 0.0839222  0.09181494 0.10775232
  0.11227892 0.354482   0.1       ]
 [0.42244392 0.10930415 0.09689404 0.06495319 0.05606562 0.0381194
  0.03302225 0.07919742 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -413.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.41 0.59]
A:
[[0.86 0.14]
 [0.18 0.82]]
chi:
[[0.02129963 0.0382667  0.05136067 0.09221007 0.09879427 0.11635681
  0.11762207 0.36408977 0.1       ]
 [0.49970227 0.12453708 0.10687907 0.05179117 0.04291198 0.01922784
  0.01752156 0.03742902 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -402.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.91 0.09]
 [0.14 0.86]]
chi:
[[0.01473868 0.03668681 0.05185587 0.09711377 0.10532286 0.11824731
  0.11746549 0.35856921 0.1       ]
 [0.56154337 0.13632393 0.11204439 0.0396048  0.02646536 0.00577855
  0.00702992 0.01120969 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -390.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.7 0.3]
A:
[[0.94 0.06]
 [0.11 0.89]]
chi:
[[0.01816259 0.03687577 0.05506794 0.09769421 0.11028112 0.11646188
  0.11565548 0.34980102 0.1       ]
 [0.59425142 0.14306036 0.11058323 0.03448572 0.01201524 0.0009812
  0.0024208  0.00220204 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -383.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.9 0.1]
A:
[[0.95 0.05]
 [0.08 0.92]]
chi:
[[2.49029034e-02 3.67788968e-02 5.84251675e-02 9.64956748e-02
  1.12395609e-01 1.14275988e-01 1.13922557e-01 3.42803204e-01
  1.00000000e-01]
 [6.06651965e-01 1.47900404e-01 1.06613739e-01 3.40005720e-02
  3.67408951e-03 8.75794610e-05 7.61690483e-04 3.09961391e-04
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -379.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.96 0.04]
 [0.07 0.93]]
chi:
[[2.97347073e-02 3.66501844e-02 6.05464014e-02 9.52555611e-02
  1.12653427e-01 1.13057003e-01 1.12943671e-01 3.39159045e-01
  1.00000000e-01]
 [6.09794212e-01 1.50573016e-01 1.03482589e-01 3.50839322e-02
  7.99302879e-04 4.00755784e-06 2.27342363e-04 3.55976019e-05
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -377.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.96 0.04]
 [0.06 0.94]]
chi:
[[3.19350518e-02 3.66763982e-02 6.14763299e-02 9.44580035e-02
  1.12520506e-01 1.12593706e-01 1.12560616e-01 3.37779389e-01
  1.00000000e-01]
 [6.10166857e-01 1.51456039e-01 1.01979882e-01 3.61810526e-02
  1.46146927e-04 1.12155727e-07 6.61265690e-05 3.78307586e-06
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -377.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.25e-04]
A:
[[0.96 0.04]
 [0.06 0.94]]
chi:
[[3.28166212e-02 3.67580335e-02 6.18286772e-02 9.40278901e-02
  1.12419355e-01 1.12431821e-01 1.12422331e-01 3.37295271e-01
  1.00000000e-01]
 [6.10066837e-01 1.51623240e-01 1.01390626e-01 3.68749057e-02
  2.49806284e-05 2.41904218e-09 1.90170125e-05 3.92541053e-07
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -377.0
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.13e-05]
A:
[[0.96 0.04]
 [0.05 0.95]]
chi:
[[3.31646521e-02 3.68197881e-02 6.19559790e-02 9.38179437e-02
  1.12372332e-01 1.12374407e-01 1.12371696e-01 3.37123202e-01
  1.00000000e-01]
 [6.09959979e-01 1.51617025e-01 1.01175708e-01 3.72376414e-02
  4.16471056e-06 4.65656646e-11 5.44205831e-06 4.04314992e-08
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -377.0
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -3.770e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 8.308e+02
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.47 0.53]
A:
[[0.73 0.27]
 [0.28 0.72]]
chi:
[[0.10044641 0.04082615 0.05556274 0.05652044 0.06943969 0.07710286
  0.08143596 0.09047914 0.32818661 0.1       ]
 [0.3527435  0.0883461  0.07323209 0.07224986 0.05899974 0.05114031
  0.04669624 0.03742146 0.11917071 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -463.6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.44 0.56]
A:
[[0.79 0.21]
 [0.23 0.77]]
chi:
[[0.04925216 0.03125082 0.05789287 0.05207122 0.07581044 0.08819541
  0.08922314 0.10099395 0.35531001 0.1       ]
 [0.42256024 0.10142063 0.07147199 0.07801618 0.05133064 0.03740855
  0.03625326 0.02302155 0.07851697 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -426.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.43 0.57]
A:
[[0.86 0.14]
 [0.18 0.82]]
chi:
[[0.02155538 0.0241526  0.06055384 0.04737337 0.08214626 0.09865198
  0.0950322  0.10556863 0.36496575 0.1       ]
 [0.49791072 0.11812227 0.06929184 0.08697277 0.0403267  0.0181851
  0.02304085 0.00890676 0.037243   0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -414.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.48 0.52]
A:
[[0.91 0.09]
 [0.13 0.87]]
chi:
[[0.01609589 0.02366738 0.06244935 0.04640127 0.08760195 0.10201932
  0.09777592 0.10384058 0.36014835 0.1       ]
 [0.55516841 0.12848211 0.06718805 0.09255169 0.02743492 0.00464856
  0.01135517 0.00177011 0.01140097 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -402.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.64 0.36]
A:
[[0.94 0.06]
 [0.1  0.9 ]]
chi:
[[2.04429010e-02 2.52723781e-02 6.32816798e-02 4.87471807e-02
  9.17940071e-02 1.00372899e-01 9.82151462e-02 1.00612698e-01
  3.51261110e-01 1.00000000e-01]
 [5.86026340e-01 1.33141022e-01 6.60577520e-02 9.17099393e-02
  1.57358554e-02 5.94822436e-04 4.40307665e-03 1.71595775e-04
  2.15959622e-03 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -394.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.86 0.14]
A:
[[0.95 0.05]
 [0.08 0.92]]
chi:
[[2.70308406e-02 2.58894956e-02 6.40550315e-02 5.18813943e-02
  9.44095047e-02 9.80814636e-02 9.73533008e-02 9.80970241e-02
  3.43201945e-01 1.00000000e-01]
 [6.01355444e-01 1.37280043e-01 6.47242610e-02 8.78673336e-02
  7.01794307e-03 3.72511780e-05 1.42154768e-03 7.66936584e-06
  2.88506751e-04 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -391.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.97 0.03]
A:
[[0.96 0.04]
 [0.06 0.94]]
chi:
[[3.10504053e-02 2.60677639e-02 6.48201553e-02 5.38447423e-02
  9.54899550e-02 9.67617472e-02 9.65508616e-02 9.67623112e-02
  3.38652058e-01 1.00000000e-01]
 [6.08912015e-01 1.39935938e-01 6.32278191e-02 8.49530150e-02
  2.51872307e-03 1.28390606e-06 4.18719662e-04 1.67389938e-07
  3.23185614e-05 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -389.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.96 0.04]
 [0.05 0.95]]
chi:
[[3.27859649e-02 2.62144491e-02 6.52965344e-02 5.46104062e-02
  9.58006547e-02 9.62081219e-02 9.61489129e-02 9.62081361e-02
  3.36726820e-01 1.00000000e-01]
 [6.12082664e-01 1.40954032e-01 6.22501140e-02 8.37699524e-02
  8.20592655e-04 3.09845834e-08 1.19266679e-04 2.28903646e-09
  3.34454291e-06 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -388.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.47e-04]
A:
[[0.97 0.03]
 [0.05 0.95]]
chi:
[[3.34871204e-02 2.63279194e-02 6.55096737e-02 5.48731590e-02
  9.58654845e-02 9.59928205e-02 9.59762942e-02 9.59928208e-02
  3.35974708e-01 1.00000000e-01]
 [6.13289680e-01 1.41244612e-01 6.18041537e-02 8.33695382e-02
  2.58172695e-04 6.39305290e-10 3.35075860e-05 2.51239057e-11
  3.35301544e-07 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -388.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.05e-05]
A:
[[0.97 0.03]
 [0.05 0.95]]
chi:
[[3.37617397e-02 2.63899966e-02 6.55911630e-02 5.49639474e-02
  9.58721778e-02 9.59116301e-02 9.59070260e-02 9.59116301e-02
  3.35690689e-01 1.00000000e-01]
 [6.13728289e-01 1.41315998e-01 6.16321405e-02 8.32339858e-02
  8.01943414e-05 1.24272163e-11 9.35889393e-06 2.52806521e-13
  3.32235680e-08 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -388.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.66e-06]
A:
[[0.97 0.03]
 [0.05 0.95]]
chi:
[[3.38660115e-02 2.64179051e-02 6.56202511e-02 5.49956886e-02
  9.58696296e-02 9.58818150e-02 9.58805333e-02 9.58818150e-02
  3.35586351e-01 1.00000000e-01]
 [6.13882954e-01 1.41331904e-01 6.15704536e-02 8.31872852e-02
  2.47925631e-05 2.36353448e-13 2.60786019e-06 2.46307536e-15
  3.27828806e-09 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 10: logL = -388.3
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -3.883e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 8.637e+02
2023-02-22 14:13 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:13 - INFO - cli : 125 - Training phase done in 00:00:00
2023-02-22 14:13 - INFO - cli : 155 - Process done in 00:00:00
2023-02-22 14:13 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_99
