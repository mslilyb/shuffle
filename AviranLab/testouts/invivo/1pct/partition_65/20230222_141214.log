2023-02-22 14:12 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/65.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/65.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:12 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/65.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/65.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_65
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:12 - INFO - cli : 50 - Loading input data
2023-02-22 14:12 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:12 - INFO - cli : 104 - Spawning training set
2023-02-22 14:12 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:12 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:12 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:12 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:12 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.28 0.72]
A:
[[0.71 0.29]
 [0.29 0.71]]
chi:
[[0.13754234 0.05735973 0.05863956 0.06858357 0.07924108 0.08800629
  0.09734801 0.31327942 0.1       ]
 [0.31245827 0.09264039 0.09136055 0.08141647 0.07075889 0.06199362
  0.05265184 0.13671996 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 0: logL = -653.2
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.11 0.89]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12288383 0.05809647 0.05187765 0.06558297 0.08006605 0.09105986
  0.10272409 0.32770907 0.1       ]
 [0.32721588 0.09192003 0.09814493 0.08442623 0.069929   0.05892446
  0.04724884 0.12219064 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 1: logL = -608.8
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.03 0.97]
A:
[[0.74 0.26]
 [0.27 0.73]]
chi:
[[0.1072769  0.05954411 0.04422381 0.06251571 0.08094919 0.09484341
  0.10868815 0.34195872 0.1       ]
 [0.34326237 0.09052669 0.10591717 0.08754148 0.06902355 0.05506569
  0.04115753 0.10750551 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 2: logL = -607.1
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.76 0.24]
 [0.25 0.75]]
chi:
[[0.09225676 0.06190379 0.03633155 0.05969276 0.08176969 0.09916129
  0.11465676 0.3542274  0.1       ]
 [0.35940409 0.08826007 0.11415226 0.09049876 0.06814561 0.05053641
  0.03484706 0.09415574 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 3: logL = -605.1
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.05e-04 9.99e-01]
A:
[[0.78 0.22]
 [0.23 0.77]]
chi:
[[0.07934739 0.06523294 0.02916189 0.05761831 0.08242274 0.1036191
  0.11985789 0.36273974 0.1       ]
 [0.37456979 0.08502973 0.12207088 0.09284915 0.06737763 0.04561122
  0.0289357  0.08355589 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 4: logL = -603.1
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.46e-05 1.00e+00]
A:
[[0.8  0.2 ]
 [0.22 0.78]]
chi:
[[0.06961033 0.06922567 0.02348668 0.05672334 0.08287789 0.10773346
  0.12368905 0.36665359 0.1       ]
 [0.38793244 0.08105463 0.12901383 0.09416383 0.06673971 0.04067763
  0.02394754 0.07647039 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 5: logL = -601.2
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.32e-06 1.00e+00]
A:
[[0.81 0.19]
 [0.21 0.79]]
chi:
[[0.0632631  0.07323845 0.01948964 0.05705097 0.08320239 0.11115109
  0.12605109 0.36655328 0.1       ]
 [0.39892964 0.07689435 0.13469508 0.09430214 0.06617926 0.03612361
  0.02010036 0.07277555 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 6: logL = -599.9
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.26e-07 1.00e+00]
A:
[[0.82 0.18]
 [0.2  0.8 ]]
chi:
[[0.05980871 0.07667474 0.01688538 0.05823636 0.08349422 0.11376564
  0.12726392 0.36387104 0.1       ]
 [0.40733078 0.0731515  0.13914433 0.09350296 0.06562446 0.03221222
  0.01731342 0.07172034 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 7: logL = -599.0
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.97e-09 1.00e+00]
A:
[[0.83 0.17]
 [0.19 0.81]]
chi:
[[0.05847173 0.07929176 0.01526017 0.05977808 0.08380125 0.11566367
  0.12774558 0.35998775 0.1       ]
 [0.41328631 0.0701475  0.14254524 0.09221076 0.06504881 0.02902334
  0.01536285 0.0723752  0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 8: logL = -598.5
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.96e-10 1.00e+00]
A:
[[0.84 0.16]
 [0.19 0.81]]
chi:
[[0.05852819 0.08114845 0.01427261 0.06129287 0.08411258 0.11700702
  0.12781506 0.35582322 0.1       ]
 [0.41721955 0.06790059 0.14511992 0.09082717 0.064478   0.02649587
  0.01401618 0.07394272 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 9: logL = -598.2
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.48e-11 1.00e+00]
A:
[[0.84 0.16]
 [0.19 0.81]]
chi:
[[0.05942709 0.08241695 0.01369364 0.06258802 0.08439511 0.11795079
  0.12766459 0.35186382 0.1       ]
 [0.41964057 0.06628095 0.14706919 0.089591   0.0639555  0.02450886
  0.01308972 0.07586422 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 10: logL = -598.1
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.42e-13 1.00e+00]
A:
[[0.85 0.15]
 [0.18 0.82]]
chi:
[[0.06079025 0.0832653  0.013382   0.06361266 0.08462192 0.11861453
  0.1273976  0.34831573 0.1       ]
 [0.42101323 0.06513391 0.14855193 0.0885928  0.06351454 0.02293838
  0.01245425 0.07780097 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 11: logL = -598.0
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.97e-14 1.00e+00]
A:
[[0.85 0.15]
 [0.18 0.82]]
chi:
[[0.0623732  0.08382222 0.01325223 0.06438778 0.08478049 0.11908286
  0.12706769 0.34523353 0.1       ]
 [0.42170248 0.06432923 0.14968597 0.08783583 0.06317018 0.02168033
  0.01202241 0.07957357 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 12: logL = -597.9
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #14
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.18e-16 1.00e+00]
A:
[[0.86 0.14]
 [0.18 0.82]]
chi:
[[0.06402459 0.08417818 0.01325142 0.06495868 0.0848702  0.11941428
  0.12670329 0.34259936 0.1       ]
 [0.4219722  0.06376943 0.1505566  0.08728673 0.06292266 0.02065395
  0.01173499 0.08110345 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 13: logL = -597.8
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #15
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.65e-17 1.00e+00]
A:
[[0.86 0.14]
 [0.18 0.82]]
chi:
[[0.06565484 0.08439517 0.01334515 0.06537146 0.08489751 0.11964957
  0.12632062 0.34036568 0.1       ]
 [0.42200352 0.06338445 0.15122586 0.08690407 0.06276339 0.01979831
  0.01155068 0.08236972 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 14: logL = -597.8
2023-02-22 14:12 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.978e+02
2023-02-22 14:12 - INFO - TrainingManager : 71 -  >> BIC: 1.281e+03
2023-02-22 14:12 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.28 0.72]
A:
[[0.71 0.29]
 [0.29 0.71]]
chi:
[[0.13798467 0.04967577 0.04893668 0.05560587 0.06478634 0.07237061
  0.07313923 0.08466733 0.3128335  0.1       ]
 [0.31197632 0.08231691 0.07705702 0.07039081 0.06721312 0.05963225
  0.04686666 0.04734104 0.13720587 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 0: logL = -688.7
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.11 0.89]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12414613 0.05023447 0.04507607 0.05295091 0.06330972 0.073511
  0.07685123 0.08732079 0.32659968 0.1       ]
 [0.32595022 0.08178059 0.08094106 0.07305869 0.06869286 0.05848183
  0.04313267 0.04465884 0.12330326 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 1: logL = -632.2
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.03 0.97]
A:
[[0.73 0.27]
 [0.27 0.73]]
chi:
[[0.10967564 0.0513113  0.0409999  0.04985679 0.06150891 0.07486413
  0.08102247 0.09037607 0.3403848  0.1       ]
 [0.34077371 0.08074593 0.08508582 0.07619442 0.07050859 0.05710133
  0.03889562 0.04152895 0.10916562 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 2: logL = -630.9
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.75 0.25]
 [0.26 0.74]]
chi:
[[0.09583173 0.05303362 0.03692681 0.04648593 0.05939938 0.07631936
  0.08541321 0.0936267  0.35296325 0.1       ]
 [0.35525764 0.07907573 0.08929308 0.07965335 0.07265629 0.05559361
  0.03437246 0.0381403  0.09595754 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 3: logL = -629.4
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.76 0.24]
 [0.24 0.76]]
chi:
[[0.08371099 0.05544276 0.03319438 0.04312497 0.0571288  0.07773649
  0.08970433 0.09677806 0.36317922 0.1       ]
 [0.36840107 0.07671506 0.09325116 0.08317213 0.07500381 0.05408806
  0.02985164 0.03476186 0.08475521 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 4: logL = -627.9
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.32e-04 1.00e+00]
A:
[[0.78 0.22]
 [0.23 0.77]]
chi:
[[0.07403615 0.0583676  0.03012554 0.04012092 0.05493868 0.07897074
  0.09358004 0.09952991 0.37033041 0.1       ]
 [0.37958924 0.07381569 0.09666394 0.08642852 0.07732696 0.05271777
  0.02561354 0.03166487 0.07617947 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 5: logL = -626.6
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.24e-05 1.00e+00]
A:
[[0.79 0.21]
 [0.22 0.78]]
chi:
[[0.06698439 0.06141528 0.0278851  0.03773365 0.0530546  0.07992456
  0.09684641 0.10171078 0.37444523 0.1       ]
 [0.38863328 0.07074771 0.09936328 0.08916461 0.07940562 0.0515804
  0.02184365 0.02901966 0.07024179 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 6: logL = -625.6
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.43e-07 1.00e+00]
A:
[[0.8  0.2 ]
 [0.22 0.78]]
chi:
[[0.06224707 0.06415942 0.02644135 0.03603614 0.05158735 0.08057271
  0.09947893 0.10332809 0.37614895 0.1       ]
 [0.39568459 0.06793028 0.10134032 0.09127793 0.08111504 0.0507171
  0.01859709 0.02685275 0.0664849  0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 7: logL = -625.0
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.18e-08 1.00e+00]
A:
[[0.8  0.2 ]
 [0.21 0.79]]
chi:
[[0.05927829 0.06635281 0.02563685 0.03494299 0.05052381 0.08094317
  0.10156488 0.10449876 0.37625843 0.1       ]
 [0.40110247 0.06562509 0.10270357 0.09281449 0.08244561 0.05012079
  0.0158315  0.02508969 0.06426679 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 8: logL = -624.6
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.65e-09 1.00e+00]
A:
[[0.81 0.19]
 [0.21 0.79]]
chi:
[[0.05753199 0.06796726 0.02528323 0.03430242 0.04978319 0.08108713
  0.10321886 0.10535705 0.37546887 0.1       ]
 [0.40531078 0.06388187 0.10360919 0.09389834 0.08346044 0.04975587
  0.01346677 0.02362474 0.062992   0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 9: logL = -624.4
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.01e-10 1.00e+00]
A:
[[0.81 0.19]
 [0.21 0.79]]
chi:
[[0.05657904 0.06910022 0.02521933 0.03396716 0.04927271 0.08105967
  0.1045366  0.1060084  0.37425687 0.1       ]
 [0.40868495 0.06261881 0.10420473 0.09466409 0.08424328 0.04957547
  0.01142705 0.02236564 0.06221597 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 10: logL = -624.3
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.07e-11 1.00e+00]
A:
[[0.81 0.19]
 [0.21 0.79]]
chi:
[[0.056124   0.06987897 0.02532858 0.03382296 0.04891543 0.08091096
  0.10558649 0.10652293 0.37290967 0.1       ]
 [0.41150276 0.06171616 0.10460344 0.09522245 0.08486781 0.04953268
  0.00965533 0.02124741 0.06165197 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 11: logL = -624.2
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.51e-13 1.00e+00]
A:
[[0.81 0.19]
 [0.22 0.78]]
chi:
[[0.05597776 0.07041311 0.02553442 0.03379077 0.0486563  0.08068292
  0.10641615 0.10694392 0.37158465 0.1       ]
 [0.41394678 0.06106666 0.10488206 0.09565245 0.08538819 0.04958624
  0.00811226 0.02022956 0.06113578 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 12: logL = -624.1
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #14
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.8e-14 1.0e+00]
A:
[[0.81 0.19]
 [0.22 0.78]]
chi:
[[0.05602339 0.07078294 0.02578937 0.03381936 0.048459   0.0804087
  0.1070603  0.10729749 0.37035944 0.1       ]
 [0.41612832 0.06059004 0.10508869 0.09600603 0.08584051 0.04970241
  0.0067704  0.01928869 0.06058491 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 13: logL = -624.1
2023-02-22 14:12 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -6.241e+02
2023-02-22 14:12 - INFO - TrainingManager : 71 -  >> BIC: 1.345e+03
2023-02-22 14:12 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:12 - INFO - cli : 125 - Training phase done in 00:00:00
2023-02-22 14:12 - INFO - cli : 155 - Process done in 00:00:00
2023-02-22 14:12 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_65
