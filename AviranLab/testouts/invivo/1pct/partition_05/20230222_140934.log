2023-02-22 14:09 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/05.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/05.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:09 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/05.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/05.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_05
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:09 - INFO - cli : 50 - Loading input data
2023-02-22 14:09 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:09 - INFO - cli : 104 - Spawning training set
2023-02-22 14:09 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:09 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:09 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:09 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:09 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.33 0.67]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11619772 0.05018726 0.05768943 0.07298581 0.08267642 0.08735739
  0.09886397 0.33404201 0.1       ]
 [0.33388179 0.09983087 0.09232322 0.07701566 0.06731797 0.06263358
  0.05111859 0.11587831 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 0: logL = -650.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.14 0.86]
A:
[[0.76 0.24]
 [0.24 0.76]]
chi:
[[0.07615835 0.04115026 0.0480529  0.07544958 0.08859831 0.08966196
  0.10671132 0.3742173  0.1       ]
 [0.37424553 0.10894159 0.10202022 0.0745492  0.06136479 0.06029826
  0.04320263 0.0753778  0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 1: logL = -600.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.03 0.97]
A:
[[0.8 0.2]
 [0.2 0.8]]
chi:
[[0.04085665 0.03154401 0.03704363 0.07896978 0.09577272 0.0927323
  0.11455731 0.4085236  0.1       ]
 [0.41045291 0.11876504 0.1132263  0.07100199 0.05407955 0.05714159
  0.03516137 0.04017124 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 2: logL = -589.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.0202806  0.02456029 0.02809643 0.0829214  0.10222879 0.09623729
  0.11957297 0.42610224 0.1       ]
 [0.43307909 0.12626749 0.12267332 0.0669486  0.04732436 0.05341418
  0.02969553 0.02059743 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 3: logL = -577.8
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.29e-04 1.00e+00]
A:
[[0.85 0.15]
 [0.16 0.84]]
chi:
[[0.01115159 0.02108587 0.02249173 0.08603873 0.10682304 0.09936744
  0.12166095 0.43138065 0.1       ]
 [0.44532614 0.13054725 0.12909881 0.0636269  0.042213   0.04989444
  0.02692563 0.01236782 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 4: logL = -572.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.24e-06 1.00e+00]
A:
[[0.85 0.15]
 [0.17 0.83]]
chi:
[[0.00685892 0.01952087 0.01915658 0.08788295 0.1099892  0.10169764
  0.12258953 0.4323043  0.1       ]
 [0.45282138 0.13294109 0.13332155 0.06154535 0.0384581  0.04711762
  0.02529862 0.0084963  0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 5: logL = -570.2
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.14e-07 1.00e+00]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.00445539 0.01869782 0.01704174 0.08878879 0.11225816 0.10330743
  0.12332002 0.43213065 0.1       ]
 [0.45799483 0.13448056 0.13623013 0.0604328  0.03563854 0.04509455
  0.02395221 0.00617638 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 6: logL = -569.5
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.7e-09 1.0e+00]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.0029585  0.01818494 0.01560137 0.08915648 0.11392176 0.10440791
  0.12404875 0.43172031 0.1       ]
 [0.46176101 0.13558142 0.13833627 0.05990507 0.03349805 0.0436426
  0.02269973 0.00457586 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 7: logL = -569.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.88e-11 1.00e+00]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.00198341 0.01784187 0.01456886 0.08924706 0.11515376 0.10517065
  0.12475424 0.43128014 0.1       ]
 [0.46456834 0.13640026 0.13991619 0.05969556 0.03186612 0.04259016
  0.02155312 0.00341025 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 8: logL = -568.8
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.2e-12 1.0e+00]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.00133645 0.01761391 0.01380334 0.08920676 0.11607163 0.10570949
  0.12539881 0.43085962 0.1       ]
 [0.46669375 0.13701216 0.14112991 0.05964799 0.03061746 0.04181493
  0.02053839 0.00254541 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 9: logL = -568.7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.33e-14 1.00e+00]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.00090347 0.01747091 0.01322297 0.08911303 0.11675902 0.10609687
  0.12596436 0.43046937 0.1       ]
 [0.46832597 0.13746559 0.14207804 0.05967595 0.02965769 0.04123475
  0.01966246 0.00189956 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 10: logL = -568.6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.34e-16 1.00e+00]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.00061228 0.0173915  0.01277635 0.08900531 0.11727647 0.10637933
  0.12644857 0.4301102  0.1       ]
 [0.46959758 0.13779711 0.14282793 0.05973328 0.02891583 0.04079444
  0.01891763 0.0014162  0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 11: logL = -568.5
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.82e-18 1.00e+00]
A:
[[0.84 0.16]
 [0.19 0.81]]
chi:
[[4.15801777e-04 1.73589843e-02 1.24292888e-02 8.89025047e-02
  1.17668043e-01 1.06587473e-01 1.26857340e-01 4.29780563e-01
  1.00000000e-01]
 [4.70602670e-01 1.38035545e-01 1.43426603e-01 5.97963824e-02
  2.83387236e-02 4.04563062e-02 1.82894151e-02 1.05435498e-03
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 12: logL = -568.4
2023-02-22 14:09 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.684e+02
2023-02-22 14:09 - INFO - TrainingManager : 71 -  >> BIC: 1.222e+03
2023-02-22 14:09 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.32 0.68]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11602782 0.0431539  0.04748539 0.05663114 0.06946529 0.06956422
  0.07680339 0.08726142 0.33360744 0.1       ]
 [0.33410582 0.08887412 0.07853363 0.06937667 0.06253046 0.05642773
  0.04917968 0.0447125  0.11625938 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 0: logL = -685.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.13 0.87]
A:
[[0.76 0.24]
 [0.24 0.76]]
chi:
[[0.07608162 0.03489323 0.03979723 0.05541033 0.07500994 0.07112295
  0.08142755 0.09334709 0.37291006 0.1       ]
 [0.37469996 0.09727004 0.08632455 0.0706295  0.05694277 0.05483441
  0.04447574 0.03850938 0.07631365 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 1: logL = -623.6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.03 0.97]
A:
[[0.8 0.2]
 [0.2 0.8]]
chi:
[[0.04082344 0.02615807 0.0306936  0.05478113 0.08252734 0.07258941
  0.08698653 0.09928966 0.40615081 0.1       ]
 [0.41167387 0.10638216 0.09574446 0.07133031 0.04924856 0.05328056
  0.03868823 0.03225895 0.0413929  0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 2: logL = -612.8
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.83 0.17]
 [0.17 0.83]]
chi:
[[0.01996877 0.01986144 0.02295661 0.05548444 0.09020858 0.07362967
  0.09196244 0.10300283 0.42292523 0.1       ]
 [0.43566418 0.11340615 0.10414353 0.07072204 0.04112633 0.0520783
  0.03324186 0.02798057 0.02163705 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 3: logL = -601.6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.11e-04 1.00e+00]
A:
[[0.85 0.15]
 [0.17 0.83]]
chi:
[[0.01059572 0.01670941 0.01786687 0.0569872  0.09619    0.07428791
  0.09509927 0.10459182 0.42767179 0.1       ]
 [0.44909108 0.11751754 0.11017225 0.06928446 0.03444601 0.0512021
  0.02945048 0.02566459 0.01317148 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 4: logL = -595.6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.43e-06 1.00e+00]
A:
[[0.85 0.15]
 [0.17 0.83]]
chi:
[[0.0062376  0.01522371 0.01473645 0.05842649 0.10032888 0.07474252
  0.09668299 0.10549188 0.42812949 0.1       ]
 [0.45747491 0.11995906 0.11428881 0.06786019 0.02951931 0.05052143
  0.02720569 0.02403269 0.0091379  0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 5: logL = -593.6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.3e-08 1.0e+00]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.0038813  0.01438605 0.0127379  0.05957768 0.10310909 0.07510483
  0.09742089 0.10634668 0.42743558 0.1       ]
 [0.46345749 0.1216612  0.11720335 0.06669068 0.02598104 0.04994598
  0.02588003 0.02248958 0.00669065 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 6: logL = -592.8
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.72e-09 1.00e+00]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.00247982 0.01384273 0.01139657 0.06050774 0.10493523 0.07542184
  0.09775822 0.10720274 0.42645511 0.1       ]
 [0.46802113 0.12296255 0.11935769 0.06572188 0.02347764 0.04943373
  0.02503948 0.02100122 0.00498468 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 7: logL = -592.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.18e-11 1.00e+00]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.00160876 0.01347921 0.01046012 0.06129758 0.10610288 0.07570913
  0.09790916 0.10799839 0.42543477 0.1       ]
 [0.47160757 0.12397911 0.12100018 0.06487935 0.02172935 0.04897005
  0.02446284 0.01963685 0.0037347  0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 8: logL = -592.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.41e-13 1.00e+00]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.00105494 0.01324313 0.00978586 0.06199253 0.1068273  0.07597107
  0.09797108 0.10869894 0.42445513 0.1       ]
 [0.47447786 0.12477187 0.12228128 0.06412233 0.02051783 0.04855005
  0.02404173 0.01843279 0.00280425 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 9: logL = -591.9
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.6e-15 1.0e+00]
A:
[[0.84 0.16]
 [0.19 0.81]]
chi:
[[0.00069757 0.01309976 0.00928779 0.062613   0.10725995 0.07620914
  0.09798899 0.10929921 0.42354459 0.1       ]
 [0.47680889 0.12538745 0.123299   0.06343446 0.0196803  0.04817101
  0.02372027 0.01739096 0.00210766 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 10: logL = -591.8
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.3e-16 1.0e+00]
A:
[[0.84 0.16]
 [0.19 0.81]]
chi:
[[4.64369617e-04 1.30227573e-02 8.91175163e-03 6.31676449e-02
  1.07503830e-01 7.64245866e-02 9.79846005e-02 1.09808180e-01
  4.22712279e-01 1.00000000e-01]
 [4.78725788e-01 1.25864408e-01 1.24119847e-01 6.28105608e-02
  1.91005748e-02 4.78301857e-02 2.34673195e-02 1.64966540e-02
  1.58466155e-03 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 11: logL = -591.7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.88e-18 1.00e+00]
A:
[[0.84 0.16]
 [0.19 0.81]]
chi:
[[3.10834053e-04 1.29919713e-02 8.62256938e-03 6.36609328e-02
  1.07627442e-01 7.66189674e-02 9.79689661e-02 1.10239135e-01
  4.21959181e-01 1.00000000e-01]
 [4.80318797e-01 1.26234084e-01 1.24790163e-01 6.22489688e-02
  1.86979039e-02 4.75244947e-02 2.32640638e-02 1.57301851e-02
  1.19133952e-03 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 12: logL = -591.6
2023-02-22 14:09 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -5.916e+02
2023-02-22 14:09 - INFO - TrainingManager : 71 -  >> BIC: 1.280e+03
2023-02-22 14:09 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:09 - INFO - cli : 125 - Training phase done in 00:00:02
2023-02-22 14:09 - INFO - cli : 155 - Process done in 00:00:02
2023-02-22 14:09 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_05
