2023-02-22 14:09 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/12.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/12.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:09 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/12.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/12.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_12
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:09 - INFO - cli : 50 - Loading input data
2023-02-22 14:09 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:09 - INFO - cli : 104 - Spawning training set
2023-02-22 14:09 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:09 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:09 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:09 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:09 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.72 0.28]
A:
[[0.71 0.29]
 [0.28 0.72]]
chi:
[[0.12832324 0.05124556 0.06272787 0.07137849 0.07816273 0.08927289
  0.09135558 0.32753364 0.1       ]
 [0.32707708 0.09262957 0.0871983  0.07859972 0.0718563  0.06679493
  0.05276087 0.12308322 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 0: logL = -651.7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.91 0.09]
A:
[[0.74 0.26]
 [0.26 0.74]]
chi:
[[0.10038783 0.0466266  0.06049321 0.07132934 0.07761971 0.08933419
  0.09386951 0.3603396  0.1       ]
 [0.35382857 0.09701876 0.08930403 0.07861935 0.07241691 0.06682422
  0.05043615 0.091552   0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 1: logL = -604.2
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.77 0.23]
 [0.22 0.78]]
chi:
[[0.07170695 0.04156274 0.05755405 0.07170407 0.07705076 0.08931544
  0.0964452  0.39466078 0.1       ]
 [0.37935226 0.10147507 0.09189444 0.07819174 0.07301407 0.06704226
  0.04832757 0.06070259 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 2: logL = -599.2
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.99e-01 7.83e-04]
A:
[[0.79 0.21]
 [0.19 0.81]]
chi:
[[0.04760055 0.03718249 0.05406066 0.07286608 0.07646274 0.08898879
  0.09816715 0.42467155 0.1       ]
 [0.39791033 0.10479309 0.09472185 0.07700984 0.07362231 0.06765014
  0.04735431 0.03693814 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 3: logL = -593.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.e+00 2.e-05]
A:
[[0.82 0.18]
 [0.16 0.84]]
chi:
[[0.03107582 0.03456221 0.05034233 0.0747141  0.0759449  0.08833958
  0.09818523 0.44683583 0.1       ]
 [0.40769302 0.10616193 0.09750009 0.07526089 0.07413778 0.06856515
  0.04810601 0.02257514 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 4: logL = -587.9
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.32e-07]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.02093942 0.03379849 0.04682587 0.07663809 0.07564208 0.08770511
  0.09672648 0.46172446 0.1       ]
 [0.41159439 0.10587213 0.09998116 0.07354755 0.07443069 0.06939477
  0.05007577 0.01510353 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 5: logL = -584.9
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 1.5e-09]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[0.01462656 0.0341457  0.04386691 0.07808309 0.07553486 0.08734074
  0.09472292 0.47167923 0.1       ]
 [0.412895   0.10480198 0.10197784 0.0723284  0.07453653 0.06990595
  0.05230986 0.01124445 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 6: logL = -583.6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 6.57e-12]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[0.01039281 0.03483733 0.04157091 0.07889568 0.07550686 0.08724343
  0.09285175 0.47870124 0.1       ]
 [0.4132297  0.10363328 0.10345522 0.07168395 0.07456856 0.07013189
  0.05425076 0.00904664 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 7: logL = -583.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.21e-14]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[0.00738676 0.03546535 0.03986194 0.07919644 0.07547216 0.0873027
  0.09135053 0.48396412 0.1       ]
 [0.41318626 0.10266777 0.10449545 0.07147744 0.07460366 0.07019116
  0.05575686 0.00762139 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 8: logL = -582.6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 6.11e-17]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[0.00520819 0.03590822 0.03861643 0.079172   0.07539683 0.08742164
  0.09022962 0.48804707 0.1       ]
 [0.41298529 0.10196721 0.10520948 0.07153597 0.07467051 0.07017716
  0.05686384 0.00659054 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 9: logL = -582.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.45e-19]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[0.00363415 0.03617539 0.03772267 0.07897594 0.07528012 0.08754514
  0.08942654 0.49124004 0.1       ]
 [0.41273414 0.1014966  0.10569271 0.07172637 0.07476936 0.0701409
  0.05765166 0.00578827 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 10: logL = -582.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.99e-22]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[0.00251094 0.03631281 0.03709202 0.07870961 0.07513553 0.08765032
  0.08886777 0.493721   0.1       ]
 [0.41249276 0.10119888 0.10601591 0.07196484 0.07488911 0.07010421
  0.05819897 0.00513532 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 11: logL = -582.2
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.48e-25]
A:
[[0.82 0.18]
 [0.14 0.86]]
chi:
[[0.00172061 0.0363652  0.03665629 0.07843173 0.07497902 0.08773188
  0.0884884  0.49562686 0.1       ]
 [0.41229232 0.10102262 0.10622887 0.07220504 0.07501709 0.07007391
  0.05857109 0.00458906 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 12: logL = -582.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #14
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 8.93e-28]
A:
[[0.82 0.18]
 [0.14 0.86]]
chi:
[[0.00117142 0.03636603 0.03636343 0.07817258 0.07482362 0.08779215
  0.08823672 0.49707405 0.1       ]
 [0.4121449  0.10092852 0.1063661  0.07242442 0.07514319 0.0700505
  0.05881864 0.00412373 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 13: logL = -582.1
2023-02-22 14:09 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.821e+02
2023-02-22 14:09 - INFO - TrainingManager : 71 -  >> BIC: 1.250e+03
2023-02-22 14:09 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.72 0.28]
A:
[[0.71 0.29]
 [0.28 0.72]]
chi:
[[0.12846839 0.04225491 0.05493639 0.05784681 0.06383237 0.06797545
  0.07350527 0.08373457 0.32744584 0.1       ]
 [0.32701885 0.08363822 0.07102207 0.06812664 0.06815646 0.05805019
  0.05254885 0.04835679 0.12308194 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 0: logL = -687.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.91 0.09]
A:
[[0.74 0.26]
 [0.26 0.74]]
chi:
[[0.10044134 0.03575138 0.05777875 0.05806237 0.060868   0.06770014
  0.07383998 0.08518984 0.36036819 0.1       ]
 [0.35393093 0.08990091 0.06815463 0.06787462 0.07106651 0.05835983
  0.05229834 0.04705503 0.0913592  0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 1: logL = -627.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.77 0.23]
 [0.22 0.78]]
chi:
[[0.07149039 0.0283416  0.06097081 0.05853544 0.05736629 0.06749417
  0.07455646 0.08659669 0.39464815 0.1       ]
 [0.38012716 0.09668792 0.06497237 0.06733955 0.07439196 0.05863167
  0.05176714 0.04598004 0.0601022  0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 2: logL = -621.9
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.99e-01 7.16e-04]
A:
[[0.8  0.2 ]
 [0.19 0.81]]
chi:
[[0.04732042 0.02143491 0.06403547 0.05921393 0.05401956 0.06742785
  0.07544313 0.08721926 0.42388547 0.1       ]
 [0.39978605 0.10251915 0.0620155  0.06659971 0.07739073 0.0587901
  0.05116936 0.04582521 0.03590419 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 3: logL = -615.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.69e-05]
A:
[[0.82 0.18]
 [0.17 0.83]]
chi:
[[0.03113462 0.01636786 0.06618023 0.05982994 0.05159385 0.06767459
  0.07621376 0.08655811 0.44444701 0.1       ]
 [0.4107356  0.10628517 0.06004802 0.06594253 0.07937216 0.05866092
  0.05073464 0.04691742 0.02130354 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 4: logL = -609.8
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 1.8e-07]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.02147629 0.01327599 0.06704148 0.06021209 0.05017902 0.06825169
  0.07674372 0.08502787 0.45779184 0.1       ]
 [0.41547435 0.10813756 0.0593313  0.06553075 0.08036168 0.05823272
  0.05052397 0.04872722 0.01368044 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 5: logL = -606.8
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.05e-09]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.01553753 0.01150054 0.0669217  0.0603867  0.04935062 0.06892246
  0.07704092 0.08338585 0.46695369 0.1       ]
 [0.41712864 0.1088435  0.059509   0.06532629 0.08082085 0.05772798
  0.05050113 0.05052356 0.00961903 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 6: logL = -605.5
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.04e-12]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.01152575 0.01044377 0.06629323 0.06042884 0.04876547 0.06949222
  0.07716316 0.0820341  0.47385346 0.1       ]
 [0.41747161 0.10900045 0.06011756 0.06525044 0.08108472 0.05731761
  0.05060353 0.05196597 0.00718811 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 7: logL = -605.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.12e-14]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.00861263 0.00977081 0.06547896 0.06039249 0.04828497 0.06990632
  0.07717353 0.08103443 0.47934586 0.1       ]
 [0.41728084 0.10892455 0.06086123 0.06524968 0.08128399 0.05704143
  0.0507715  0.05302874 0.00555803 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 8: logL = -604.7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.39e-17]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[0.00642692 0.00931668 0.06464609 0.06031082 0.04787172 0.07018344
  0.07712084 0.0803216  0.48380188 0.1       ]
 [0.41688275 0.10876302 0.06159677 0.06529243 0.08145368 0.05687639
  0.05096251 0.05379137 0.00438108 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 9: logL = -604.5
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.99e-20]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[0.00477363 0.00899879 0.06387151 0.0602051  0.04751757 0.07035997
  0.0770374  0.0798156  0.48742043 0.1       ]
 [0.41642194 0.10858159 0.06226437 0.06535913 0.08160074 0.05678757
  0.05115125 0.05433846 0.00349496 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 10: logL = -604.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 5.3e-23]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[0.00352644 0.00877222 0.06318681 0.06008965 0.04721867 0.07046851
  0.07694302 0.07945344 0.49034124 0.1       ]
 [0.4159672  0.10840866 0.06284357 0.06543703 0.0817269  0.0567461
  0.05132455 0.0547345  0.00281147 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 11: logL = -604.2
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.65e-26]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[0.00259162 0.00860991 0.06260114 0.05997408 0.04697007 0.07053307
  0.07684929 0.07919125 0.49267956 0.1       ]
 [0.41555201 0.10825551 0.06333187 0.06551773 0.08183393 0.05673207
  0.05147664 0.05502417 0.00227608 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 12: logL = -604.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #14
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.86e-29]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[0.00189591 0.00849407 0.06211222 0.05986454 0.04676571 0.07056991
  0.07676259 0.07899947 0.49453559 0.1       ]
 [0.41519115 0.10812536 0.06373499 0.06559584 0.08192404 0.05673289
  0.05160598 0.05523776 0.001852   0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 13: logL = -604.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #15
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 3.4e-32]
A:
[[0.81 0.19]
 [0.15 0.85]]
chi:
[[0.00138159 0.0084122  0.061712   0.05976464 0.0465992  0.07058956
  0.076686   0.07885817 0.49599664 0.1       ]
 [0.41488878 0.10801774 0.06406219 0.06566816 0.08199955 0.056741
  0.05171336 0.05539606 0.00151316 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 14: logL = -604.0
2023-02-22 14:09 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -6.040e+02
2023-02-22 14:09 - INFO - TrainingManager : 71 -  >> BIC: 1.305e+03
2023-02-22 14:09 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:09 - INFO - cli : 125 - Training phase done in 00:00:00
2023-02-22 14:09 - INFO - cli : 155 - Process done in 00:00:00
2023-02-22 14:09 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_12
