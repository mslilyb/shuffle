2023-02-22 14:12 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/75.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/75.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:12 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/75.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/75.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_75
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:12 - INFO - cli : 50 - Loading input data
2023-02-22 14:12 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:12 - INFO - cli : 104 - Spawning training set
2023-02-22 14:12 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:12 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:12 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:12 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:12 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.7 0.3]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12631579 0.05009411 0.05341138 0.07247529 0.07553978 0.08837651
  0.10311212 0.33067501 0.1       ]
 [0.32253747 0.09961647 0.09633776 0.08346051 0.06850136 0.06177893
  0.04721455 0.12055296 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 0: logL = -650.6
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.9 0.1]
A:
[[0.76 0.24]
 [0.23 0.77]]
chi:
[[0.09598981 0.04125418 0.0392436  0.06971865 0.07613749 0.09248294
  0.11674916 0.36842417 0.1       ]
 [0.34917246 0.10748039 0.10941557 0.08597081 0.06801766 0.05817265
  0.03481638 0.08695407 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 1: logL = -601.9
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.8  0.2 ]
 [0.18 0.82]]
chi:
[[0.06485869 0.0320591  0.02427329 0.06616612 0.07742703 0.0976531
  0.13111345 0.40644922 0.1       ]
 [0.37156827 0.11430137 0.12142728 0.08883088 0.06703295 0.0542669
  0.02364254 0.05892982 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 2: logL = -592.2
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.99e-01 5.91e-04]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.04252755 0.02535901 0.01306031 0.06278437 0.07894841 0.10156267
  0.14219469 0.43356299 0.1       ]
 [0.38182734 0.11766433 0.12823454 0.09107719 0.06602814 0.05217051
  0.01724901 0.04574894 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 3: logL = -581.6
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 1.3e-05]
A:
[[0.86 0.14]
 [0.11 0.89]]
chi:
[[0.03041478 0.02219544 0.00643562 0.06064998 0.08024622 0.10310355
  0.14919314 0.44776128 0.1       ]
 [0.38184894 0.11756407 0.13026756 0.0919853  0.06535299 0.05234662
  0.01519528 0.04543924 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 4: logL = -575.5
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.87e-07]
A:
[[0.87 0.13]
 [0.09 0.91]]
chi:
[[0.02355337 0.0212894  0.00275921 0.05935827 0.08116477 0.10335423
  0.15353297 0.45498778 0.1       ]
 [0.37785517 0.11575493 0.1298154  0.09214511 0.06504589 0.05348517
  0.01541017 0.05048817 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 5: logL = -573.0
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.27e-09]
A:
[[0.88 0.12]
 [0.08 0.92]]
chi:
[[0.018993   0.0214705  0.00100706 0.05820913 0.08155987 0.10290621
  0.15594954 0.45990469 0.1       ]
 [0.37359107 0.11361036 0.12837047 0.09227498 0.06510455 0.05487149
  0.01661179 0.05556528 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 6: logL = -571.9
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.63e-11]
A:
[[0.88 0.12]
 [0.08 0.92]]
chi:
[[1.57947523e-02 2.21298424e-02 3.19491565e-04 5.69998725e-02
  8.15139664e-02 1.01942396e-01 1.56984691e-01 4.64314988e-01
  1.00000000e-01]
 [3.70036494e-01 1.11653489e-01 1.26774032e-01 9.25588359e-02
  6.54042174e-02 5.63215456e-02 1.81621708e-02 5.90892154e-02
  1.00000000e-01]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 7: logL = -571.2
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.06e-13]
A:
[[0.89 0.11]
 [0.07 0.93]]
chi:
[[1.35446755e-02 2.29347776e-02 8.99660785e-05 5.57980780e-02
  8.12250771e-02 1.00694621e-01 1.57246310e-01 4.68466494e-01
  1.00000000e-01]
 [3.67194178e-01 1.10011516e-01 1.25373622e-01 9.29297922e-02
  6.57965513e-02 5.77215248e-02 1.96930623e-02 6.12797530e-02
  1.00000000e-01]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 8: logL = -570.9
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.65e-15]
A:
[[0.89 0.11]
 [0.07 0.93]]
chi:
[[1.19545659e-02 2.37082228e-02 2.29587550e-05 5.47180883e-02
  8.08490358e-02 9.93995972e-02 1.57185043e-01 4.72162488e-01
  1.00000000e-01]
 [3.64954984e-01 1.08694878e-01 1.24254332e-01 9.32944820e-02
  6.61868425e-02 5.89712818e-02 2.10105472e-02 6.26326530e-02
  1.00000000e-01]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 9: logL = -570.7
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.45e-17]
A:
[[0.89 0.11]
 [0.07 0.93]]
chi:
[[1.08192597e-02 2.43724424e-02 5.42133474e-06 5.38321201e-02
  8.04759383e-02 9.82258407e-02 1.57042136e-01 4.75226841e-01
  1.00000000e-01]
 [3.63233386e-01 1.07675294e-01 1.23401899e-01 9.35980780e-02
  6.65295844e-02 6.00099192e-02 2.20495699e-02 6.35022686e-02
  1.00000000e-01]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 10: logL = -570.6
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.54e-19]
A:
[[0.89 0.11]
 [0.07 0.93]]
chi:
[[9.99901220e-03 2.49074071e-02 1.20676528e-06 5.31554970e-02
  8.01488671e-02 9.72569920e-02 1.56915189e-01 4.77615829e-01
  1.00000000e-01]
 [3.61950139e-01 1.06907703e-01 1.22772316e-01 9.38253140e-02
  6.68093797e-02 6.08228644e-02 2.28221167e-02 6.40901676e-02
  1.00000000e-01]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 11: logL = -570.6
2023-02-22 14:12 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.706e+02
2023-02-22 14:12 - INFO - TrainingManager : 71 -  >> BIC: 1.227e+03
2023-02-22 14:12 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.71 0.29]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12607385 0.04213839 0.0456154  0.05257967 0.06375104 0.07278006
  0.07512523 0.0911923  0.33074406 0.1       ]
 [0.3229711  0.08963125 0.08021677 0.07331973 0.06822725 0.05331436
  0.05099182 0.04105091 0.12027681 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 0: logL = -685.9
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.91 0.09]
A:
[[0.76 0.24]
 [0.23 0.77]]
chi:
[[0.09572105 0.03277838 0.03676729 0.0457128  0.06052224 0.07952746
  0.07723313 0.1029844  0.36875325 0.1       ]
 [0.34966611 0.09803623 0.08829669 0.07967037 0.07128231 0.04706226
  0.04927473 0.03033525 0.08637604 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 1: logL = -624.9
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.8  0.2 ]
 [0.18 0.82]]
chi:
[[0.06467829 0.02281881 0.02752057 0.03807505 0.05603988 0.08834764
  0.07938328 0.11542937 0.40770711 0.1       ]
 [0.37151056 0.10546129 0.09542301 0.08577775 0.07510209 0.03983597
  0.04802808 0.02082879 0.05803246 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 2: logL = -615.4
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.99e-01 5.55e-04]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.04250988 0.01490124 0.0208019  0.03213741 0.05069045 0.09650453
  0.08029811 0.12495032 0.43720616 0.1       ]
 [0.3803587  0.10950173 0.09892437 0.08927414 0.07903343 0.0344767
  0.04827365 0.01581402 0.04434326 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 3: logL = -604.8
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.27e-05]
A:
[[0.86 0.14]
 [0.11 0.89]]
chi:
[[0.03079577 0.00985403 0.01703904 0.02910033 0.04561873 0.10190477
  0.08004343 0.1305502  0.4550937  0.1       ]
 [0.37853864 0.11038922 0.09933691 0.08980122 0.08211351 0.03224173
  0.0495254  0.01496636 0.04308701 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 4: logL = -598.9
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.08e-07]
A:
[[0.87 0.13]
 [0.1  0.9 ]]
chi:
[[0.02439667 0.00660033 0.01441056 0.02791742 0.04104091 0.10549861
  0.07976164 0.13352723 0.46684663 0.1       ]
 [0.37246935 0.10966642 0.09871951 0.08879022 0.08434815 0.03175803
  0.05067803 0.01635877 0.0472115  0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 5: logL = -596.8
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.15e-09]
A:
[[0.87 0.13]
 [0.09 0.91]]
chi:
[[0.02007294 0.0042844  0.01187515 0.02750485 0.03685053 0.10825046
  0.07978975 0.13491503 0.47645689 0.1       ]
 [0.3658868  0.10842931 0.0981482  0.08740282 0.08604018 0.03189043
  0.05145709 0.0186211  0.05212406 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 6: logL = -595.7
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.86e-11]
A:
[[0.87 0.13]
 [0.08 0.92]]
chi:
[[0.01680953 0.00259607 0.00936134 0.0273267  0.03322276 0.11036918
  0.07994447 0.13539102 0.48497892 0.1       ]
 [0.3601945  0.10717317 0.09783181 0.08616549 0.08728485 0.03223945
  0.05199662 0.02093894 0.05617517 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 7: logL = -594.9
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 7.79e-13]
A:
[[0.87 0.13]
 [0.07 0.93]]
chi:
[[0.01432438 0.00144659 0.00707938 0.02718354 0.03031425 0.11187357
  0.0800194  0.13555646 0.49220242 0.1       ]
 [0.35574619 0.10606212 0.09770458 0.08522785 0.08814673 0.03266885
  0.05243769 0.02283296 0.05917303 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 8: logL = -594.4
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.29e-14]
A:
[[0.87 0.13]
 [0.07 0.93]]
chi:
[[0.01246784 0.00074633 0.00518165 0.02703498 0.02810324 0.1128475
  0.07993891 0.13578191 0.49789763 0.1       ]
 [0.35246844 0.10513659 0.09767717 0.0845704  0.08872899 0.03310343
  0.0528407  0.02414755 0.06132672 0.1       ]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 9: logL = -594.1
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.17e-16]
A:
[[0.87 0.13]
 [0.07 0.93]]
chi:
[[1.10946679e-02 3.63138890e-04 3.70102799e-03 2.68916726e-02
  2.64665724e-02 1.13439300e-01 7.97380783e-02 1.36150183e-01
  5.02155360e-01 1.00000000e-01]
 [3.50135450e-01 1.04397819e-01 9.76901289e-02 8.41235118e-02
  8.91272087e-02 3.34928139e-02 5.32081592e-02 2.49618708e-02
  6.28630382e-02 1.00000000e-01]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 10: logL = -593.8
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.67e-18]
A:
[[0.87 0.13]
 [0.07 0.93]]
chi:
[[1.00730897e-02 1.69888901e-04 2.59446819e-03 2.67662091e-02
  2.52702893e-02 1.13792294e-01 7.94871751e-02 1.36597941e-01
  5.05248644e-01 1.00000000e-01]
 [3.48507564e-01 1.03829217e-01 9.77119868e-02 8.38217167e-02
  8.94052931e-02 3.38122518e-02 5.35256590e-02 2.54309541e-02
  6.39553582e-02 1.00000000e-01]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 11: logL = -593.7
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 6.2e-20]
A:
[[0.87 0.13]
 [0.07 0.93]]
chi:
[[9.30143527e-03 7.75564701e-05 1.79194900e-03 2.66628789e-02
  2.44029495e-02 1.14007680e-01 7.92416809e-02 1.37046644e-01
  5.07467226e-01 1.00000000e-01]
 [3.47385956e-01 1.03403964e-01 9.77290483e-02 8.36174451e-02
  8.96018947e-02 3.40585758e-02 5.37845764e-02 2.56885981e-02
  6.47299414e-02 1.00000000e-01]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 12: logL = -593.6
2023-02-22 14:12 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #14
2023-02-22 14:12 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.05e-21]
A:
[[0.87 0.13]
 [0.07 0.93]]
chi:
[[8.70838543e-03 3.48831325e-05 1.22291055e-03 2.65803898e-02
  2.37784883e-02 1.14145543e-01 7.90304574e-02 1.37448726e-01
  5.09050216e-01 1.00000000e-01]
 [3.46620777e-01 1.03092186e-01 9.77372579e-02 8.34787471e-02
  8.97411564e-02 3.42408607e-02 5.39860737e-02 2.58243807e-02
  6.52785610e-02 1.00000000e-01]]

2023-02-22 14:12 - DEBUG - TrainingManager : 134 - 13: logL = -593.6
2023-02-22 14:12 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -5.936e+02
2023-02-22 14:12 - INFO - TrainingManager : 71 -  >> BIC: 1.284e+03
2023-02-22 14:12 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:12 - INFO - cli : 125 - Training phase done in 00:00:00
2023-02-22 14:12 - INFO - cli : 155 - Process done in 00:00:00
2023-02-22 14:12 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_75
