2023-02-22 14:09 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/03.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/03.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:09 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/03.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/03.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_03
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:09 - INFO - cli : 50 - Loading input data
2023-02-22 14:09 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:09 - INFO - cli : 104 - Spawning training set
2023-02-22 14:09 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:09 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:09 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:09 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     299
       KL div                     0
2023-02-22 14:09 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.45 0.55]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12140227 0.05413335 0.06089435 0.06979086 0.0820706  0.08975964
  0.10259061 0.31935833 0.1       ]
 [0.33071555 0.10253008 0.08365389 0.07470513 0.06839102 0.06065683
  0.05378825 0.12555924 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 0: logL = -651.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.41 0.59]
A:
[[0.74 0.26]
 [0.26 0.74]]
chi:
[[0.08857133 0.04749717 0.05944397 0.07053192 0.08593923 0.09427717
  0.10936282 0.34437638 0.1       ]
 [0.36604754 0.10972287 0.08532811 0.07398847 0.06431983 0.05579262
  0.04645294 0.09834762 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 1: logL = -605.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.36 0.64]
A:
[[0.78 0.22]
 [0.24 0.76]]
chi:
[[0.05809298 0.04056784 0.05762441 0.07110231 0.09006355 0.09884416
  0.11623375 0.36747099 0.1       ]
 [0.40251782 0.11800105 0.08765103 0.07344113 0.05963363 0.05037613
  0.03822564 0.07015358 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 2: logL = -599.8
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.3 0.7]
A:
[[0.8  0.2 ]
 [0.21 0.79]]
chi:
[[0.03576848 0.03495682 0.05571863 0.07162627 0.09379822 0.10236639
  0.12187188 0.38389331 0.1       ]
 [0.43359683 0.12563591 0.09031622 0.07291311 0.05495983 0.04558616
  0.03055001 0.04644194 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 3: logL = -593.5
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.23 0.77]
A:
[[0.82 0.18]
 [0.2  0.8 ]]
chi:
[[0.02223796 0.0317301  0.05404307 0.07212264 0.09665065 0.10430175
  0.12570152 0.39321231 0.1       ]
 [0.45549968 0.13078936 0.09278419 0.0723742  0.05109263 0.04245532
  0.02470521 0.03029941 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 4: logL = -588.6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.16 0.84]
A:
[[0.83 0.17]
 [0.2  0.8 ]]
chi:
[[0.01457366 0.0305141  0.0527377  0.07246409 0.09857401 0.10505871
  0.12804732 0.39803042 0.1       ]
 [0.46948461 0.13336781 0.09475032 0.07198309 0.04833239 0.04084807
  0.02079984 0.02043387 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 5: logL = -586.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.1 0.9]
A:
[[0.83 0.17]
 [0.2  0.8 ]]
chi:
[[0.01007469 0.03035446 0.05180535 0.07259718 0.09981821 0.10530459
  0.12945308 0.40059244 0.1       ]
 [0.47846522 0.13439348 0.09618531 0.07182323 0.04646491 0.04003643
  0.01827824 0.01435319 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 6: logL = -584.7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.06 0.94]
A:
[[0.83 0.17]
 [0.2  0.8 ]]
chi:
[[0.00724052 0.03056813 0.05118199 0.07257605 0.10063804 0.10542435
  0.13031924 0.40205167 0.1       ]
 [0.48453163 0.13474237 0.09718031 0.07184377 0.04518531 0.03951698
  0.01660925 0.01039038 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 7: logL = -584.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.04 0.96]
A:
[[0.83 0.17]
 [0.2  0.8 ]]
chi:
[[0.0053397  0.03084148 0.05078668 0.0724767  0.10119957 0.10554587
  0.13087984 0.40293016 0.1       ]
 [0.48883853 0.13486093 0.09784857 0.07195923 0.04427828 0.0390905
  0.01545456 0.00766939 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 8: logL = -583.8
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.02 0.98]
A:
[[0.83 0.17]
 [0.21 0.79]]
chi:
[[0.00400612 0.03107075 0.05054876 0.07235321 0.10159874 0.10568672
  0.13126159 0.40347411 0.1       ]
 [0.49201093 0.13492365 0.09828718 0.07210583 0.04361401 0.03870543
  0.01462111 0.00573185 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 9: logL = -583.5
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.83 0.17]
 [0.21 0.79]]
chi:
[[0.00304134 0.03123842 0.05041516 0.07223461 0.10189077 0.10583512
  0.13153299 0.40381158 0.1       ]
 [0.49440858 0.13498397 0.09856903 0.07224827 0.04311513 0.03835707
  0.0139988  0.00431914 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 10: logL = -583.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.83 0.17]
 [0.21 0.79]]
chi:
[[0.00232848 0.0313542  0.05034875 0.07213306 0.10210876 0.10597798
  0.13173265 0.40401612 0.1       ]
 [0.49625388 0.13505118 0.0987457  0.07237125 0.04273371 0.03804922
  0.01352213 0.00327293 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 11: logL = -583.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.83 0.17]
 [0.21 0.79]]
chi:
[[0.00179382 0.03143253 0.05032434 0.07205144 0.10227373 0.10610724
  0.13188354 0.40413335 0.1       ]
 [0.49769275 0.13512185 0.09885271 0.07247073 0.04243848 0.03778366
  0.01314993 0.00248989 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 12: logL = -583.2
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #14
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.83 0.17]
 [0.21 0.79]]
chi:
[[0.00138843 0.03148565 0.05032527 0.07198836 0.10239972 0.10621945
  0.13200009 0.40419304 0.1       ]
 [0.49882546 0.13519087 0.09891415 0.07254804 0.042208   0.03755902
  0.012855   0.00189945 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 13: logL = -583.1
2023-02-22 14:09 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.831e+02
2023-02-22 14:09 - INFO - TrainingManager : 71 -  >> BIC: 1.252e+03
2023-02-22 14:09 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.47 0.53]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12137825 0.04318221 0.05326902 0.05727254 0.06368263 0.07697164
  0.07511283 0.08887309 0.3202578  0.1       ]
 [0.33062482 0.08333477 0.07923426 0.0691772  0.06273652 0.05541853
  0.05125178 0.04346029 0.12476183 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 0: logL = -686.5
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.43 0.57]
A:
[[0.74 0.26]
 [0.26 0.74]]
chi:
[[0.08841741 0.03790058 0.05093864 0.05596153 0.06387075 0.08333348
  0.07688665 0.09605282 0.34663814 0.1       ]
 [0.36568185 0.08899893 0.08179151 0.07059681 0.06253818 0.04878474
  0.04927642 0.03582513 0.09650644 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 1: logL = -628.2
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.36 0.64]
A:
[[0.78 0.22]
 [0.23 0.77]]
chi:
[[0.05782051 0.03220691 0.04851412 0.05392384 0.06369056 0.09017163
  0.07870348 0.10320828 0.37176067 0.1       ]
 [0.40090611 0.09554775 0.08468879 0.07289693 0.06271021 0.04123988
  0.04705168 0.02764261 0.06731603 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 2: logL = -622.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.27 0.73]
A:
[[0.8  0.2 ]
 [0.21 0.79]]
chi:
[[0.0354708  0.02737988 0.04657485 0.05136113 0.0631979  0.09615888
  0.08004885 0.10889186 0.39091586 0.1       ]
 [0.42894287 0.10147228 0.08719939 0.07586414 0.06322438 0.0342516
  0.04523026 0.02065481 0.04316026 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 3: logL = -615.6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.16 0.84]
A:
[[0.82 0.18]
 [0.19 0.81]]
chi:
[[0.02190172 0.02427503 0.04538123 0.04882883 0.06256185 0.10034158
  0.08067051 0.11263962 0.40339963 0.1       ]
 [0.44641717 0.10535784 0.08877912 0.07877881 0.06391307 0.02928556
  0.04431079 0.01597316 0.02718448 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 4: logL = -610.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.08 0.92]
A:
[[0.83 0.17]
 [0.19 0.81]]
chi:
[[0.01411643 0.02262195 0.04466721 0.04687756 0.06193997 0.10283508
  0.08077843 0.11492816 0.41123521 0.1       ]
 [0.45590791 0.10735119 0.08966032 0.08097309 0.06459263 0.02640243
  0.04410571 0.01325114 0.01775559 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 5: logL = -607.6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.03 0.97]
A:
[[0.83 0.17]
 [0.19 0.81]]
chi:
[[0.00946796 0.02175322 0.04413559 0.04565608 0.0614269  0.10424088
  0.08071414 0.11634364 0.41626159 0.1       ]
 [0.46112198 0.10832639 0.09025467 0.08231434 0.06515191 0.0248457
  0.04416276 0.01167499 0.01214725 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 6: logL = -606.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.83 0.17]
 [0.19 0.81]]
chi:
[[0.00651529 0.02122324 0.04367203 0.04500485 0.06102709 0.10504789
  0.08065264 0.11727777 0.4195792  0.1       ]
 [0.46425448 0.10888768 0.09075084 0.08301633 0.0655862  0.02398177
  0.04423611 0.01067723 0.00860936 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 7: logL = -605.8
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.82 0.18]
 [0.19 0.81]]
chi:
[[0.00455013 0.02083371 0.04326055 0.04471705 0.06070929 0.10553571
  0.08062831 0.11794577 0.42181947 0.1       ]
 [0.466311   0.10929585 0.09119003 0.08332263 0.065931   0.02346554
  0.04426898 0.00996955 0.00624543 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 8: logL = -605.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.82 0.18]
 [0.19 0.81]]
chi:
[[0.00320447 0.02051255 0.04290648 0.04464092 0.06044718 0.10584691
  0.08062771 0.11845708 0.4233567  0.1       ]
 [0.46774659 0.10963978 0.09157217 0.08340309 0.0662157  0.02313206
  0.04427182 0.00942003 0.00459876 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 9: logL = -605.2
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.30e-04 9.99e-01]
A:
[[0.82 0.18]
 [0.2  0.8 ]]
chi:
[[0.0022678  0.02023619 0.04261184 0.04468199 0.06022579 0.1060533
  0.08063369 0.11886734 0.42442208 0.1       ]
 [0.46878811 0.10994471 0.09189499 0.08336034 0.06645674 0.02290354
  0.04426352 0.00896851 0.00341954 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 10: logL = -605.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.88e-04 1.00e+00]
A:
[[0.82 0.18]
 [0.2  0.8 ]]
chi:
[[0.00160957 0.01999662 0.04237283 0.04478453 0.06003733 0.10619277
  0.08063606 0.11920647 0.42516383 0.1       ]
 [0.46956309 0.11021665 0.0921612  0.08325369 0.06666253 0.02274132
  0.04425634 0.00858571 0.00255946 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 11: logL = -604.9
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.7e-05 1.0e+00]
A:
[[0.82 0.18]
 [0.2  0.8 ]]
chi:
[[0.00114437 0.01978993 0.04218228 0.04491631 0.05987723 0.10628698
  0.08063092 0.11949205 0.42567994 0.1       ]
 [0.47015069 0.11045725 0.0923772  0.08311699 0.06683789 0.02262429
  0.0442556  0.00825573 0.00192436 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 12: logL = -604.8
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #14
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.39e-05 1.00e+00]
A:
[[0.82 0.18]
 [0.2  0.8 ]]
chi:
[[0.00081444 0.01961289 0.04203199 0.04505886 0.0597421  0.10634937
  0.08061809 0.11973541 0.42603684 0.1       ]
 [0.47060335 0.11066803 0.0925508  0.08296945 0.06698637 0.02253969
  0.04426232 0.00796864 0.00145136 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 13: logL = -604.8
2023-02-22 14:09 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -6.048e+02
2023-02-22 14:09 - INFO - TrainingManager : 71 -  >> BIC: 1.306e+03
2023-02-22 14:09 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:09 - INFO - cli : 125 - Training phase done in 00:00:04
2023-02-22 14:09 - INFO - cli : 155 - Process done in 00:00:04
2023-02-22 14:09 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_03
