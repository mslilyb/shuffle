2023-02-22 14:11 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/47.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/47.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:11 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/47.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/47.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_47
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:11 - INFO - cli : 50 - Loading input data
2023-02-22 14:11 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:11 - INFO - cli : 104 - Spawning training set
2023-02-22 14:11 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:11 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:11 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:11 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:11 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.58 0.42]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12734324 0.05378405 0.06197369 0.06759687 0.07204442 0.08875666
  0.0973957  0.33110536 0.1       ]
 [0.32177137 0.0960236  0.09388101 0.08233601 0.07195598 0.06136807
  0.05280735 0.11985662 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 0: logL = -651.3
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.68 0.32]
A:
[[0.74 0.26]
 [0.25 0.75]]
chi:
[[0.09949354 0.04971668 0.05565078 0.06214367 0.06738327 0.09288668
  0.10347458 0.3692508  0.1       ]
 [0.34655819 0.09948795 0.09964614 0.08745189 0.07647149 0.05767601
  0.04742119 0.08528714 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 1: logL = -604.2
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.81 0.19]
A:
[[0.78 0.22]
 [0.2  0.8 ]]
chi:
[[0.06993086 0.04525814 0.0483027  0.05522019 0.06164867 0.09796167
  0.1109378  0.41073996 0.1       ]
 [0.36821413 0.1024681  0.10542694 0.09326764 0.08155997 0.05379375
  0.04180964 0.05345984 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 2: logL = -597.6
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.92 0.08]
A:
[[0.81 0.19]
 [0.16 0.84]]
chi:
[[0.04535531 0.04099047 0.04140167 0.04821191 0.05594091 0.10253079
  0.11783982 0.44772912 0.1       ]
 [0.38030589 0.10440181 0.10963988 0.09815876 0.08588336 0.05119916
  0.03796425 0.0324469  0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 3: logL = -589.5
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.83 0.17]
 [0.13 0.87]]
chi:
[[0.02992858 0.03747777 0.03668742 0.04316621 0.05188911 0.10501401
  0.12167061 0.47416628 0.1       ]
 [0.38329788 0.10544879 0.11152461 0.1008327  0.08831972 0.05064402
  0.03712742 0.02280486 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 4: logL = -583.3
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.84 0.16]
 [0.12 0.88]]
chi:
[[0.02152009 0.03485844 0.03426517 0.04040353 0.04969703 0.10571844
  0.12237827 0.49115903 0.1       ]
 [0.38200144 0.1059725  0.11174501 0.10169402 0.08920857 0.0512982
  0.03844378 0.01963648 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 5: logL = -580.7
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.84 0.16]
 [0.11 0.89]]
chi:
[[0.01665128 0.03300708 0.03317699 0.03897462 0.04841912 0.1057757
  0.1215801  0.50241512 0.1       ]
 [0.37962094 0.10616403 0.11126431 0.10173536 0.08949998 0.05216056
  0.04043171 0.01912311 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 6: logL = -579.9
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.26e-04]
A:
[[0.84 0.16]
 [0.11 0.89]]
chi:
[[0.01341874 0.03176426 0.03269089 0.03813555 0.04738114 0.10579889
  0.12046158 0.51034895 0.1       ]
 [0.37735747 0.10613361 0.11062662 0.10154571 0.08972778 0.05282204
  0.04226359 0.01952318 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 7: logL = -579.6
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 4.6e-05]
A:
[[0.84 0.16]
 [0.11 0.89]]
chi:
[[0.0110297  0.03097279 0.03246507 0.03755224 0.04636627 0.10592981
  0.11947236 0.51621176 0.1       ]
 [0.37551245 0.10596992 0.11003049 0.10134176 0.09003146 0.05324314
  0.04371695 0.02015383 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 8: logL = -579.5
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 9.6e-06]
A:
[[0.84 0.16]
 [0.11 0.89]]
chi:
[[0.00914965 0.03049351 0.03235823 0.03709996 0.04535611 0.10614443
  0.11869733 0.52070078 0.1       ]
 [0.37408576 0.10574021 0.10952433 0.10117719 0.09040268 0.05348884
  0.04481867 0.02076231 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 9: logL = -579.4
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.04e-06]
A:
[[0.83 0.17]
 [0.11 0.89]]
chi:
[[0.00761802 0.03021823 0.03230926 0.03673272 0.04437851 0.10639523
  0.11810743 0.52424059 0.1       ]
 [0.37300197 0.10548914 0.109108   0.10105383 0.09080577 0.05362493
  0.04565081 0.02126556 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 10: logL = -579.3
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.37e-07]
A:
[[0.83 0.17]
 [0.11 0.89]]
chi:
[[0.00634582 0.03007036 0.03228838 0.03643067 0.04345886 0.10664839
  0.11765622 0.52710129 0.1       ]
 [0.37218205 0.10524336 0.10876973 0.10096206 0.09121182 0.05369661
  0.04628694 0.02164743 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 11: logL = -579.3
2023-02-22 14:11 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.793e+02
2023-02-22 14:11 - INFO - TrainingManager : 71 -  >> BIC: 1.244e+03
2023-02-22 14:11 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.58 0.42]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12726889 0.04722114 0.04773386 0.05334258 0.06738163 0.06279937
  0.07808255 0.08530306 0.33086693 0.1       ]
 [0.32204308 0.08464666 0.07815867 0.07258943 0.07060698 0.05722034
  0.04802363 0.04683284 0.11987837 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 0: logL = -686.6
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.68 0.32]
A:
[[0.74 0.26]
 [0.25 0.75]]
chi:
[[0.09939174 0.04428608 0.04157383 0.04754141 0.06542312 0.05972849
  0.08388802 0.08916975 0.36899757 0.1       ]
 [0.34700583 0.08709117 0.08381167 0.07801524 0.0724743  0.06026372
  0.04271105 0.04349476 0.08513227 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 1: logL = -627.2
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.81 0.19]
A:
[[0.78 0.22]
 [0.2  0.8 ]]
chi:
[[0.06987096 0.04089786 0.0343407  0.04091176 0.06334743 0.05565946
  0.0905117  0.09391775 0.41054239 0.1       ]
 [0.36882165 0.08927244 0.08957032 0.08347822 0.07424056 0.06402416
  0.03749364 0.04011719 0.05298183 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 2: logL = -620.5
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.92 0.08]
A:
[[0.81 0.19]
 [0.16 0.84]]
chi:
[[0.04542221 0.03753435 0.02735887 0.03520748 0.06158054 0.05090488
  0.09619241 0.09798888 0.44781038 0.1       ]
 [0.38090722 0.09071353 0.09394319 0.08712912 0.07544148 0.06789627
  0.03418276 0.03822765 0.03155878 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 3: logL = -612.3
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.83 0.17]
 [0.13 0.87]]
chi:
[[0.03015026 0.03481143 0.02227278 0.03190601 0.06058642 0.04660216
  0.09922522 0.09951591 0.47492982 0.1       ]
 [0.38367955 0.091399   0.09616698 0.08832197 0.07585176 0.07091079
  0.03349931 0.03870569 0.02146495 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 4: logL = -606.0
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.84 0.16]
 [0.12 0.88]]
chi:
[[0.02183277 0.03301059 0.01935474 0.03052198 0.06031483 0.04343812
  0.10011273 0.09881388 0.49260037 0.1       ]
 [0.38226207 0.09153553 0.09678372 0.08813968 0.07572278 0.07281976
  0.03427281 0.04060034 0.01786331 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 5: logL = -603.3
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.99e-01 9.48e-04]
A:
[[0.84 0.16]
 [0.11 0.89]]
chi:
[[0.01694275 0.03197792 0.01784455 0.02995396 0.06038202 0.04111063
  0.10023797 0.09740517 0.50414502 0.1       ]
 [0.38006038 0.09135589 0.09665334 0.08762847 0.07542279 0.07407782
  0.03524738 0.04259443 0.01695952 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 6: logL = -602.4
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.69e-04]
A:
[[0.84 0.16]
 [0.11 0.89]]
chi:
[[0.01358866 0.0314288  0.0170442  0.02962888 0.06053907 0.0392156
  0.10028983 0.09615654 0.51210843 0.1       ]
 [0.37815727 0.09104516 0.09629275 0.08717576 0.07512954 0.07505729
  0.03598532 0.04415305 0.01700387 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 7: logL = -602.1
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.99e-05]
A:
[[0.84 0.16]
 [0.11 0.89]]
chi:
[[0.01101701 0.03114437 0.01657106 0.02937243 0.06070669 0.0375591
  0.10040029 0.09524367 0.51798538 0.1       ]
 [0.37669371 0.09070935 0.09591373 0.08683877 0.07487918 0.07590848
  0.03648673 0.045269   0.01730106 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 8: logL = -602.0
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 5.3e-06]
A:
[[0.83 0.17]
 [0.11 0.89]]
chi:
[[0.00893306 0.03099653 0.01624692 0.02914553 0.0608766  0.03607175
  0.10054155 0.09460229 0.52258575 0.1       ]
 [0.37559036 0.09039607 0.0955851  0.08659526 0.0746617  0.07667707
  0.03683498 0.0460653  0.01759415 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 9: logL = -601.9
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 9.37e-07]
A:
[[0.83 0.17]
 [0.11 0.89]]
chi:
[[0.0072063  0.03091782 0.01599232 0.02893974 0.06105583 0.0347301
  0.10067733 0.09414273 0.52633782 0.1       ]
 [0.37475392 0.09012234 0.09532226 0.08641967 0.07446237 0.07737546
  0.03709325 0.04664919 0.01780154 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 10: logL = -601.8
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.65e-07]
A:
[[0.83 0.17]
 [0.11 0.89]]
chi:
[[0.0057674  0.0308737  0.01577197 0.0287514  0.06124882 0.03352503
  0.10078911 0.09380075 0.52947181 0.1       ]
 [0.37411391 0.08989161 0.09512276 0.08629463 0.07427207 0.07800729
  0.03729724 0.04709096 0.01790954 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 11: logL = -601.7
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.87e-08]
A:
[[0.83 0.17]
 [0.11 0.89]]
chi:
[[0.00457219 0.03084638 0.0155704  0.02857769 0.06145482 0.03245143
  0.10087177 0.0935373  0.53211801 0.1       ]
 [0.3736212  0.08970197 0.09497892 0.08620889 0.07408726 0.07857434
  0.03746535 0.04743326 0.01792882 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 12: logL = -601.7
2023-02-22 14:11 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -6.017e+02
2023-02-22 14:11 - INFO - TrainingManager : 71 -  >> BIC: 1.300e+03
2023-02-22 14:11 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:11 - INFO - cli : 125 - Training phase done in 00:00:00
2023-02-22 14:11 - INFO - cli : 155 - Process done in 00:00:00
2023-02-22 14:11 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_47
