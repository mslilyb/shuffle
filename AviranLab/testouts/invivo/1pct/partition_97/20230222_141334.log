2023-02-22 14:13 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/97.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/97.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:13 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/97.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/97.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_97
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:13 - INFO - cli : 50 - Loading input data
2023-02-22 14:13 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 104 - Spawning training set
2023-02-22 14:13 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:13 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:13 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.27 0.73]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12379631 0.05221396 0.06290176 0.07107183 0.07932812 0.08686195
  0.09363278 0.33019329 0.1       ]
 [0.32594239 0.09772721 0.087067   0.07891803 0.07068305 0.06316868
  0.05641533 0.1200783  0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -651.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.08 0.92]
A:
[[0.74 0.26]
 [0.26 0.74]]
chi:
[[0.09200669 0.04612891 0.06130886 0.07068716 0.08043759 0.08857693
  0.0952477  0.36560617 0.1       ]
 [0.35585809 0.10340756 0.08847133 0.0792436  0.06964971 0.06164105
  0.05507738 0.08665127 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -604.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.77 0.23]
 [0.22 0.78]]
chi:
[[0.05983656 0.03930205 0.05982972 0.07043123 0.08162843 0.09074076
  0.09746312 0.40076813 0.1       ]
 [0.38308488 0.10916801 0.08952011 0.07937296 0.06865565 0.05993386
  0.0534996  0.05676493 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -598.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.27e-04 9.99e-01]
A:
[[0.79 0.21]
 [0.19 0.81]]
chi:
[[0.03409681 0.03273408 0.05894315 0.07022155 0.08225067 0.09274011
  0.09942522 0.42958841 0.1       ]
 [0.40084216 0.11393141 0.08979007 0.07940146 0.06832136 0.05865947
  0.05250177 0.0365523  0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -591.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.93e-05 1.00e+00]
A:
[[0.81 0.19]
 [0.17 0.83]]
chi:
[[0.01774242 0.02743213 0.05881902 0.06964468 0.08187597 0.09393774
  0.10037217 0.45017587 0.1       ]
 [0.40842971 0.11709911 0.08932069 0.07973963 0.06891454 0.05823948
  0.05254481 0.02571202 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -586.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.17e-07 1.00e+00]
A:
[[0.81 0.19]
 [0.16 0.84]]
chi:
[[0.00882045 0.02353104 0.05903868 0.06843796 0.08070119 0.09436029
  0.10048994 0.46462044 0.1       ]
 [0.4095     0.11892655 0.08862231 0.08060042 0.07013427 0.05847682
  0.05324543 0.02049421 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -584.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.09e-09 1.00e+00]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[0.0042884  0.02057297 0.05912372 0.06674918 0.0791387  0.09436102
  0.10034728 0.47541874 0.1       ]
 [0.40746803 0.11999625 0.08812534 0.08182117 0.07157843 0.05899374
  0.05404475 0.0179723  0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -583.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.59e-12 1.00e+00]
A:
[[0.81 0.19]
 [0.15 0.85]]
chi:
[[0.00205335 0.0181343  0.05889495 0.06487517 0.07749062 0.0941728
  0.10025534 0.48412349 0.1       ]
 [0.40424514 0.12071901 0.08794818 0.08314018 0.07299759 0.05958541
  0.05469516 0.01666934 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -582.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.92e-15 1.00e+00]
A:
[[0.81 0.19]
 [0.15 0.85]]
chi:
[[0.00096975 0.01598422 0.05837732 0.06304007 0.07592536 0.09388356
  0.10027567 0.49154405 0.1       ]
 [0.40071331 0.12128776 0.08803764 0.08438051 0.07427421 0.06018909
  0.05517557 0.0159419  0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -582.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.57e-18 1.00e+00]
A:
[[0.81 0.19]
 [0.15 0.85]]
chi:
[[4.52119398e-04 1.40204841e-02 5.76561759e-02 6.13620044e-02
  7.45255645e-02 9.35191523e-02 1.00380130e-01 4.98084369e-01
  1.00000000e-01]
 [3.97248052e-01 1.21776673e-01 8.83042446e-02 8.54615469e-02
  7.53639339e-02 6.07941749e-02 5.55311989e-02 1.55201751e-02
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -582.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.01e-22 1.00e+00]
A:
[[0.81 0.19]
 [0.15 0.85]]
chi:
[[2.08278310e-04 1.22028768e-02 5.68127330e-02 5.98875338e-02
  7.33237691e-02 9.30895353e-02 1.00530157e-01 5.03945117e-01
  1.00000000e-01]
 [3.93999159e-01 1.22211085e-01 8.86732474e-02 8.63616021e-02
  7.62601959e-02 6.14002275e-02 5.58063436e-02 1.52881393e-02
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 10: logL = -582.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.8e-26 1.0e+00]
A:
[[0.8  0.2 ]
 [0.14 0.86]]
chi:
[[9.48972120e-05 1.05186817e-02 5.59083595e-02 5.86244940e-02
  7.23233804e-02 9.26044807e-02 1.00697383e-01 5.09228323e-01
  1.00000000e-01]
 [3.91018062e-01 1.22598135e-01 8.90928646e-02 8.70878973e-02
  7.69757986e-02 6.20049112e-02 5.60309783e-02 1.51913525e-02
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 11: logL = -582.0
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.66e-30 1.00e+00]
A:
[[0.8  0.2 ]
 [0.14 0.86]]
chi:
[[4.28022338e-05 8.96732477e-03 5.49860170e-02 5.75615501e-02
  7.15113741e-02 9.20769237e-02 1.00864281e-01 5.13989727e-01
  1.00000000e-01]
 [3.88313724e-01 1.22938195e-01 8.95296889e-02 8.76599114e-02
  7.75326618e-02 6.26025483e-02 5.62231297e-02 1.52001407e-02
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 12: logL = -581.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #14
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.75e-35 1.00e+00]
A:
[[0.8  0.2 ]
 [0.14 0.86]]
chi:
[[1.91258939e-05 7.55323272e-03 5.40752251e-02 5.66785302e-02
  7.08663864e-02 9.15223128e-02 1.01020778e-01 5.18264409e-01
  1.00000000e-01]
 [3.85877327e-01 1.23229236e-01 8.99627023e-02 8.81011541e-02
  7.79558277e-02 6.31853712e-02 5.63932930e-02 1.52950890e-02
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 13: logL = -581.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #15
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.76e-40 1.00e+00]
A:
[[0.8  0.2 ]
 [0.14 0.86]]
chi:
[[8.47257323e-06 6.28183652e-03 5.31963463e-02 5.59518326e-02
  7.03638919e-02 9.09569911e-02 1.01161356e-01 5.22079273e-01
  1.00000000e-01]
 [3.83693128e-01 1.23468938e-01 9.03787570e-02 8.84352316e-02
  7.82699831e-02 6.37450658e-02 5.65476279e-02 1.54612687e-02
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 14: logL = -581.8
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.818e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 1.249e+03
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.27 0.73]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12370392 0.04497519 0.0509079  0.05702357 0.06579787 0.06965638
  0.0732495  0.08441382 0.33027185 0.1       ]
 [0.32605069 0.08697388 0.07506281 0.06896195 0.06620164 0.05635974
  0.05277533 0.04763079 0.11998317 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -686.6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.08 0.92]
A:
[[0.74 0.26]
 [0.26 0.74]]
chi:
[[0.09176618 0.03941846 0.0492907  0.05603628 0.06541094 0.07174784
  0.07312076 0.08740497 0.36580388 0.1       ]
 [0.35610876 0.09215757 0.07649064 0.06985265 0.06657967 0.05439169
  0.05304067 0.04493643 0.08644192 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -627.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.77 0.23]
 [0.22 0.78]]
chi:
[[0.05941475 0.0332665  0.04797383 0.05495243 0.06465454 0.07453898
  0.07279494 0.09130717 0.40109685 0.1       ]
 [0.38339348 0.0973118  0.07737354 0.07069804 0.06728702 0.05196219
  0.05363048 0.04179198 0.05655147 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -621.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.96e-04 9.99e-01]
A:
[[0.79 0.21]
 [0.19 0.81]]
chi:
[[0.03352194 0.02748123 0.04732476 0.05398699 0.06312865 0.07771656
  0.07164615 0.09521036 0.42998337 0.1       ]
 [0.40102292 0.10140973 0.07741001 0.07128553 0.06863959 0.04947129
  0.05505172 0.03914736 0.03656185 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -614.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.78e-05 1.00e+00]
A:
[[0.81 0.19]
 [0.17 0.83]]
chi:
[[0.0171347  0.02295401 0.04731231 0.0531935  0.06078395 0.0807381
  0.0695975  0.09799389 0.45029202 0.1       ]
 [0.4084664  0.10399332 0.07684629 0.07165543 0.07060379 0.04734397
  0.0571769  0.03776151 0.0261524  0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -609.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.89e-07 1.00e+00]
A:
[[0.82 0.18]
 [0.16 0.84]]
chi:
[[0.00832072 0.01975314 0.04740955 0.05245592 0.05821728 0.08317628
  0.06749443 0.09940782 0.46376485 0.1       ]
 [0.40968328 0.10541781 0.07628829 0.07198708 0.07263348 0.04580305
  0.05916924 0.03752535 0.02149242 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -606.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.75e-10 1.00e+00]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[0.00394512 0.01743982 0.04717156 0.05172434 0.05596201 0.08492229
  0.06593579 0.0999507  0.47294836 0.1       ]
 [0.40813867 0.10623095 0.07611348 0.07234161 0.07431624 0.04483791
  0.06056777 0.03787266 0.01958073 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -605.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.84e-12 1.00e+00]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[0.00184291 0.01561154 0.04649915 0.05103803 0.05415164 0.08609409
  0.06490614 0.10014677 0.47970972 0.1       ]
 [0.40558973 0.10677683 0.0763533  0.07268022 0.07558827 0.04431112
  0.06145745 0.03836675 0.01887632 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -605.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.79e-15 1.00e+00]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[0.00085054 0.01403254 0.04548636 0.05043233 0.0527233  0.08686325
  0.06420511 0.10027116 0.48513541 0.1       ]
 [0.40277032 0.10721479 0.07688986 0.07296727 0.07652959 0.04407434
  0.06204424 0.03881995 0.01868965 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -604.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.07e-19 1.00e+00]
A:
[[0.82 0.18]
 [0.14 0.86]]
chi:
[[3.88492566e-04 1.25866217e-02 4.42658621e-02 4.99121046e-02
  5.15844757e-02 8.73705109e-02 6.36776979e-02 1.00417842e-01
  4.89796393e-01 1.00000000e-01]
 [3.99970970e-01 1.07608690e-01 7.75937771e-02 7.31953893e-02
  7.72296039e-02 4.40155234e-02 6.24720775e-02 3.91887149e-02
  1.87252542e-02 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -604.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.68e-22 1.00e+00]
A:
[[0.81 0.19]
 [0.14 0.86]]
chi:
[[1.75889147e-04 1.12238352e-02 4.29478427e-02 4.94649859e-02
  5.06618166e-02 8.77106181e-02 6.32377388e-02 1.00600371e-01
  4.93976903e-01 1.00000000e-01]
 [3.97304082e-01 1.07980181e-01 7.83678738e-02 7.33731676e-02
  7.77551075e-02 4.40619050e-02 6.28177982e-02 3.94824478e-02
  1.88574378e-02 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 10: logL = -604.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.61e-26 1.00e+00]
A:
[[0.81 0.19]
 [0.14 0.86]]
chi:
[[7.90307973e-05 9.92837443e-03 4.16100270e-02 4.90746147e-02
  4.99041070e-02 8.79416432e-02 6.28437535e-02 1.00806289e-01
  4.97812160e-01 1.00000000e-01]
 [3.94810999e-01 1.08332997e-01 7.91490176e-02 7.35133976e-02
  7.81520891e-02 4.41695399e-02 6.31179631e-02 3.97219220e-02
  1.90320751e-02 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 11: logL = -604.6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.03e-31 1.00e+00]
A:
[[0.81 0.19]
 [0.14 0.86]]
chi:
[[3.52741843e-05 8.70118714e-03 4.03036687e-02 4.87264887e-02
  4.92759389e-02 8.80976798e-02 6.24782096e-02 1.01018866e-01
  5.01362687e-01 1.00000000e-01]
 [3.92504750e-01 1.08663681e-01 7.98992862e-02 7.36278036e-02
  7.84524396e-02 4.43127122e-02 6.33885159e-02 3.99255728e-02
  1.92252391e-02 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 12: logL = -604.6
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -6.046e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 1.306e+03
2023-02-22 14:13 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:13 - INFO - cli : 125 - Training phase done in 00:00:00
2023-02-22 14:13 - INFO - cli : 155 - Process done in 00:00:00
2023-02-22 14:13 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_97
