2023-02-22 14:11 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/55.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/55.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:11 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/55.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/55.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_55
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:11 - INFO - cli : 50 - Loading input data
2023-02-22 14:11 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:11 - INFO - cli : 104 - Spawning training set
2023-02-22 14:11 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:11 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:11 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:11 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:11 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.58 0.42]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.124452   0.05237769 0.06419792 0.06442011 0.08174109 0.09132022
  0.10068155 0.32080942 0.1       ]
 [0.32526722 0.10355076 0.08577192 0.07955872 0.06827773 0.05872536
  0.05538179 0.12346651 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 0: logL = -651.3
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.67 0.33]
A:
[[0.74 0.26]
 [0.26 0.74]]
chi:
[[0.09516017 0.04347786 0.06409051 0.05879399 0.08600204 0.09785547
  0.10555242 0.34906754 0.1       ]
 [0.35514121 0.11260227 0.08593481 0.08523666 0.06397242 0.05209148
  0.05038363 0.09463751 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 1: logL = -605.5
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.78 0.22]
A:
[[0.78 0.22]
 [0.22 0.78]]
chi:
[[0.06761187 0.03391297 0.06413465 0.05199631 0.0912933  0.10434911
  0.11079823 0.37590357 0.1       ]
 [0.38453798 0.12268924 0.08601377 0.09227693 0.05848414 0.04525
  0.04475376 0.06599417 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 2: logL = -599.7
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.87 0.13]
A:
[[0.81 0.19]
 [0.19 0.81]]
chi:
[[0.0482905  0.02587403 0.06455993 0.04537555 0.09677368 0.10890008
  0.11527273 0.3949535  0.1       ]
 [0.40716004 0.13173378 0.08576209 0.09944568 0.05255471 0.04005428
  0.0395776  0.04371181 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 3: logL = -593.1
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.94 0.06]
A:
[[0.83 0.17]
 [0.18 0.82]]
chi:
[[0.0386     0.02065413 0.06547349 0.0404123  0.10138241 0.11062103
  0.11801413 0.40484252 0.1       ]
 [0.42087545 0.13826099 0.08501078 0.10519343 0.04727647 0.03756821
  0.03595179 0.02986288 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 4: logL = -588.4
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.03514966 0.01774012 0.06673934 0.03730964 0.10474065 0.11044251
  0.1191414  0.40873667 0.1       ]
 [0.42847147 0.14258332 0.08385333 0.10917928 0.04312556 0.03701461
  0.03390684 0.02186559 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 5: logL = -586.4
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.03456126 0.01615845 0.0681499  0.03550388 0.10703145 0.10959119
  0.11931552 0.40968836 0.1       ]
 [0.43312274 0.14558412 0.08248619 0.11188513 0.03999414 0.0371967
  0.03284795 0.01688303 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 6: logL = -585.7
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.99e-01 9.40e-04]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.03503264 0.01528094 0.06955781 0.03448219 0.10854559 0.10871207
  0.11905687 0.4093319  0.1       ]
 [0.43651853 0.14783433 0.08105959 0.11377408 0.03764877 0.0374634
  0.03228537 0.01341592 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 7: logL = -585.4
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.48e-04]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.03580337 0.01478857 0.07088464 0.03393623 0.10952196 0.10800542
  0.11864247 0.40841734 0.1       ]
 [0.4393398  0.14961187 0.07966227 0.11512223 0.03589027 0.03760834
  0.03195637 0.01080883 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 8: logL = -585.2
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.87e-05]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.036591   0.01452044 0.07209514 0.03368953 0.110133   0.10748698
  0.11819921 0.4072847  0.1       ]
 [0.44183269 0.15105619 0.07834309 0.11609005 0.03456678 0.03761199
  0.03173627 0.00876295 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 9: logL = -585.1
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.93e-06]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.03730628 0.01438939 0.07317753 0.03363519 0.11049851 0.10712048
  0.11778045 0.40609218 0.1       ]
 [0.44408181 0.15224823 0.07712725 0.11678057 0.03356506 0.037508
  0.03156706 0.00712202 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 10: logL = -585.0
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.62e-07]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.03793231 0.01434433 0.07413234 0.03370412 0.11070046 0.10686481
  0.11740594 0.4049157  0.1       ]
 [0.44611636 0.15324181 0.07602558 0.11726621 0.03280161 0.03733539
  0.03142168 0.00579135 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 11: logL = -585.0
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.11e-08]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.03847635 0.01435339 0.07496652 0.03384985 0.11079461 0.10668653
  0.1170805  0.40379225 0.1       ]
 [0.44794883 0.1540758  0.07504002 0.11760028 0.03221526 0.03712558
  0.03128768 0.00470655 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 12: logL = -584.9
2023-02-22 14:11 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.849e+02
2023-02-22 14:11 - INFO - TrainingManager : 71 -  >> BIC: 1.255e+03
2023-02-22 14:11 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.58 0.42]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.1240504  0.04391286 0.05139195 0.0563603  0.06404471 0.07078503
  0.08360448 0.0850617  0.32078858 0.1       ]
 [0.32572103 0.08803713 0.08057498 0.06363145 0.06795086 0.0552326
  0.04843538 0.04698146 0.1234351  0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 0: logL = -686.6
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.67 0.33]
A:
[[0.74 0.26]
 [0.25 0.75]]
chi:
[[0.09430995 0.03703866 0.04668248 0.0579584  0.06135908 0.07401047
  0.09127807 0.08836257 0.34900032 0.1       ]
 [0.35591036 0.09501016 0.08535009 0.06204504 0.07064875 0.05197097
  0.04067931 0.04359973 0.09478559 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 1: logL = -628.7
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.77 0.23]
A:
[[0.78 0.22]
 [0.22 0.78]]
chi:
[[0.06624584 0.02993384 0.04097672 0.05987944 0.05810906 0.07790243
  0.09883943 0.0923079  0.37580535 0.1       ]
 [0.38515089 0.10238347 0.09124344 0.06012162 0.07396036 0.04796646
  0.03287164 0.03946064 0.06684147 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 2: logL = -622.9
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.87 0.13]
A:
[[0.81 0.19]
 [0.19 0.81]]
chi:
[[0.04620271 0.0242669  0.03504405 0.06197617 0.05496235 0.08185975
  0.10434589 0.09618057 0.39516162 0.1       ]
 [0.40690897 0.10845939 0.09749469 0.05798943 0.07722975 0.04381203
  0.02698677 0.03529419 0.04582479 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 3: logL = -616.5
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.94 0.06]
A:
[[0.83 0.17]
 [0.17 0.83]]
chi:
[[0.03544387 0.02083352 0.02999616 0.06386208 0.0526896  0.0850482
  0.10709713 0.09911166 0.40591777 0.1       ]
 [0.41922224 0.11227829 0.10289011 0.05604285 0.07963804 0.04040906
  0.02389122 0.03207327 0.03355492 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 4: logL = -612.0
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.83 0.17]
 [0.17 0.83]]
chi:
[[0.03061796 0.01910743 0.02630351 0.06522025 0.05144687 0.08722653
  0.10802474 0.1009095  0.41114321 0.1       ]
 [0.42514756 0.11428344 0.10687392 0.05462491 0.08098478 0.03805489
  0.02272878 0.03005506 0.02724665 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 5: logL = -610.1
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.0285091  0.01828778 0.02375127 0.06601902 0.05093836 0.08867637
  0.10820467 0.10190601 0.41370741 0.1       ]
 [0.428037   0.11530175 0.10965624 0.05378046 0.08156342 0.03646823
  0.02238928 0.02889778 0.02390585 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 6: logL = -609.6
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.02747308 0.01787587 0.02197641 0.06639395 0.05083365 0.08970304
  0.10819093 0.1024466  0.41510646 0.1       ]
 [0.42966384 0.11586292 0.11161422 0.05337503 0.08171433 0.03533214
  0.02228465 0.02823654 0.02191634 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 7: logL = -609.4
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.99e-01 5.10e-04]
A:
[[0.83 0.17]
 [0.17 0.83]]
chi:
[[0.02684481 0.01763842 0.02070628 0.06649594 0.05091493 0.09048658
  0.10817241 0.10274404 0.41599659 0.1       ]
 [0.43074488 0.11621391 0.11302854 0.05325526 0.08166285 0.03446064
  0.02221231 0.0278486  0.02057301 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 8: logL = -609.3
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.19e-04]
A:
[[0.83 0.17]
 [0.17 0.83]]
chi:
[[0.02637821 0.01747692 0.01976894 0.06643782 0.05106498 0.09111737
  0.10818947 0.1029116  0.41665469 0.1       ]
 [0.43154946 0.1164598  0.1140763  0.05330522 0.08153112 0.03376037
  0.0221266  0.02761513 0.01957598 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 9: logL = -609.3
2023-02-22 14:11 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -6.093e+02
2023-02-22 14:11 - INFO - TrainingManager : 71 -  >> BIC: 1.316e+03
2023-02-22 14:11 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:11 - INFO - cli : 125 - Training phase done in 00:00:01
2023-02-22 14:11 - INFO - cli : 155 - Process done in 00:00:01
2023-02-22 14:11 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_55
