2023-02-22 14:09 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/01.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/01.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:09 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/01.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/01.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_01
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:09 - INFO - cli : 50 - Loading input data
2023-02-22 14:09 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:09 - INFO - cli : 104 - Spawning training set
2023-02-22 14:09 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:09 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:09 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:09 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:09 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.34 0.66]
A:
[[0.73 0.27]
 [0.27 0.73]]
chi:
[[0.10978164 0.04981969 0.05578756 0.07271876 0.08101089 0.09456214
  0.10412995 0.33218937 0.1       ]
 [0.3469564  0.10635624 0.08229492 0.07729548 0.06895158 0.05531573
  0.04568819 0.11714145 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 0: logL = -649.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.16 0.84]
A:
[[0.78 0.22]
 [0.23 0.77]]
chi:
[[0.06084844 0.03701406 0.05029305 0.07454884 0.08449383 0.1071386
  0.11817828 0.36748491 0.1       ]
 [0.40215602 0.12070345 0.08849086 0.07547007 0.06510834 0.04151464
  0.03001235 0.07654429 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 1: logL = -595.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.03 0.97]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.02510706 0.02444343 0.04416018 0.07702953 0.08892655 0.11964898
  0.12940921 0.39127505 0.1       ]
 [0.45470186 0.13784129 0.0967547  0.07273231 0.05943921 0.02511158
  0.01420602 0.03921303 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 2: logL = -578.5
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.87 0.13]
 [0.16 0.84]]
chi:
[[0.01058896 0.01641135 0.03997707 0.07983673 0.09315861 0.12667853
  0.13369371 0.39965504 0.1       ]
 [0.48746431 0.15150159 0.10363676 0.06922771 0.05332901 0.01332543
  0.00495332 0.01656187 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 3: logL = -561.8
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.16e-04 1.00e+00]
A:
[[0.87 0.13]
 [0.16 0.84]]
chi:
[[0.00590524 0.01230368 0.03784255 0.08197779 0.0959651  0.12965303
  0.13443475 0.40191785 0.1       ]
 [0.5028986  0.15931586 0.10756525 0.06636322 0.04905037 0.00735301
  0.00143442 0.00601928 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 4: logL = -554.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.16e-05 1.00e+00]
A:
[[0.87 0.13]
 [0.16 0.84]]
chi:
[[3.82903589e-03 9.95816355e-03 3.68065245e-02 8.33060783e-02
  9.77556308e-02 1.31337052e-01 1.34419365e-01 4.02588150e-01
  1.00000000e-01]
 [5.09589965e-01 1.63470027e-01 1.09439491e-01 6.45664083e-02
  4.64157571e-02 4.23281294e-03 3.60998705e-04 1.92453960e-03
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 5: logL = -551.7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.99e-07 1.00e+00]
A:
[[0.87 0.13]
 [0.16 0.84]]
chi:
[[2.61213578e-03 8.41915961e-03 3.62985782e-02 8.40740203e-02
  9.89544333e-02 1.32470787e-01 1.34356463e-01 4.02814423e-01
  1.00000000e-01]
 [5.12463962e-01 1.65818577e-01 1.10272746e-01 6.35476009e-02
  4.47669036e-02 2.46562522e-03 8.56979882e-05 5.78886926e-04
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 6: logL = -550.7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.08e-08 1.00e+00]
A:
[[0.87 0.13]
 [0.17 0.83]]
chi:
[[1.82121255e-03 7.34130101e-03 3.60441309e-02 8.45006594e-02
  9.97459036e-02 1.33229579e-01 1.34351078e-01 4.02966135e-01
  1.00000000e-01]
 [5.13737936e-01 1.67265094e-01 1.10634064e-01 6.29975534e-02
  4.37378136e-02 1.43695716e-03 2.01363104e-05 1.70445549e-04
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 7: logL = -550.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.59e-09 1.00e+00]
A:
[[0.87 0.13]
 [0.17 0.83]]
chi:
[[1.28479950e-03 6.55848569e-03 3.59074887e-02 8.47292591e-02
  1.00254049e-01 1.33732699e-01 1.34390349e-01 4.03142869e-01
  1.00000000e-01]
 [5.14284942e-01 1.68212874e-01 1.10787616e-01 6.27143643e-02
  4.31104139e-02 8.35200194e-04 4.75171685e-06 4.98382254e-05
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 8: logL = -550.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.23e-11 1.00e+00]
A:
[[0.87 0.13]
 [0.17 0.83]]
chi:
[[9.12639227e-04 5.97451133e-03 3.58223422e-02 8.48456515e-02
  1.00571306e-01 1.34070294e-01 1.34453025e-01 4.03350231e-01
  1.00000000e-01]
 [5.14466429e-01 1.68858798e-01 1.10852990e-01 6.25798961e-02
  4.27422785e-02 4.83936366e-04 1.12912776e-06 1.45430221e-05
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 9: logL = -550.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.28e-12 1.00e+00]
A:
[[0.87 0.13]
 [0.17 0.83]]
chi:
[[6.50909179e-04 5.52915381e-03 3.57578391e-02 8.48994293e-02
  1.00763672e-01 1.34302938e-01 1.34524696e-01 4.03571363e-01
  1.00000000e-01]
 [5.14454558e-01 1.69311578e-01 1.10884348e-01 6.25269497e-02
  4.25383739e-02 2.79679805e-04 2.70066876e-07 4.24259082e-06
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 10: logL = -549.9
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.24e-13 1.00e+00]
A:
[[0.87 0.13]
 [0.17 0.83]]
chi:
[[4.65302096e-04 5.18308333e-03 3.57008221e-02 8.49188867e-02
  1.00876432e-01 1.34468744e-01 1.34596890e-01 4.03789840e-01
  1.00000000e-01]
 [5.14341915e-01 1.69636729e-01 1.10905478e-01 6.25175389e-02
  4.24357045e-02 1.61331162e-04 6.49523785e-08 1.23818276e-06
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 11: logL = -549.9
2023-02-22 14:09 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.499e+02
2023-02-22 14:09 - INFO - TrainingManager : 71 -  >> BIC: 1.185e+03
2023-02-22 14:09 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.33 0.67]
A:
[[0.73 0.27]
 [0.28 0.72]]
chi:
[[0.10973606 0.04013076 0.04877908 0.05551707 0.06783537 0.07296
  0.08033349 0.09243959 0.33226859 0.1       ]
 [0.34717987 0.08604636 0.0833543  0.06451765 0.06415042 0.05296286
  0.04553227 0.03935564 0.11690064 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 0: logL = -684.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.13 0.87]
A:
[[0.78 0.22]
 [0.23 0.77]]
chi:
[[0.06091618 0.03077115 0.03950675 0.05610474 0.07049071 0.07965728
  0.09001823 0.10472962 0.36780534 0.1       ]
 [0.40230312 0.09662138 0.09363796 0.06406357 0.06131526 0.045623
  0.03481437 0.02559696 0.07602437 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 1: logL = -618.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.02 0.98]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.02534469 0.02151327 0.03010143 0.05687992 0.07375794 0.08697492
  0.0997796  0.11431056 0.39133767 0.1       ]
 [0.45481965 0.10943355 0.10617907 0.06349212 0.05731702 0.03616634
  0.02183485 0.01192895 0.03882845 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 2: logL = -601.5
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.87 0.13]
 [0.16 0.84]]
chi:
[[0.01082146 0.01544951 0.02432312 0.05812648 0.07636287 0.09240015
  0.10561956 0.11777104 0.3991258  0.1       ]
 [0.48775151 0.1198717  0.11584669 0.06224078 0.05360572 0.02783661
  0.01202583 0.00408041 0.01674074 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 3: logL = -585.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.38e-05 1.00e+00]
A:
[[0.87 0.13]
 [0.16 0.84]]
chi:
[[0.0060607  0.01214708 0.02170424 0.05941196 0.07747596 0.09573963
  0.10824064 0.11822341 0.40099638 0.1       ]
 [0.50359253 0.12614647 0.12100414 0.0607302  0.05174976 0.02234566
  0.00682255 0.00115173 0.00645696 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 4: logL = -577.9
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.2e-06 1.0e+00]
A:
[[0.87 0.13]
 [0.16 0.84]]
chi:
[[3.92174157e-03 1.01304138e-02 2.04661393e-02 6.04562263e-02
  7.77628393e-02 9.80873895e-02 1.09753332e-01 1.18036986e-01
  4.01384932e-01 1.00000000e-01]
 [5.11009213e-01 1.29773903e-01 1.23508935e-01 5.94237895e-02
  5.11436194e-02 1.86848818e-02 3.95088097e-03 2.77664777e-04
  2.22711127e-03 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 5: logL = -575.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.06e-08 1.00e+00]
A:
[[0.87 0.13]
 [0.17 0.83]]
chi:
[[2.66270402e-03 8.77619890e-03 1.97822515e-02 6.12727562e-02
  7.77379642e-02 9.98131301e-02 1.10775137e-01 1.17842549e-01
  4.01337309e-01 1.00000000e-01]
 [5.14604115e-01 1.31966677e-01 1.24783864e-01 5.83811949e-02
  5.10706079e-02 1.61777706e-02 2.23530986e-03 6.20122022e-05
  7.18449207e-04 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 6: logL = -574.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.6e-10 1.0e+00]
A:
[[0.87 0.13]
 [0.17 0.83]]
chi:
[[1.84917602e-03 7.84261462e-03 1.93634482e-02 6.19119378e-02
  7.76141142e-02 1.01039084e-01 1.11430844e-01 1.17731440e-01
  4.01217342e-01 1.00000000e-01]
 [5.16468473e-01 1.33356439e-01 1.25487623e-01 5.75612127e-02
  5.11855247e-02 1.44789460e-02 1.22365384e-03 1.35522763e-05
  2.24575203e-04 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 7: logL = -573.9
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.86e-11 1.00e+00]
A:
[[0.87 0.13]
 [0.17 0.83]]
chi:
[[1.30284291e-03 7.19064803e-03 1.90904071e-02 6.24128279e-02
  7.74788321e-02 1.01884901e-01 1.11823541e-01 1.17680095e-01
  4.01135904e-01 1.00000000e-01]
 [5.17499127e-01 1.34270231e-01 1.25904969e-01 5.69187458e-02
  5.13411842e-02 1.33428051e-02 6.50860629e-04 2.95490879e-06
  6.91225362e-05 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 8: logL = -573.7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.53e-13 1.00e+00]
A:
[[0.87 0.13]
 [0.17 0.83]]
chi:
[[9.27066588e-04 6.72909942e-03 1.89044146e-02 6.28046610e-02
  7.73626913e-02 1.02458593e-01 1.12048498e-01 1.17661390e-01
  4.01103586e-01 1.00000000e-01]
 [5.18094146e-01 1.34888175e-01 1.26166368e-01 5.64169409e-02
  5.14837379e-02 1.25901755e-02 3.38713544e-04 6.46013720e-07
  2.10977538e-05 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 9: logL = -573.5
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.09e-14 1.00e+00]
A:
[[0.87 0.13]
 [0.17 0.83]]
chi:
[[6.64210171e-04 6.39772967e-03 1.87735991e-02 6.31102599e-02
  7.72717895e-02 1.02843786e-01 1.12174939e-01 1.17658795e-01
  4.01104892e-01 1.00000000e-01]
 [5.18446764e-01 1.35315698e-01 1.26336981e-01 5.60262969e-02
  5.15990348e-02 1.20951302e-02 1.73544929e-04 1.41702497e-07
  6.40790821e-06 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 10: logL = -573.5
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.64e-16 1.00e+00]
A:
[[0.87 0.13]
 [0.17 0.83]]
chi:
[[4.78128931e-04 6.15672422e-03 1.86794781e-02 6.33478915e-02
  7.72035000e-02 1.03100615e-01 1.12246270e-01 1.17663445e-01
  4.01123947e-01 1.00000000e-01]
 [5.18658826e-01 1.35617194e-01 1.26451891e-01 5.57230739e-02
  5.16875466e-02 1.17715283e-02 8.79689240e-05 3.11705864e-08
  1.94037430e-06 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 11: logL = -573.4
2023-02-22 14:09 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -5.734e+02
2023-02-22 14:09 - INFO - TrainingManager : 71 -  >> BIC: 1.244e+03
2023-02-22 14:09 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:09 - INFO - cli : 125 - Training phase done in 00:00:02
2023-02-22 14:09 - INFO - cli : 155 - Process done in 00:00:02
2023-02-22 14:09 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_01
