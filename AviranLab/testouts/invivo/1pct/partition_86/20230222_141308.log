2023-02-22 14:13 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/86.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/86.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:13 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/86.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/86.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_86
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:13 - INFO - cli : 50 - Loading input data
2023-02-22 14:13 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 104 - Spawning training set
2023-02-22 14:13 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:13 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:13 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.47 0.53]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12794249 0.05307148 0.05282374 0.0661792  0.07889906 0.08562937
  0.10229293 0.33316173 0.1       ]
 [0.32109901 0.1086527  0.08501651 0.08373369 0.07113944 0.0644756
  0.04797661 0.11790645 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -650.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.44 0.56]
A:
[[0.75 0.25]
 [0.24 0.76]]
chi:
[[0.10043904 0.04235398 0.04426064 0.05865447 0.07900781 0.08577394
  0.11501257 0.37449755 0.1       ]
 [0.34516976 0.11828362 0.09286722 0.0907693  0.07113348 0.06460587
  0.03639801 0.08077275 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -602.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.4 0.6]
A:
[[0.78 0.22]
 [0.2  0.8 ]]
chi:
[[0.07130126 0.03118247 0.03423632 0.04871741 0.07865672 0.08612608
  0.13038853 0.41939121 0.1       ]
 [0.36499618 0.1263762  0.10066442 0.09893944 0.07166929 0.06486583
  0.02454947 0.04793916 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -594.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.36 0.64]
A:
[[0.8  0.2 ]
 [0.16 0.84]]
chi:
[[0.04772908 0.02237272 0.02505211 0.03769744 0.07725183 0.08581513
  0.14525997 0.45882171 0.1       ]
 [0.37439148 0.13040695 0.1060362  0.10643597 0.07310232 0.06588576
  0.01578983 0.02795148 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -584.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.3 0.7]
A:
[[0.81 0.19]
 [0.15 0.85]]
chi:
[[0.03321972 0.01697122 0.01858426 0.02825873 0.07492922 0.08449148
  0.15657988 0.48696547 0.1       ]
 [0.37588038 0.13137372 0.10866386 0.11177302 0.07505568 0.06753271
  0.0108182  0.01890242 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -577.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.23 0.77]
A:
[[0.81 0.19]
 [0.14 0.86]]
chi:
[[0.02502693 0.01379802 0.01459141 0.02162471 0.07242794 0.0829058
  0.16423573 0.50538946 0.1       ]
 [0.3748397  0.1313544  0.10976833 0.11499407 0.07692724 0.06907619
  0.00813572 0.01490435 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -575.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.14 0.86]
A:
[[0.8  0.2 ]
 [0.14 0.86]]
chi:
[[0.0199993  0.01164711 0.012144   0.0173241  0.07023987 0.08156994
  0.16938283 0.51769283 0.1       ]
 [0.37368568 0.1313012  0.11023729 0.11683195 0.07845249 0.07023486
  0.00654474 0.01271179 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -573.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.08 0.92]
A:
[[0.8  0.2 ]
 [0.15 0.85]]
chi:
[[0.01657644 0.00999563 0.01058542 0.01454893 0.06853618 0.08056843
  0.17293099 0.52625798 0.1       ]
 [0.37292376 0.13139369 0.11045838 0.11790374 0.07958754 0.07104794
  0.00549577 0.01118918 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -573.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.03 0.97]
A:
[[0.79 0.21]
 [0.15 0.85]]
chi:
[[0.01407725 0.00870796 0.00954514 0.01270273 0.06730225 0.07983927
  0.17542889 0.53239651 0.1       ]
 [0.37253823 0.13156752 0.11058805 0.11857628 0.08038449 0.07161498
  0.00475105 0.00997939 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -573.0
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.79 0.21]
 [0.15 0.85]]
chi:
[[0.01217113 0.00773655 0.00881912 0.01142343 0.06645174 0.07930486
  0.17721618 0.53687699 0.1       ]
 [0.3724272  0.13174981 0.11068748 0.11903968 0.0809214  0.07201801
  0.00419454 0.00896187 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -572.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.78 0.22]
 [0.15 0.85]]
chi:
[[0.01067416 0.00702081 0.00829271 0.01050145 0.06589066 0.07890627
  0.17851704 0.54019691 0.1       ]
 [0.37249564 0.1319113  0.11077779 0.11938688 0.0812689  0.07231177
  0.00376122 0.0080865  0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 10: logL = -572.6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.47e-04 9.99e-01]
A:
[[0.78 0.22]
 [0.15 0.85]]
chi:
[[0.00947274 0.00649377 0.00789912 0.00981404 0.06554027 0.07860421
  0.1794824  0.54269345 0.1       ]
 [0.37267332 0.13204961 0.11086464 0.11966362 0.08148155 0.07253049
  0.00341154 0.00732523 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 11: logL = -572.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.34e-04 1.00e+00]
A:
[[0.78 0.22]
 [0.15 0.85]]
chi:
[[0.00849155 0.00609998 0.00759767 0.00928679 0.06534012 0.0783727
  0.18021349 0.54459771 0.1       ]
 [0.37291344 0.13216991 0.11094862 0.11989371 0.0815994  0.07269585
  0.00312064 0.00665843 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 12: logL = -572.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #14
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.36e-05 1.00e+00]
A:
[[0.77 0.23]
 [0.16 0.84]]
chi:
[[0.00767824 0.00579987 0.00736245 0.00887265 0.06524529 0.07819377
  0.18077826 0.54606948 0.1       ]
 [0.37318613 0.13227704 0.11102907 0.12009054 0.08165149 0.07282225
  0.00287252 0.00607096 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 13: logL = -572.4
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.724e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 1.230e+03
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.46 0.54]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12750899 0.04225714 0.0467478  0.0536813  0.06149688 0.06944858
  0.07504308 0.09074632 0.33306991 0.1       ]
 [0.32177954 0.08956959 0.0791336  0.0722507  0.07047026 0.05659848
  0.05104481 0.04143427 0.11771876 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -686.0
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.42 0.58]
A:
[[0.75 0.25]
 [0.24 0.76]]
chi:
[[0.09937736 0.03346053 0.03877879 0.04806982 0.0556276  0.07090862
  0.0777151  0.10178567 0.37427651 0.1       ]
 [0.34651874 0.09747646 0.08642994 0.07744244 0.07603355 0.05534975
  0.04876562 0.0313834  0.08060012 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -625.6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.37 0.63]
A:
[[0.78 0.22]
 [0.2  0.8 ]]
chi:
[[0.06957384 0.02460295 0.02897303 0.04132047 0.04834752 0.07244773
  0.08152096 0.11477518 0.41843831 0.1       ]
 [0.36715204 0.10386155 0.09412091 0.082828   0.08214487 0.05435915
  0.04606082 0.02139045 0.04808222 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -617.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.33 0.67]
A:
[[0.81 0.19]
 [0.16 0.84]]
chi:
[[0.04559396 0.017999   0.01931371 0.03503313 0.04058986 0.07314653
  0.08512419 0.12680614 0.45639347 0.1       ]
 [0.37729448 0.10674716 0.10008448 0.08674056 0.0875702  0.0543868
  0.04421918 0.01438279 0.02857435 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -607.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.27 0.73]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[0.03084562 0.01417617 0.01192497 0.0307528  0.03396542 0.07245619
  0.08719268 0.1355844  0.48310176 0.1       ]
 [0.37919862 0.10715881 0.10356411 0.08861093 0.09144207 0.05548984
  0.04378602 0.01073564 0.02001397 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -601.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.21 0.79]
A:
[[0.81 0.19]
 [0.14 0.86]]
chi:
[[0.02246675 0.01197178 0.00706275 0.02833596 0.02905165 0.07090978
  0.08800465 0.14143663 0.50076003 0.1       ]
 [0.37814053 0.1068521  0.10529557 0.08921036 0.09393758 0.05701921
  0.04409335 0.00896045 0.01649084 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -598.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.14 0.86]
A:
[[0.81 0.19]
 [0.14 0.86]]
chi:
[[0.01737178 0.01043512 0.00406496 0.02699268 0.02557688 0.0692104
  0.0882236  0.14540371 0.51272088 0.1       ]
 [0.37670336 0.10659843 0.10606083 0.08930872 0.09553511 0.05846238
  0.0445704  0.00798376 0.01477701 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -597.6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.08 0.92]
A:
[[0.8  0.2 ]
 [0.14 0.86]]
chi:
[[0.01400541 0.00919362 0.00228995 0.02619985 0.02315389 0.06773922
  0.08820686 0.14816275 0.52104845 0.1       ]
 [0.3755729  0.10653896 0.10632475 0.08926184 0.09657644 0.05961793
  0.04501153 0.00736588 0.01372979 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -597.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.04 0.96]
A:
[[0.8  0.2 ]
 [0.14 0.86]]
chi:
[[0.01164015 0.00816607 0.00127056 0.02569941 0.02146667 0.06660523
  0.08810457 0.15010037 0.52694699 0.1       ]
 [0.37481922 0.10661042 0.10634581 0.08919211 0.09727087 0.06046845
  0.04537182 0.00694554 0.01297576 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -596.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.02 0.98]
A:
[[0.79 0.21]
 [0.14 0.86]]
chi:
[[0.00990162 0.00734489 0.00069773 0.02536541 0.02028666 0.06578415
  0.08797948 0.15146146 0.5311786  0.1       ]
 [0.37436933 0.10673148 0.10626415 0.08913434 0.09774441 0.06106662
  0.04565367 0.00665357 0.01238244 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -596.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.79 0.21]
 [0.14 0.86]]
chi:
[[8.57851218e-03 6.71186183e-03 3.80547552e-04 2.51327015e-02
  1.94565900e-02 6.52100042e-02 8.78592394e-02 1.52416855e-01
  5.34253688e-01 1.00000000e-01]
 [3.74134879e-01 1.06855136e-01 1.06150727e-01 8.90941510e-02
  9.80728125e-02 6.14770980e-02 4.58696324e-02 6.45061176e-03
  1.18949534e-02 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 10: logL = -596.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.79 0.21]
 [0.15 0.85]]
chi:
[[7.54321875e-03 6.23166684e-03 2.06632043e-04 2.49654588e-02
  1.88698749e-02 6.48167838e-02 8.77558884e-02 1.53089189e-01
  5.36521288e-01 1.00000000e-01]
 [3.74043222e-01 1.06964760e-01 1.06038096e-01 8.90685849e-02
  9.83026289e-02 6.17547902e-02 4.60325026e-02 6.30973319e-03
  1.14856817e-02 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 11: logL = -596.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.69e-04 9.99e-01]
A:
[[0.79 0.21]
 [0.15 0.85]]
chi:
[[6.71457945e-03 5.86630809e-03 1.11880913e-04 2.48427238e-02
  1.84539472e-02 6.45515642e-02 8.76732655e-02 1.53565270e-01
  5.38220460e-01 1.00000000e-01]
 [3.74042019e-01 1.07058385e-01 1.05939067e-01 8.90532173e-02
  9.84637335e-02 6.19406152e-02 4.61534634e-02 6.21174345e-03
  1.11377560e-02 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 12: logL = -596.2
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -5.962e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 1.289e+03
2023-02-22 14:13 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:13 - INFO - cli : 125 - Training phase done in 00:00:01
2023-02-22 14:13 - INFO - cli : 155 - Process done in 00:00:01
2023-02-22 14:13 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_86
