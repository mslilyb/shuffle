2023-02-22 14:13 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/84.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/84.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:13 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/84.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/84.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_84
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:13 - INFO - cli : 50 - Loading input data
2023-02-22 14:13 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 104 - Spawning training set
2023-02-22 14:13 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:13 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:13 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.41 0.59]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12321386 0.05149045 0.05912118 0.06129518 0.0801346  0.08828434
  0.10179383 0.33466655 0.1       ]
 [0.32626999 0.09839033 0.09678309 0.08265054 0.06989143 0.06178303
  0.04834203 0.11588955 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -650.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.29 0.71]
A:
[[0.75 0.25]
 [0.24 0.76]]
chi:
[[0.09021955 0.04303459 0.04896997 0.05164566 0.08252799 0.09188571
  0.11407178 0.37764475 0.1       ]
 [0.35654967 0.10619917 0.10633416 0.09186644 0.06765246 0.05851905
  0.03686479 0.07601425 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -601.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.18 0.82]
A:
[[0.79 0.21]
 [0.2  0.8 ]]
chi:
[[0.05720992 0.03266084 0.03848511 0.04077026 0.08579457 0.09627059
  0.12851362 0.42029508 0.1       ]
 [0.3826907  0.11479074 0.11513647 0.10135001 0.06485516 0.0550097
  0.02470739 0.04145984 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -591.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.08 0.92]
A:
[[0.82 0.18]
 [0.16 0.84]]
chi:
[[0.03357773 0.02300952 0.0318747  0.03190147 0.08891887 0.09981789
  0.14124373 0.44965609 0.1       ]
 [0.39817662 0.12203494 0.11972881 0.10827649 0.06240782 0.05254766
  0.01507037 0.02175728 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -579.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.02 0.98]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.02043529 0.01577137 0.03011735 0.02669257 0.09102691 0.10167468
  0.14988622 0.46439561 0.1       ]
 [0.40579445 0.12734631 0.12031872 0.11204274 0.06083541 0.0514249
  0.0088155  0.01342198 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -572.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.01288306 0.0105956  0.03056916 0.02399702 0.09219217 0.10251937
  0.15531296 0.47193066 0.1       ]
 [0.40988576 0.13113628 0.11934176 0.11384045 0.06001493 0.05101352
  0.00499747 0.00976984 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -570.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.41e-04 1.00e+00]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.00806106 0.00693726 0.03129099 0.02252808 0.09266772 0.1029195
  0.15875295 0.47684244 0.1       ]
 [0.41212972 0.13371035 0.1182908  0.11467407 0.05975997 0.05091687
  0.0027554  0.00776281 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -569.0
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.67e-05 1.00e+00]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[0.00492555 0.00443512 0.03174649 0.02163579 0.09264762 0.10307829
  0.16095451 0.48057663 0.1       ]
 [0.41320328 0.13534568 0.11755508 0.11507046 0.05990811 0.05098801
  0.00149342 0.00643596 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -568.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.49e-07 1.00e+00]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[0.00294021 0.00278426 0.03195649 0.02103995 0.0923113  0.10308162
  0.1623721  0.48351407 0.1       ]
 [0.41357401 0.13632588 0.11710033 0.11527546 0.06029918 0.05115298
  0.00080328 0.00546887 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -567.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.74e-09 1.00e+00]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[1.72244893e-03 1.72539666e-03 3.20301968e-02 2.06152737e-02
  9.18150110e-02 1.02988838e-01 1.63292223e-01 4.85810612e-01
  1.00000000e-01]
 [4.13572854e-01 1.36885313e-01 1.16824579e-01 1.15397845e-01
  6.07985964e-02 5.13615510e-02 4.31300811e-04 4.72796068e-03
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -567.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.78e-11 1.00e+00]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[9.94854674e-04 1.05964647e-03 3.20446696e-02 2.03001112e-02
  9.12720819e-02 1.02845564e-01 1.63895335e-01 4.87587737e-01
  1.00000000e-01]
 [4.13406365e-01 1.37189791e-01 1.16652133e-01 1.15483770e-01
  6.13138688e-02 5.15796388e-02 2.31864978e-04 4.14256836e-03
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 10: logL = -567.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.88e-13 1.00e+00]
A:
[[0.82 0.18]
 [0.15 0.85]]
chi:
[[5.68664553e-04 6.46746687e-04 3.20394353e-02 2.00607670e-02
  9.07512280e-02 1.02683914e-01 1.64294507e-01 4.88954738e-01
  1.00000000e-01]
 [4.13189671e-01 1.37346527e-01 1.16538752e-01 1.15551972e-01
  6.17923148e-02 5.17865452e-02 1.24965902e-04 3.66925195e-03
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 11: logL = -567.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.43e-16 1.00e+00]
A:
[[0.82 0.18]
 [0.16 0.84]]
chi:
[[3.22620736e-04 3.93045743e-04 3.20312722e-02 1.98768711e-02
  9.02867721e-02 1.02523952e-01 1.64560655e-01 4.90004811e-01
  1.00000000e-01]
 [4.12980173e-01 1.37421185e-01 1.16460523e-01 1.15609708e-01
  6.22100606e-02 5.19716147e-02 6.75457928e-05 3.27919119e-03
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 12: logL = -567.0
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #14
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.47e-18 1.00e+00]
A:
[[0.82 0.18]
 [0.16 0.84]]
chi:
[[1.82055067e-04 2.38155415e-04 3.20258826e-02 1.97349638e-02
  8.98908874e-02 1.02376587e-01 1.64738600e-01 4.90812869e-01
  1.00000000e-01]
 [4.12802298e-01 1.37452516e-01 1.16404607e-01 1.15659744e-01
  6.25608556e-02 5.21308916e-02 3.66100601e-05 2.95247716e-03
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 13: logL = -567.0
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.670e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 1.219e+03
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.41 0.59]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12284848 0.04606389 0.04422053 0.05205428 0.0602364  0.07105087
  0.07753624 0.09095782 0.3350315  0.1       ]
 [0.32653562 0.09179782 0.07568434 0.07986164 0.06574694 0.05499767
  0.04855141 0.04119265 0.11563191 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -685.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.3 0.7]
A:
[[0.75 0.25]
 [0.24 0.76]]
chi:
[[0.08937776 0.0373442  0.03660623 0.04081603 0.05659614 0.07499415
  0.08340183 0.10247202 0.37839164 0.1       ]
 [0.35731727 0.09988438 0.08282369 0.09057027 0.06924781 0.05129814
  0.04309534 0.03041676 0.07534635 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -623.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.19 0.81]
A:
[[0.8  0.2 ]
 [0.19 0.81]]
chi:
[[0.05625934 0.02666693 0.02910175 0.028347   0.05214495 0.07985265
  0.09116008 0.1155833  0.42088399 0.1       ]
 [0.3838826  0.10885992 0.08909313 0.10145326 0.07322088 0.0471319
  0.03648507 0.01931342 0.04055982 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -612.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.09 0.91]
A:
[[0.82 0.18]
 [0.16 0.84]]
chi:
[[0.03315943 0.01703475 0.02520791 0.01844856 0.04765355 0.08420805
  0.09875901 0.12639317 0.44913556 0.1       ]
 [0.39972179 0.11632816 0.09168744 0.10930821 0.07697702 0.04368443
  0.03043192 0.01099598 0.02086504 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -600.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.03 0.97]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.02050542 0.01015538 0.02530121 0.01267724 0.04430778 0.08729303
  0.10419734 0.13306152 0.46250109 0.1       ]
 [0.40803138 0.12166845 0.0910569  0.11372615 0.07973033 0.0412567
  0.02612662 0.00597708 0.01242639 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -593.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.01314663 0.00561671 0.02681331 0.00966899 0.04220158 0.08945149
  0.10768256 0.13676389 0.46865484 0.1       ]
 [0.41315493 0.12529308 0.08947434 0.11602969 0.08147186 0.03950744
  0.02331574 0.00315193 0.00860098 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -590.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.00840611 0.00285445 0.02806922 0.0080244  0.04081448 0.09097927
  0.1099564  0.1387939  0.47210176 0.1       ]
 [0.41654577 0.12749611 0.08823813 0.11727098 0.08261987 0.03825641
  0.0214739  0.00162439 0.00647446 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -588.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.08e-05 1.00e+00]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.00531504 0.00134993 0.02876607 0.00703555 0.03982178 0.09202654
  0.11146015 0.13989497 0.47432997 0.1       ]
 [0.41875801 0.1286661  0.08754774 0.11800554 0.08344275 0.03739913
  0.02025906 0.00082602 0.00509564 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -587.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.77e-06 1.00e+00]
A:
[[0.82 0.18]
 [0.16 0.84]]
chi:
[[3.33575469e-03 6.06197464e-04 2.90800161e-02 6.39094361e-03
  3.90956936e-02 9.27189654e-02 1.12447716e-01 1.40479692e-01
  4.75845021e-01 1.00000000e-01]
 [4.20185532e-01 1.29223879e-01 8.72264636e-02 1.18488507e-01
  8.40488379e-02 3.68310882e-02 1.94590187e-02 4.17215940e-04
  4.11945667e-03 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -587.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.3e-08 1.0e+00]
A:
[[0.82 0.18]
 [0.16 0.84]]
chi:
[[2.08648986e-03 2.63057731e-04 2.92006882e-02 5.94544142e-03
  3.85753005e-02 9.31658919e-02 1.13087905e-01 1.40780858e-01
  4.76894367e-01 1.00000000e-01]
 [4.21112524e-01 1.29472671e-01 8.70962975e-02 1.18834174e-01
  8.44881075e-02 3.64609661e-02 1.89341851e-02 2.10075896e-04
  3.39099952e-03 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -587.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.9e-10 1.0e+00]
A:
[[0.82 0.18]
 [0.16 0.84]]
chi:
[[1.30363640e-03 1.11717573e-04 2.92401095e-02 5.62418575e-03
  3.82147433e-02 9.34506002e-02 1.13496889e-01 1.40927930e-01
  4.77630189e-01 1.00000000e-01]
 [4.21726747e-01 1.29582870e-01 8.70513703e-02 1.19096695e-01
  8.47970594e-02 3.62206308e-02 1.85911931e-02 1.05643841e-04
  2.82779133e-03 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 10: logL = -587.0
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.29e-13 1.00e+00]
A:
[[0.82 0.18]
 [0.16 0.84]]
chi:
[[8.14463311e-04 4.68248111e-05 2.92515563e-02 5.38508447e-03
  3.79740982e-02 9.36308122e-02 1.13753595e-01 1.40991714e-01
  4.78151851e-01 1.00000000e-01]
 [4.22146306e-01 1.29636667e-01 8.70398447e-02 1.19304093e-01
  8.50075040e-02 3.60635991e-02 1.83678442e-02 5.31076196e-05
  2.38103402e-03 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 11: logL = -586.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.93e-16 1.00e+00]
A:
[[0.82 0.18]
 [0.16 0.84]]
chi:
[[5.09051980e-04 1.94730275e-05 2.92568417e-02 5.20282637e-03
  3.78200106e-02 9.37445421e-02 1.13910910e-01 1.41010776e-01
  4.78525569e-01 1.00000000e-01]
 [4.22443751e-01 1.29669591e-01 8.70391504e-02 1.19472187e-01
  8.51462451e-02 3.59596326e-02 1.82229561e-02 2.66989642e-05
  2.01978788e-03 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 12: logL = -586.8
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -5.868e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 1.271e+03
2023-02-22 14:13 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:13 - INFO - cli : 125 - Training phase done in 00:00:00
2023-02-22 14:13 - INFO - cli : 155 - Process done in 00:00:00
2023-02-22 14:13 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_84
