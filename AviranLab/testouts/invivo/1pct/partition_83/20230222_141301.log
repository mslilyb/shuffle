2023-02-22 14:13 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/83.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/83.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:13 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/83.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/83.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_83
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:13 - INFO - cli : 50 - Loading input data
2023-02-22 14:13 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 104 - Spawning training set
2023-02-22 14:13 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:13 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:13 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.63 0.37]
A:
[[0.71 0.29]
 [0.28 0.72]]
chi:
[[0.13224956 0.05210781 0.06252577 0.07375823 0.07592875 0.08582277
  0.0947545  0.32285262 0.1       ]
 [0.32900804 0.08576519 0.08738045 0.07623244 0.07407824 0.07023604
  0.05539401 0.12190559 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -652.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.75 0.25]
A:
[[0.73 0.27]
 [0.26 0.74]]
chi:
[[0.10544683 0.0514852  0.06018277 0.07727356 0.07275301 0.08197605
  0.09774011 0.35314247 0.1       ]
 [0.35455425 0.08623595 0.08958133 0.07276264 0.07721122 0.07408725
  0.05262193 0.09294544 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -605.0
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.85 0.15]
A:
[[0.76 0.24]
 [0.23 0.77]]
chi:
[[0.07662902 0.05102103 0.05750006 0.0825896  0.06944047 0.07725631
  0.10161658 0.38394693 0.1       ]
 [0.38080247 0.08644689 0.09198204 0.06763501 0.080395   0.07872168
  0.04917112 0.06484579 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -600.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.93 0.07]
A:
[[0.79 0.21]
 [0.2  0.8 ]]
chi:
[[0.05116437 0.0510394  0.05498419 0.0897488  0.06668351 0.07163135
  0.10526316 0.40948522 0.1       ]
 [0.40307687 0.08618571 0.09415225 0.06088752 0.08295769 0.08409388
  0.04604251 0.04260356 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -595.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.97 0.03]
A:
[[0.81 0.19]
 [0.17 0.83]]
chi:
[[0.03334904 0.05169611 0.05331672 0.09757769 0.06527573 0.06600482
  0.10728458 0.4254953  0.1       ]
 [0.41900344 0.08545927 0.0956249  0.05352434 0.08424962 0.08940968
  0.04429126 0.02843748 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -590.0
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.83 0.17]
 [0.16 0.84]]
chi:
[[0.022911   0.05273114 0.05268341 0.10426822 0.06539337 0.06153553
  0.10743678 0.43304055 0.1       ]
 [0.42953754 0.08452211 0.09629224 0.04707522 0.08416568 0.09370873
  0.0440521  0.02064639 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -586.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.01708791 0.05369854 0.0527003  0.10896427 0.06646626 0.05855416
  0.10663402 0.43589456 0.1       ]
 [0.43652902 0.0837018  0.09642579 0.04236677 0.08319931 0.09668377
  0.0446057  0.01648783 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -585.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.01365134 0.05435996 0.05296878 0.11192432 0.06780766 0.05672241
  0.1057292  0.43683632 0.1       ]
 [0.4413159  0.08316633 0.09631835 0.03927044 0.08195962 0.09858911
  0.0452651  0.01411515 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -584.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.99e-01 6.87e-04]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.01142021 0.05470352 0.05328701 0.11371968 0.06902235 0.0556104
  0.10505673 0.43718009 0.1       ]
 [0.44467974 0.08291233 0.09612957 0.0373207  0.08081704 0.099788
  0.04575089 0.01260173 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -584.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 2.6e-04]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.00983696 0.05480582 0.05358226 0.11480834 0.06998004 0.05491773
  0.10464026 0.43742858 0.1       ]
 [0.44707617 0.0828677  0.09592512 0.03610727 0.0799045  0.10055136
  0.04604149 0.0115264  0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -584.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 9.96e-05]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.00863526 0.0547493  0.05383589 0.11548077 0.07068263 0.05446836
  0.10441201 0.43773578 0.1       ]
 [0.44879434 0.0829578  0.09572911 0.03535126 0.07922863 0.10104798
  0.04619252 0.01069837 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 10: logL = -584.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.86e-05]
A:
[[0.84 0.16]
 [0.16 0.84]]
chi:
[[0.00767939 0.05459757 0.05404794 0.11590759 0.07117675 0.05416381
  0.10430329 0.43812367 0.1       ]
 [0.45003202 0.08312585 0.0955497  0.03487799 0.07874983 0.10137845
  0.04625945 0.01002671 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 11: logL = -584.3
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.843e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 1.254e+03
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.64 0.36]
A:
[[0.71 0.29]
 [0.28 0.72]]
chi:
[[0.1318957  0.04482296 0.04979905 0.05998626 0.06283631 0.06815692
  0.07134022 0.08811791 0.32304467 0.1       ]
 [0.32959802 0.07509951 0.07613351 0.06599835 0.06914752 0.05786942
  0.05470239 0.04997975 0.12147152 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -687.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.77 0.23]
A:
[[0.73 0.27]
 [0.26 0.74]]
chi:
[[0.10462518 0.04468235 0.04638604 0.06287547 0.0592225  0.06816668
  0.06966468 0.09098666 0.35339045 0.1       ]
 [0.35581024 0.07512801 0.07940827 0.06312299 0.0726936  0.05789728
  0.05641783 0.04728555 0.09223622 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -627.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.88 0.12]
A:
[[0.76 0.24]
 [0.23 0.77]]
chi:
[[0.07554933 0.04488354 0.04249707 0.06670727 0.05560922 0.06839994
  0.06824372 0.09448259 0.38362732 0.1       ]
 [0.38271681 0.07475337 0.08301046 0.05938178 0.0761412  0.05772976
  0.05788223 0.04412949 0.0642549  0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -623.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.95 0.05]
A:
[[0.79 0.21]
 [0.2  0.8 ]]
chi:
[[0.0502048  0.04568154 0.03875335 0.07134594 0.05283533 0.06880656
  0.06687474 0.09751714 0.40798061 0.1       ]
 [0.40540945 0.07381273 0.08639025 0.05494884 0.07869969 0.05739853
  0.05926212 0.0414901  0.04258829 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -617.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.81 0.19]
 [0.18 0.82]]
chi:
[[0.03249084 0.04704543 0.03593203 0.07599806 0.05159466 0.06929651
  0.06563906 0.09902264 0.42298076 0.1       ]
 [0.42144137 0.07242807 0.08896788 0.0505302  0.07981988 0.05695939
  0.06046819 0.04019754 0.02918748 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -613.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.82 0.18]
 [0.16 0.84]]
chi:
[[0.02183272 0.04858189 0.03430742 0.07969033 0.05174391 0.06985897
  0.06469311 0.09900862 0.43028302 0.1       ]
 [0.4317815  0.07096035 0.09054226 0.0469788  0.07968455 0.05641602
  0.06137477 0.04019446 0.02206731 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -610.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.83 0.17]
 [0.16 0.84]]
chi:
[[0.01559765 0.04987118 0.03358412 0.08210988 0.05260375 0.07048536
  0.06399331 0.09828441 0.43347034 0.1       ]
 [0.43837505 0.06975135 0.09131965 0.04460228 0.07889701 0.05579359
  0.06204371 0.04080692 0.01841043 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -609.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.49e-04]
A:
[[0.83 0.17]
 [0.16 0.84]]
chi:
[[0.01173818 0.05074087 0.03335243 0.0835403  0.05360534 0.07112378
  0.06342369 0.09751276 0.43496264 0.1       ]
 [0.44266989 0.06893853 0.09162102 0.04317091 0.0779655  0.0551575
  0.06259098 0.04147449 0.01641118 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -608.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.67e-05]
A:
[[0.83 0.17]
 [0.16 0.84]]
chi:
[[0.00915534 0.05122553 0.0333376  0.08436423 0.05448146 0.07172296
  0.06292267 0.09694246 0.43584775 0.1       ]
 [0.44554221 0.06848564 0.091686   0.04233902 0.07713938 0.05456417
  0.06307479 0.04197732 0.01519147 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -608.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.29e-05]
A:
[[0.83 0.17]
 [0.16 0.84]]
chi:
[[0.00730943 0.05143229 0.03339994 0.0848511  0.05516473 0.07225497
  0.06247492 0.09658735 0.43652527 0.1       ]
 [0.44751171 0.06829275 0.09165011 0.04185016 0.07648753 0.05404205
  0.06350823 0.042298   0.01435945 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -608.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.98e-06]
A:
[[0.83 0.17]
 [0.16 0.84]]
chi:
[[0.00592683 0.05146367 0.03347834 0.08515562 0.05567131 0.07271139
  0.06208036 0.09639129 0.43712119 0.1       ]
 [0.44889462 0.06826407 0.09158008 0.04155102 0.07599926 0.05359835
  0.06389031 0.04248234 0.01373995 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 10: logL = -608.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 6.94e-07]
A:
[[0.83 0.17]
 [0.16 0.84]]
chi:
[[0.00485767 0.05139524 0.03354962 0.08535998 0.05603951 0.07309476
  0.06173937 0.09629692 0.43766694 0.1       ]
 [0.4498887  0.06832876 0.09150575 0.04135723 0.07564101 0.05322903
  0.06422019 0.04257864 0.01325069 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 11: logL = -608.2
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -6.082e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 1.313e+03
2023-02-22 14:13 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:13 - INFO - cli : 125 - Training phase done in 00:00:01
2023-02-22 14:13 - INFO - cli : 155 - Process done in 00:00:01
2023-02-22 14:13 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_83
