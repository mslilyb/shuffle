2023-02-22 14:10 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/18.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/18.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:10 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/18.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/18.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_18
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:10 - INFO - cli : 50 - Loading input data
2023-02-22 14:10 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:10 - INFO - cli : 104 - Spawning training set
2023-02-22 14:10 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:10 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:10 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:10 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:10 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.25 0.75]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.116981   0.04749445 0.06177306 0.07242767 0.08104046 0.08771664
  0.0994529  0.33311381 0.1       ]
 [0.33336936 0.10259476 0.08826984 0.07758068 0.06893994 0.06224212
  0.05046778 0.11653552 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 0: logL = -650.1
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.06 0.94]
A:
[[0.76 0.24]
 [0.24 0.76]]
chi:
[[0.07728726 0.03502511 0.05903648 0.07430226 0.08461745 0.0904756
  0.10779184 0.37146399 0.1       ]
 [0.37432883 0.11541225 0.09113818 0.07570537 0.06527733 0.05935508
  0.04184939 0.07693358 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 1: logL = -600.3
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.81 0.19]
 [0.2  0.8 ]]
chi:
[[0.04259611 0.02250841 0.05717989 0.07704181 0.08886599 0.09338007
  0.11609172 0.402336   0.1       ]
 [0.4130819  0.12912559 0.09337483 0.07289463 0.06070238 0.05604778
  0.03262914 0.04214376 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 2: logL = -589.2
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.31e-04 1.00e+00]
A:
[[0.85 0.15]
 [0.16 0.84]]
chi:
[[0.02291325 0.01447187 0.0573921  0.08000639 0.0924463  0.09530373
  0.12155203 0.41591433 0.1       ]
 [0.44023968 0.13946764 0.09375392 0.06966777 0.0564182  0.05337479
  0.02541811 0.0216599  0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 3: logL = -577.6
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.29e-06 1.00e+00]
A:
[[0.87 0.13]
 [0.15 0.85]]
chi:
[[0.0148134  0.01111118 0.05882867 0.08233354 0.09478372 0.09596611
  0.1239328  0.4182306  0.1       ]
 [0.45622404 0.14528341 0.09278991 0.06693245 0.05323614 0.05193541
  0.02116955 0.01242909 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 4: logL = -571.5
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.77e-09 1.00e+00]
A:
[[0.87 0.13]
 [0.15 0.85]]
chi:
[[0.01143889 0.00994706 0.05999906 0.08384115 0.09633609 0.09612515
  0.1249282  0.4173844  0.1       ]
 [0.46569818 0.14831917 0.0919071  0.06503542 0.05095275 0.05119049
  0.01872745 0.00816943 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 5: logL = -569.8
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.58e-11 1.00e+00]
A:
[[0.87 0.13]
 [0.15 0.85]]
chi:
[[0.00960355 0.00952978 0.06052336 0.08478517 0.09748883 0.096327
  0.12556714 0.41617517 0.1       ]
 [0.47193496 0.15005642 0.09159632 0.06378208 0.04921834 0.05055028
  0.01702878 0.00583282 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 6: logL = -569.3
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.18e-14 1.00e+00]
A:
[[0.87 0.13]
 [0.15 0.85]]
chi:
[[0.00830305 0.00935118 0.06060003 0.08539895 0.09840857 0.09667992
  0.12614423 0.41511407 0.1       ]
 [0.47651482 0.15119697 0.09171369 0.0629302  0.04783024 0.04983665
  0.01563815 0.00433928 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 7: logL = -569.1
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.25e-16 1.00e+00]
A:
[[0.87 0.13]
 [0.16 0.84]]
chi:
[[0.00724502 0.0092586  0.06045265 0.08581569 0.09917035 0.09713699
  0.12670084 0.41421985 0.1       ]
 [0.48014162 0.15202863 0.092045   0.06232735 0.04667981 0.04906228
  0.01442257 0.00329275 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 8: logL = -569.0
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.46e-19 1.00e+00]
A:
[[0.86 0.14]
 [0.16 0.84]]
chi:
[[0.00633969 0.00920786 0.06021829 0.08610705 0.09981548 0.09763734
  0.12722497 0.41344931 0.1       ]
 [0.48314372 0.1526722  0.09245084 0.06188735 0.04570359 0.04827504
  0.01334479 0.00252247 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 9: logL = -568.9
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.17e-21 1.00e+00]
A:
[[0.86 0.14]
 [0.16 0.84]]
chi:
[[0.00555337 0.00918533 0.05996672 0.08631406 0.10037046 0.0981384
  0.12770307 0.4127686  0.1       ]
 [0.48569138 0.15318447 0.09285877 0.06155948 0.04486119 0.04751276
  0.01239145 0.00194051 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 10: logL = -568.8
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.21e-24 1.00e+00]
A:
[[0.86 0.14]
 [0.17 0.83]]
chi:
[[0.00486807 0.00918539 0.05972932 0.08646221 0.10085361 0.09861565
  0.12812886 0.41215688 0.1       ]
 [0.4878846  0.15359672 0.09323646 0.06131167 0.04412526 0.04679786
  0.01155277 0.00149465 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 11: logL = -568.7
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.68e-27 1.00e+00]
A:
[[0.86 0.14]
 [0.17 0.83]]
chi:
[[0.00427068 0.00920435 0.05951787 0.08656843 0.10127809 0.09905688
  0.12850215 0.41160154 0.1       ]
 [0.48978945 0.15392922 0.09357254 0.06112238 0.04347649 0.04614109
  0.0108182  0.00115063 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 12: logL = -568.7
2023-02-22 14:10 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.687e+02
2023-02-22 14:10 - INFO - TrainingManager : 71 -  >> BIC: 1.223e+03
2023-02-22 14:10 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.25 0.75]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11668131 0.04073178 0.04851518 0.05680334 0.07086468 0.07127704
  0.07481431 0.08760115 0.33271121 0.1       ]
 [0.3337858  0.09137719 0.07754728 0.06922338 0.06111435 0.05468727
  0.05113474 0.0443057  0.11682429 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 0: logL = -685.4
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.06 0.94]
A:
[[0.77 0.23]
 [0.24 0.76]]
chi:
[[0.07646681 0.02929825 0.04405906 0.05541191 0.07867733 0.07540051
  0.07637738 0.09375292 0.37055583 0.1       ]
 [0.37591719 0.10329083 0.08224494 0.07070988 0.0531192  0.05040046
  0.04940791 0.03780163 0.07710796 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 1: logL = -623.2
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.82 0.18]
 [0.19 0.81]]
chi:
[[0.04155129 0.01769264 0.04087757 0.05366497 0.08894532 0.07990818
  0.07736642 0.09949165 0.40050196 0.1       ]
 [0.41664728 0.11646628 0.08611111 0.07275222 0.04202923 0.04533617
  0.04799152 0.03101157 0.04165462 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 2: logL = -611.5
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.2e-04 1.0e+00]
A:
[[0.86 0.14]
 [0.16 0.84]]
chi:
[[0.02236154 0.01013908 0.0407144  0.05238693 0.09839272 0.08310946
  0.07699499 0.10274141 0.41315946 0.1       ]
 [0.44520459 0.12670333 0.08721747 0.07453308 0.03079925 0.04114731
  0.04779182 0.02607358 0.02052955 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 3: logL = -598.8
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.09e-06 1.00e+00]
A:
[[0.87 0.13]
 [0.14 0.86]]
chi:
[[0.0150307  0.00685323 0.04215695 0.05197075 0.10438703 0.08435113
  0.07584331 0.10358943 0.41581748 0.1       ]
 [0.46032178 0.13228838 0.08635972 0.07536096 0.02297798 0.03907086
  0.04860594 0.02387188 0.0111425  0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 4: logL = -591.9
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.45e-09 1.00e+00]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.01238332 0.00559827 0.04331857 0.0518848  0.1074498  0.08449254
  0.07483311 0.10352431 0.41651528 0.1       ]
 [0.46690289 0.13472158 0.08539239 0.07564622 0.01884083 0.03854703
  0.04953698 0.02330702 0.00710506 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 5: logL = -589.9
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.1e-11 1.0e+00]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.01118351 0.0050708  0.04392117 0.05180755 0.10896829 0.08428406
  0.07417086 0.10332792 0.41726582 0.1       ]
 [0.46956129 0.13569024 0.08482218 0.07580182 0.01685327 0.03865549
  0.05022287 0.02330467 0.00508816 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 6: logL = -589.4
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.25e-14 1.00e+00]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.01041926 0.00479868 0.04418683 0.05169804 0.10977295 0.08402965
  0.07376331 0.10319611 0.41813518 0.1       ]
 [0.47066506 0.13606699 0.08453846 0.07593917 0.01588607 0.03892398
  0.05067751 0.02341563 0.00388712 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 7: logL = -589.3
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.35e-16 1.00e+00]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.00980604 0.00462556 0.04428666 0.05157864 0.11023408 0.08381314
  0.07351157 0.10314307 0.41900124 0.1       ]
 [0.47116418 0.1362073  0.08440652 0.07606509 0.01539985 0.03919148
  0.05097563 0.02351138 0.00307856 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 8: logL = -589.2
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.21e-19 1.00e+00]
A:
[[0.87 0.13]
 [0.14 0.86]]
chi:
[[0.00926754 0.00449758 0.04430901 0.0514681  0.11051505 0.08364502
  0.07335386 0.10314679 0.41979705 0.1       ]
 [0.47142123 0.13625138 0.08434986 0.07617236 0.01515251 0.03941814
  0.05117326 0.02356894 0.00249232 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 9: logL = -589.2
2023-02-22 14:10 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -5.892e+02
2023-02-22 14:10 - INFO - TrainingManager : 71 -  >> BIC: 1.275e+03
2023-02-22 14:10 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:10 - INFO - cli : 125 - Training phase done in 00:00:00
2023-02-22 14:10 - INFO - cli : 155 - Process done in 00:00:00
2023-02-22 14:10 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_18
