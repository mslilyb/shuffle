2023-02-22 14:10 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/34.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/34.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:10 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/34.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/34.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_34
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:10 - INFO - cli : 50 - Loading input data
2023-02-22 14:10 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:10 - INFO - cli : 104 - Spawning training set
2023-02-22 14:10 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:10 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:10 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:10 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:10 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.71 0.29]
A:
[[0.71 0.29]
 [0.29 0.71]]
chi:
[[0.12972082 0.05038662 0.06277199 0.07162701 0.07753859 0.09142071
  0.09857912 0.31795515 0.1       ]
 [0.32015163 0.09958043 0.08721164 0.07836847 0.07246481 0.05860127
  0.05145245 0.13216929 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 0: logL = -652.1
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.89 0.11]
A:
[[0.73 0.27]
 [0.27 0.73]]
chi:
[[0.10606161 0.04251163 0.06134989 0.07191506 0.0761225  0.09811226
  0.10599775 0.33792929 0.1       ]
 [0.34399572 0.10750404 0.08865669 0.07808643 0.07387696 0.0518766
  0.0439873  0.11201627 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 1: logL = -606.5
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.97 0.03]
A:
[[0.76 0.24]
 [0.24 0.76]]
chi:
[[0.08163354 0.03429561 0.06045065 0.07245008 0.07437087 0.105454
  0.11395033 0.35739493 0.1       ]
 [0.36928617 0.11596552 0.08964268 0.07756628 0.07563317 0.04435064
  0.0357998  0.09175574 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 2: logL = -602.9
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.78 0.22]
 [0.22 0.78]]
chi:
[[0.06030217 0.02707161 0.06069996 0.07332162 0.0724951  0.1123942
  0.12097103 0.3727443  0.1       ]
 [0.39287965 0.12385433 0.0895763  0.0767108  0.0775533  0.03688337
  0.02814085 0.07440141 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 3: logL = -598.8
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.79e-04]
A:
[[0.8  0.2 ]
 [0.21 0.79]]
chi:
[[0.04456831 0.02184028 0.0623823  0.07443691 0.07086343 0.11775057
  0.1261326  0.38202561 0.1       ]
 [0.41225976 0.13017144 0.08809519 0.0755844  0.07929311 0.03063162
  0.0219324  0.06203208 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 4: logL = -595.2
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.47e-05]
A:
[[0.81 0.19]
 [0.2  0.8 ]]
chi:
[[0.03416884 0.01861614 0.06497552 0.07558631 0.06973695 0.12119739
  0.12949148 0.38622737 0.1       ]
 [0.42673949 0.13460688 0.0855975  0.07438018 0.0805639  0.02616187
  0.01739367 0.05455651 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 5: logL = -593.0
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.55e-07]
A:
[[0.82 0.18]
 [0.2  0.8 ]]
chi:
[[0.02744567 0.01680573 0.06763182 0.07663199 0.06911887 0.12322345
  0.13164681 0.38749566 0.1       ]
 [0.43712192 0.13748549 0.08291151 0.07324767 0.0813148  0.02322057
  0.01417608 0.05052196 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 6: logL = -591.9
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.63e-08]
A:
[[0.82 0.18]
 [0.2  0.8 ]]
chi:
[[0.0229034  0.01581118 0.06985918 0.07754427 0.06887665 0.12443356
  0.13312862 0.38744314 0.1       ]
 [0.44463404 0.13932508 0.08058693 0.07223494 0.08165472 0.02127672
  0.01182712 0.04846045 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 7: logL = -591.3
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.92e-10]
A:
[[0.82 0.18]
 [0.2  0.8 ]]
chi:
[[0.01962006 0.01524424 0.07156443 0.07833561 0.06887425 0.12521788
  0.13423574 0.38690779 0.1       ]
 [0.45027651 0.14054471 0.0787684  0.07134124 0.08171919 0.01991717
  0.01002569 0.04740709 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 8: logL = -591.1
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 8.02e-12]
A:
[[0.82 0.18]
 [0.2  0.8 ]]
chi:
[[0.01709854 0.01489489 0.07282739 0.07902267 0.06901379 0.12577516
  0.13511316 0.38625439 0.1       ]
 [0.45469896 0.14140685 0.0774004  0.07055557 0.08161384 0.0189013
  0.00858425 0.04683884 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 9: logL = -590.9
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.42e-13]
A:
[[0.81 0.19]
 [0.2  0.8 ]]
chi:
[[0.01507502 0.01465822 0.07375818 0.07961887 0.06923214 0.12620002
  0.13583279 0.38562476 0.1       ]
 [0.45828919 0.14205769 0.07638004 0.06986706 0.08140981 0.01810152
  0.00739665 0.04649803 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 10: logL = -590.8
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.18e-15]
A:
[[0.81 0.19]
 [0.21 0.79]]
chi:
[[0.01340247 0.01448324 0.07444967 0.08013516 0.06948977 0.12653887
  0.13643457 0.38506625 0.1       ]
 [0.46127793 0.14257533 0.07561452 0.06926589 0.08115294 0.01744972
  0.0063998  0.04626388 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 11: logL = -590.7
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.93e-17]
A:
[[0.81 0.19]
 [0.21 0.79]]
chi:
[[0.0119922  0.01434497 0.07497039 0.08058121 0.06976196 0.12681672
  0.13694397 0.38458858 0.1       ]
 [0.46380824 0.14300183 0.0750332  0.06874277 0.08087249 0.01690701
  0.00555311 0.04608135 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 12: logL = -590.6
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #14
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.46e-19]
A:
[[0.81 0.19]
 [0.21 0.79]]
chi:
[[0.01078622 0.01423072 0.07536862 0.08096587 0.07003334 0.12704875
  0.13737893 0.38418754 0.1       ]
 [0.46597449 0.1433609  0.07458533 0.06828884 0.08058712 0.01644905
  0.00482836 0.04592591 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 13: logL = -590.5
2023-02-22 14:10 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.905e+02
2023-02-22 14:10 - INFO - TrainingManager : 71 -  >> BIC: 1.267e+03
2023-02-22 14:10 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.71 0.29]
A:
[[0.71 0.29]
 [0.29 0.71]]
chi:
[[0.12954918 0.04342047 0.04945949 0.05836454 0.06616813 0.06647726
  0.08141361 0.08698813 0.31815919 0.1       ]
 [0.32030745 0.08854562 0.07652017 0.0676285  0.06583212 0.05952797
  0.04461405 0.04504339 0.13198073 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 0: logL = -687.3
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.89 0.11]
A:
[[0.73 0.27]
 [0.27 0.73]]
chi:
[[0.10525922 0.03622805 0.04615184 0.05929926 0.066494   0.06385673
  0.0908631  0.09314179 0.338706   0.1       ]
 [0.3446599  0.09575184 0.07983678 0.06669824 0.06550634 0.06214384
  0.03515572 0.03887655 0.1113708  0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 1: logL = -629.2
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.76 0.24]
 [0.24 0.76]]
chi:
[[0.07995486 0.02874442 0.04301294 0.06085056 0.06713545 0.06037381
  0.10096421 0.09993579 0.35902795 0.1       ]
 [0.37037064 0.10333919 0.08303191 0.06515426 0.064862   0.06563208
  0.02495059 0.03198806 0.09067127 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 2: logL = -625.1
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.78 0.22]
 [0.22 0.78]]
chi:
[[0.05803644 0.02236346 0.04081713 0.06317717 0.0682291  0.0564345
  0.1097316  0.10605699 0.3751536  0.1       ]
 [0.39347385 0.11003127 0.08538353 0.06282123 0.06375073 0.06962488
  0.01584568 0.02558067 0.07348816 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 3: logL = -620.2
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.66e-04]
A:
[[0.8 0.2]
 [0.2 0.8]]
chi:
[[0.04231109 0.01802365 0.04018019 0.06602006 0.06974066 0.05286945
  0.11554898 0.11059036 0.38471556 0.1       ]
 [0.41123888 0.11490862 0.08626324 0.05992125 0.06218665 0.0733274
  0.0094299  0.02054317 0.06218089 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 4: logL = -616.0
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.44e-05]
A:
[[0.81 0.19]
 [0.19 0.81]]
chi:
[[0.032265   0.01554309 0.04101567 0.06885488 0.07140533 0.05029099
  0.11860547 0.11348717 0.38853241 0.1       ]
 [0.42385217 0.11805835 0.08568209 0.0569593  0.06042311 0.07611237
  0.00562968 0.01700565 0.05627728 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 5: logL = -613.5
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.79e-07]
A:
[[0.82 0.18]
 [0.19 0.81]]
chi:
[[0.02591435 0.01421031 0.0427534  0.07134382 0.072927   0.04871674
  0.12001415 0.11524827 0.38887196 0.1       ]
 [0.43294675 0.1200948  0.08414776 0.05428481 0.05876469 0.07791899
  0.0034482  0.01455973 0.05383427 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 6: logL = -612.4
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.92e-08]
A:
[[0.82 0.18]
 [0.19 0.81]]
chi:
[[0.02166138 0.01345385 0.0448496  0.07342694 0.07415882 0.04786819
  0.1206107  0.11636496 0.38760558 0.1       ]
 [0.43986974 0.12152599 0.08217969 0.05198176 0.05737851 0.07898992
  0.00212225 0.0127789  0.05317323 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 7: logL = -611.9
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.55e-10]
A:
[[0.82 0.18]
 [0.19 0.81]]
chi:
[[0.01860613 0.01296795 0.04696578 0.07516624 0.07509119 0.04747548
  0.12080423 0.1171364  0.3857866  0.1       ]
 [0.44537678 0.1226249  0.08012052 0.05000951 0.0562929  0.07957629
  0.00127961 0.01139917 0.05332032 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 8: logL = -611.5
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.44e-11]
A:
[[0.82 0.18]
 [0.19 0.81]]
chi:
[[0.01628844 0.01261562 0.04892601 0.07663785 0.07577611 0.04735547
  0.12078299 0.11771747 0.38390004 0.1       ]
 [0.4498642  0.12351591 0.07816321 0.04830668 0.0554673  0.0798553
  0.00074506 0.01028001 0.05380234 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 9: logL = -611.3
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.38e-13]
A:
[[0.82 0.18]
 [0.19 0.81]]
chi:
[[1.44652032e-02 1.23394002e-02 5.06531317e-02 7.78997263e-02
  7.62762015e-02 4.73948155e-02 1.20647131e-01 1.18186013e-01
  3.82138377e-01 1.00000000e-01]
 [4.53560885e-01 1.24255045e-01 7.64040130e-02 4.68245521e-02
  5.48439454e-02 7.99413077e-02 4.17094206e-04 9.34579564e-03
  5.44073617e-02 1.00000000e-01]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 10: logL = -611.2
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 7.31e-15]
A:
[[0.82 0.18]
 [0.2  0.8 ]]
chi:
[[1.29955984e-02 1.21144608e-02 5.21278962e-02 7.89908498e-02
  7.66441878e-02 4.75237127e-02 1.20458476e-01 1.18582166e-01
  3.80562652e-01 1.00000000e-01]
 [4.56621415e-01 1.24871631e-01 7.48781121e-02 4.55294983e-02
  5.43708931e-02 7.99083261e-02 2.24824383e-04 8.55234493e-03
  5.50429557e-02 1.00000000e-01]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 11: logL = -611.1
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.46e-16]
A:
[[0.82 0.18]
 [0.2  0.8 ]]
chi:
[[1.17896037e-02 1.19284787e-02 5.33632180e-02 7.99374887e-02
  7.69188876e-02 4.76984583e-02 1.20256081e-01 1.18927637e-01
  3.79180147e-01 1.00000000e-01]
 [4.59163310e-01 1.25385314e-01 7.35838215e-02 4.43980064e-02
  5.40080761e-02 7.98052764e-02 1.17168973e-04 7.87098350e-03
  5.56680432e-02 1.00000000e-01]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 12: logL = -611.0
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #14
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.69e-18]
A:
[[0.82 0.18]
 [0.2  0.8 ]]
chi:
[[1.07852368e-02 1.17738739e-02 5.43870669e-02 8.07586586e-02
  7.71273127e-02 4.78915698e-02 1.20062699e-01 1.19234994e-01
  3.77978589e-01 1.00000000e-01]
 [4.61280816e-01 1.25811906e-01 7.25001429e-02 4.34120394e-02
  5.37264737e-02 7.96647348e-02 5.93288895e-05 7.28132180e-03
  5.62632366e-02 1.00000000e-01]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 13: logL = -610.9
2023-02-22 14:10 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -6.109e+02
2023-02-22 14:10 - INFO - TrainingManager : 71 -  >> BIC: 1.319e+03
2023-02-22 14:10 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:10 - INFO - cli : 125 - Training phase done in 00:00:00
2023-02-22 14:10 - INFO - cli : 155 - Process done in 00:00:00
2023-02-22 14:10 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_34
