2023-02-22 14:13 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/92.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/92.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:13 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/92.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/92.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_92
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:13 - INFO - cli : 50 - Loading input data
2023-02-22 14:13 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 104 - Spawning training set
2023-02-22 14:13 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:13 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:13 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.27 0.73]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12393689 0.04780029 0.06082579 0.07628344 0.07783573 0.09283117
  0.09958167 0.32090501 0.1       ]
 [0.33813905 0.09621687 0.08318214 0.07971778 0.06616013 0.05715618
  0.05040089 0.12902697 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -651.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.08 0.92]
A:
[[0.75 0.25]
 [0.26 0.74]]
chi:
[[0.08891816 0.03892714 0.05948223 0.07894208 0.08126741 0.10175141
  0.10724503 0.34346655 0.1       ]
 [0.37639414 0.10584387 0.08480959 0.07703596 0.06251654 0.04762495
  0.04200325 0.10377169 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -601.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.8  0.2 ]
 [0.22 0.78]]
chi:
[[0.05701044 0.02999879 0.05800458 0.08219504 0.08542958 0.1110302
  0.11419558 0.36213579 0.1       ]
 [0.41740745 0.1169989  0.08699429 0.07350556 0.05761193 0.03639827
  0.03300697 0.07807662 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -594.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.16e-04 1.00e+00]
A:
[[0.83 0.17]
 [0.19 0.81]]
chi:
[[0.03608456 0.02351834 0.05730312 0.08556111 0.08950757 0.11794153
  0.11839018 0.37169359 0.1       ]
 [0.45267569 0.12713779 0.08871464 0.06940082 0.05208878 0.02616296
  0.02565271 0.05816661 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -586.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.24e-06 1.00e+00]
A:
[[0.86 0.14]
 [0.18 0.82]]
chi:
[[0.02585316 0.02027519 0.05778429 0.08823151 0.09270857 0.12134722
  0.11986169 0.37393838 0.1       ]
 [0.47675902 0.13396459 0.08902994 0.065743   0.04719183 0.01947759
  0.0212572  0.04657682 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -580.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.12e-08 1.00e+00]
A:
[[0.86 0.14]
 [0.17 0.83]]
chi:
[[0.02151148 0.01911496 0.05887549 0.08987526 0.09489324 0.12247914
  0.11997578 0.37327466 0.1       ]
 [0.49134338 0.13772327 0.08831058 0.06324193 0.04354926 0.01599496
  0.01910602 0.0407306  0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -578.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.5e-10 1.0e+00]
A:
[[0.87 0.13]
 [0.18 0.82]]
chi:
[[0.01965712 0.01882828 0.06001993 0.09075702 0.09634494 0.12269002
  0.11966566 0.37203704 0.1       ]
 [0.50037463 0.13977192 0.08726963 0.06174008 0.04097029 0.01421498
  0.01806979 0.03758868 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -578.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.4e-12 1.0e+00]
A:
[[0.87 0.13]
 [0.18 0.82]]
chi:
[[0.01878972 0.01880998 0.06100426 0.09120968 0.09733281 0.12260572
  0.11929651 0.37095132 0.1       ]
 [0.50642869 0.14103557 0.08627142 0.0608551  0.03912043 0.01321232
  0.01750735 0.03556912 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -578.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.67e-14 1.00e+00]
A:
[[0.87 0.13]
 [0.18 0.82]]
chi:
[[0.01833423 0.01884081 0.06179565 0.09144233 0.09802438 0.12244461
  0.11897345 0.37014453 0.1       ]
 [0.51077637 0.14193455 0.08542452 0.06031569 0.03776314 0.01258336
  0.01714992 0.03405244 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -578.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.42e-16 1.00e+00]
A:
[[0.87 0.13]
 [0.18 0.82]]
chi:
[[0.01807043 0.01885887 0.06241772 0.0915638  0.09851868 0.12227684
  0.11871347 0.36958019 0.1       ]
 [0.5140399  0.14263866 0.08473739 0.05997011 0.03674963 0.01215654
  0.0168932  0.03281456 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -578.1
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.781e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 1.242e+03
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.26 0.74]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12358825 0.03966279 0.05276374 0.05580812 0.06653543 0.07169065
  0.08041776 0.08846064 0.32107262 0.1       ]
 [0.33863684 0.08037983 0.079264   0.06420067 0.06546345 0.05429113
  0.04554574 0.0434923  0.12872606 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -686.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.07 0.93]
A:
[[0.75 0.25]
 [0.26 0.74]]
chi:
[[0.08814591 0.03294337 0.04995436 0.05707127 0.06727611 0.07657984
  0.08922369 0.09504298 0.34376246 0.1       ]
 [0.37727161 0.08770391 0.0824295  0.0629988  0.06469336 0.04909529
  0.03614895 0.03626222 0.10339637 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -623.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.8  0.2 ]
 [0.22 0.78]]
chi:
[[0.05604649 0.02629162 0.04712875 0.05887562 0.0681627  0.08278199
  0.09811155 0.1006018  0.36199947 0.1       ]
 [0.41851733 0.09612906 0.08622643 0.06120512 0.06368199 0.04179742
  0.02536701 0.02891336 0.07816228 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -616.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.96e-04 1.00e+00]
A:
[[0.84 0.16]
 [0.19 0.81]]
chi:
[[0.03537206 0.02172112 0.04565156 0.06121127 0.06919235 0.08912913
  0.10407872 0.10343742 0.37020638 0.1       ]
 [0.45426092 0.10368588 0.08922272 0.05861764 0.06235672 0.03318006
  0.0161188  0.02327444 0.05928282 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -608.6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.64e-06 1.00e+00]
A:
[[0.86 0.14]
 [0.18 0.82]]
chi:
[[0.02559552 0.01981612 0.04618575 0.06376777 0.07018059 0.09386505
  0.10648066 0.10384701 0.37026154 0.1       ]
 [0.47997151 0.10870703 0.09001693 0.05543307 0.0609327  0.02558836
  0.01029694 0.0201255  0.04892797 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -603.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.26e-08 1.00e+00]
A:
[[0.87 0.13]
 [0.17 0.83]]
chi:
[[0.02179448 0.0195779  0.047867   0.06617494 0.07088677 0.09651948
  0.10698289 0.10315116 0.36704538 0.1       ]
 [0.49721421 0.11143715 0.08907426 0.05214238 0.05978158 0.02034643
  0.00703173 0.01872512 0.04424713 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -600.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.66e-10 1.00e+00]
A:
[[0.88 0.12]
 [0.17 0.83]]
chi:
[[0.0206359  0.0199723  0.04965601 0.06825794 0.07130394 0.09775922
  0.10685496 0.10219318 0.36336655 0.1       ]
 [0.50907714 0.11291201 0.08760487 0.04908395 0.0589888  0.01705231
  0.00502879 0.01815679 0.04209534 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -600.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.76e-12 1.00e+00]
A:
[[0.88 0.12]
 [0.17 0.83]]
chi:
[[0.02065656 0.0204831  0.05110151 0.06998344 0.07153084 0.09822466
  0.10656685 0.1012914  0.36016163 0.1       ]
 [0.51757407 0.11383823 0.08629786 0.04639846 0.05846472 0.01500955
  0.00364408 0.01791863 0.04085439 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -599.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.29e-14 1.00e+00]
A:
[[0.88 0.12]
 [0.17 0.83]]
chi:
[[0.02125922 0.02094038 0.05214844 0.0713859  0.0716526  0.09828589
  0.10624413 0.10052246 0.35756097 0.1       ]
 [0.52384775 0.11453646 0.08534005 0.0441026  0.05810763 0.01373255
  0.00262096 0.01779848 0.03991353 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -599.6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.29e-16 1.00e+00]
A:
[[0.88 0.12]
 [0.17 0.83]]
chi:
[[0.02217468 0.02131758 0.05287549 0.07251874 0.07171869 0.0981371
  0.10591046 0.09988356 0.3554637  0.1       ]
 [0.52859033 0.11512508 0.08470333 0.04215994 0.05785048 0.01292724
  0.00184966 0.01771361 0.03908033 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -599.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.63e-18 1.00e+00]
A:
[[0.89 0.11]
 [0.17 0.83]]
chi:
[[0.02325903 0.0216312  0.05337746 0.07343196 0.07175328 0.09788144
  0.10556745 0.0993537  0.35374448 0.1       ]
 [0.53224678 0.1156389  0.08430404 0.04052221 0.05765712 0.01241815
  0.00127262 0.01763354 0.03830664 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 10: logL = -599.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.19e-20 1.00e+00]
A:
[[0.89 0.11]
 [0.17 0.83]]
chi:
[[0.02442226 0.02190335 0.05373065 0.07416658 0.07176735 0.09757609
  0.10521661 0.09891189 0.35230522 0.1       ]
 [0.53511332 0.11608397 0.08406232 0.03914468 0.0575096  0.01209882
  0.00085083 0.01754878 0.03758768 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 11: logL = -599.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.02e-23 1.00e+00]
A:
[[0.89 0.11]
 [0.17 0.83]]
chi:
[[0.02560281 0.02215075 0.0539884  0.07475561 0.07176611 0.09725401
  0.10486333 0.09854101 0.35107797 0.1       ]
 [0.53739266 0.11646004 0.0839178  0.03798894 0.05739864 0.01190302
  0.00055213 0.01745831 0.03692847 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 12: logL = -599.3
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -5.993e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 1.296e+03
2023-02-22 14:13 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:13 - INFO - cli : 125 - Training phase done in 00:00:00
2023-02-22 14:13 - INFO - cli : 155 - Process done in 00:00:00
2023-02-22 14:13 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_92
