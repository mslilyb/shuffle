2023-02-22 14:10 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/28.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/28.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:10 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/28.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/28.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_28
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:10 - INFO - cli : 50 - Loading input data
2023-02-22 14:10 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:10 - INFO - cli : 104 - Spawning training set
2023-02-22 14:10 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:10 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:10 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:10 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:10 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.29 0.71]
A:
[[0.71 0.29]
 [0.29 0.71]]
chi:
[[0.12403408 0.0561467  0.06314765 0.06904393 0.0792961  0.09043687
  0.09717629 0.32071838 0.1       ]
 [0.32609253 0.09387694 0.08686721 0.08096354 0.07069851 0.05954378
  0.0527959  0.12916159 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 0: logL = -651.9
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.12 0.88]
A:
[[0.74 0.26]
 [0.27 0.73]]
chi:
[[0.0943067  0.05471852 0.06181477 0.06586265 0.08025597 0.09631526
  0.10216739 0.34455874 0.1       ]
 [0.35681199 0.09545509 0.08829809 0.08421556 0.06969905 0.05350228
  0.04760006 0.10441787 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 1: logL = -605.8
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.04 0.96]
A:
[[0.76 0.24]
 [0.25 0.75]]
chi:
[[0.06463546 0.05379423 0.06040469 0.06197618 0.08123361 0.10284861
  0.10702456 0.36808266 0.1       ]
 [0.38926179 0.09672112 0.08995001 0.08834033 0.06861489 0.04647461
  0.04219716 0.07844008 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 2: logL = -601.5
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.79 0.21]
 [0.22 0.78]]
chi:
[[0.04020009 0.05430735 0.05925702 0.05815235 0.08197643 0.10892051
  0.11040348 0.38678276 0.1       ]
 [0.41881512 0.09670211 0.09151098 0.09266954 0.06768324 0.03942472
  0.0378694  0.05532489 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 3: logL = -596.3
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.82 0.18]
 [0.2  0.8 ]]
chi:
[[0.02371974 0.05658728 0.0586393  0.05557    0.0823914  0.11338644
  0.11136638 0.39833946 0.1       ]
 [0.44215086 0.09486453 0.09265071 0.09596202 0.0670258  0.03358685
  0.03576619 0.03799303 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 4: logL = -591.6
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.81e-04 1.00e+00]
A:
[[0.83 0.17]
 [0.19 0.81]]
chi:
[[0.01398872 0.06010119 0.05844799 0.05473659 0.08262768 0.11593036
  0.11030804 0.40385945 0.1       ]
 [0.45935109 0.09154676 0.09338282 0.09750473 0.06652863 0.02954237
  0.03578656 0.02635703 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 5: logL = -588.4
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.59e-05 1.00e+00]
A:
[[0.84 0.16]
 [0.19 0.81]]
chi:
[[0.00846226 0.06391867 0.05842823 0.05519025 0.08288642 0.11698516
  0.10840439 0.40572462 0.1       ]
 [0.47213952 0.08764738 0.09391374 0.09760932 0.06599904 0.02708137
  0.0368748  0.01873482 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 6: logL = -586.7
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.84e-06 1.00e+00]
A:
[[0.84 0.16]
 [0.19 0.81]]
chi:
[[0.00526534 0.06733574 0.05844778 0.05621518 0.0832472  0.11714755
  0.10655627 0.40578493 0.1       ]
 [0.48193909 0.08396194 0.09435476 0.09696537 0.06535643 0.02571622
  0.03810077 0.01360542 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 7: logL = -585.8
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.03e-07 1.00e+00]
A:
[[0.85 0.15]
 [0.19 0.81]]
chi:
[[0.00335085 0.07005914 0.05848397 0.05732748 0.08369097 0.11687427
  0.1051116  0.40510172 0.1       ]
 [0.48956971 0.08089761 0.09471423 0.09609466 0.0646261  0.02501712
  0.03905753 0.01002305 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 8: logL = -585.2
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.e-07 1.e+00]
A:
[[0.85 0.15]
 [0.19 0.81]]
chi:
[[0.00216694 0.0720826  0.05854117 0.05830807 0.08417219 0.11644087
  0.10408771 0.40420044 0.1       ]
 [0.49552279 0.07854176 0.09498128 0.09526426 0.06386482 0.02469014
  0.03968707 0.00744788 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 9: logL = -584.9
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.75e-08 1.00e+00]
A:
[[0.85 0.15]
 [0.19 0.81]]
chi:
[[0.00141657 0.07352464 0.058619   0.05909601 0.0846525  0.11598918
  0.10339229 0.40330981 0.1       ]
 [0.50015415 0.07681566 0.09515937 0.09457233 0.06312109 0.02455645
  0.04005888 0.00556207 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 10: logL = -584.7
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.17e-09 1.00e+00]
A:
[[0.85 0.15]
 [0.19 0.81]]
chi:
[[0.00093265 0.07452803 0.05871108 0.05970034 0.0851071  0.11558138
  0.10292619 0.40251323 0.1       ]
 [0.5037497  0.07558715 0.09526414 0.09403346 0.06242632 0.02451496
  0.04025859 0.00416568 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 11: logL = -584.5
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.9e-10 1.0e+00]
A:
[[0.85 0.15]
 [0.2  0.8 ]]
chi:
[[0.0006169  0.07521726 0.05880943 0.06015284 0.08552237 0.11523799
  0.1026129  0.40183032 0.1       ]
 [0.50654111 0.0747274  0.09531486 0.09362924 0.06179722 0.02451203
  0.04035315 0.00312499 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 12: logL = -584.4
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #14
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.12e-10 1.00e+00]
A:
[[0.85 0.15]
 [0.2  0.8 ]]
chi:
[[4.09287088e-04 7.56878584e-02 5.89072468e-02 6.04876018e-02
  8.58924560e-02 1.14959806e-01 1.02399878e-01 4.01255867e-01
  1.00000000e-01]
 [5.08712072e-01 7.41310694e-02 9.53290167e-02 9.33326483e-02
  6.12402090e-02 2.45211573e-02 4.03873663e-02 2.34646052e-03
  1.00000000e-01]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 13: logL = -584.4
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #15
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.15e-11 1.00e+00]
A:
[[0.85 0.15]
 [0.2  0.8 ]]
chi:
[[2.72090862e-04 7.60086384e-02 5.89998285e-02 6.07339353e-02
  8.62164200e-02 1.14739593e-01 1.02252684e-01 4.00776810e-01
  1.00000000e-01]
 [5.10405316e-01 7.37190253e-02 9.53202799e-02 9.31179575e-02
  6.07551031e-02 2.45305627e-02 4.03889854e-02 1.76276966e-03
  1.00000000e-01]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 14: logL = -584.3
2023-02-22 14:10 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.843e+02
2023-02-22 14:10 - INFO - TrainingManager : 71 -  >> BIC: 1.254e+03
2023-02-22 14:10 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.29 0.71]
A:
[[0.71 0.29]
 [0.29 0.71]]
chi:
[[0.12385905 0.04899726 0.05073709 0.05646241 0.06842816 0.06613483
  0.07735547 0.08702143 0.32100431 0.1       ]
 [0.32607166 0.08299109 0.07525451 0.07553106 0.06357351 0.05386937
  0.04865437 0.04499297 0.12906146 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 0: logL = -687.1
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.12 0.88]
A:
[[0.74 0.26]
 [0.27 0.73]]
chi:
[[0.09366764 0.04797075 0.04871934 0.05162458 0.07145951 0.06747376
  0.08209101 0.09201987 0.34497355 0.1       ]
 [0.35739452 0.08417506 0.07739616 0.08049168 0.06049634 0.0524658
  0.04375459 0.0397697  0.10405616 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 1: logL = -628.6
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.03 0.97]
A:
[[0.76 0.24]
 [0.25 0.75]]
chi:
[[0.06361791 0.04727733 0.04672005 0.04635958 0.0748678  0.06879096
  0.08732936 0.09668905 0.36834797 0.1       ]
 [0.3908179  0.08523729 0.07972743 0.08618027 0.05688846 0.05096741
  0.03800192 0.03446742 0.0777119  0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 2: logL = -624.1
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.79 0.21]
 [0.22 0.78]]
chi:
[[0.03921574 0.04773813 0.04531795 0.04166323 0.07813808 0.06970146
  0.09216924 0.09973235 0.38632381 0.1       ]
 [0.42165555 0.08533047 0.08171672 0.09176085 0.05315165 0.04973085
  0.0321239  0.03029378 0.05423622 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 3: logL = -618.6
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.81 0.19]
 [0.21 0.79]]
chi:
[[0.02302917 0.04969504 0.04495689 0.03855107 0.08078768 0.06998243
  0.09576736 0.10043697 0.39679339 0.1       ]
 [0.44658059 0.08388804 0.08279495 0.096114   0.04977655 0.04904836
  0.02705119 0.02821948 0.03652684 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 4: logL = -613.8
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.71e-04 1.00e+00]
A:
[[0.83 0.17]
 [0.2  0.8 ]]
chi:
[[0.01355034 0.05275562 0.04548528 0.03718652 0.08267583 0.06978541
  0.09797215 0.09934412 0.40124474 0.1       ]
 [0.46561154 0.08107097 0.08293024 0.09878726 0.04702434 0.04886505
  0.0232047  0.02805726 0.02444864 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 5: logL = -610.7
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.47e-05 1.00e+00]
A:
[[0.83 0.17]
 [0.2  0.8 ]]
chi:
[[0.00818235 0.05613859 0.04642804 0.03701858 0.08395261 0.06941711
  0.09914399 0.09754943 0.4021693  0.1       ]
 [0.48024145 0.07760903 0.0825088  0.10011742 0.04486588 0.04891402
  0.02045068 0.02885947 0.01643326 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 6: logL = -608.9
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.76e-06 1.00e+00]
A:
[[0.84 0.16]
 [0.2  0.8 ]]
chi:
[[0.0050936  0.05923643 0.04740939 0.03741785 0.08484035 0.0690786
  0.09969919 0.09582093 0.40140365 0.1       ]
 [0.4916603  0.07420156 0.0819053  0.10065895 0.04315404 0.04899121
  0.01849826 0.02983889 0.01109149 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 7: logL = -607.9
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.13e-07 1.00e+00]
A:
[[0.84 0.16]
 [0.2  0.8 ]]
chi:
[[0.00325932 0.06178828 0.04825207 0.037977   0.08551213 0.06883785
  0.09993175 0.09444276 0.39999885 0.1       ]
 [0.50059558 0.07123463 0.08132981 0.10082904 0.04174889 0.04901568
  0.01709852 0.03064925 0.00749859 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 8: logL = -607.3
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.07e-07 1.00e+00]
A:
[[0.84 0.16]
 [0.21 0.79]]
chi:
[[0.00213336 0.06376706 0.0489114  0.03850209 0.08607282 0.06869313
  0.1000123  0.09342898 0.39847887 0.1       ]
 [0.50754765 0.0688309  0.08086136 0.10086152 0.04055192 0.04897896
  0.01607625 0.03122587 0.00506558 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 9: logL = -606.9
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.96e-08 1.00e+00]
A:
[[0.84 0.16]
 [0.21 0.79]]
chi:
[[0.00142151 0.06524676 0.04940293 0.0389266  0.08657693 0.06862079
  0.10002879 0.09270576 0.39706991 0.1       ]
 [0.51291796 0.06697    0.08050991 0.10086434 0.03950162 0.04889839
  0.01531538 0.03160909 0.0034133  0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 10: logL = -606.6
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.79e-09 1.00e+00]
A:
[[0.84 0.16]
 [0.21 0.79]]
chi:
[[0.00096034 0.06632706 0.04976034 0.03924395 0.0870493  0.0685964
  0.10002226 0.09219249 0.39584786 0.1       ]
 [0.51704603 0.06557366 0.0802585  0.10087774 0.03856127 0.0487942
  0.01473978 0.03185688 0.00229194 0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 11: logL = -606.5
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.56e-10 1.00e+00]
A:
[[0.84 0.16]
 [0.21 0.79]]
chi:
[[0.00065568 0.06710151 0.05001709 0.03946985 0.08749955 0.06860113
  0.10000977 0.09182523 0.3948202  0.1       ]
 [0.52021536 0.06455052 0.08008425 0.1009111  0.03770868 0.04868175
  0.01429873 0.03201651 0.0015331  0.1       ]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 12: logL = -606.4
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #14
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.55e-10 1.00e+00]
A:
[[0.85 0.15]
 [0.21 0.79]]
chi:
[[4.51324859e-04 6.76476253e-02 5.02005526e-02 3.96249334e-02
  8.79304602e-02 6.86222261e-02 9.99971811e-02 9.15584214e-02
  3.93967275e-01 1.00000000e-01]
 [5.22655482e-01 6.38159536e-02 7.99665917e-02 1.00962055e-01
  3.69295915e-02 4.85706168e-02 1.39575651e-02 3.21204670e-02
  1.02167699e-03 1.00000000e-01]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 13: logL = -606.3
2023-02-22 14:10 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #15
2023-02-22 14:10 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.23e-11 1.00e+00]
A:
[[0.85 0.15]
 [0.21 0.79]]
chi:
[[3.12627784e-04 6.80260174e-02 5.03314108e-02 3.97279346e-02
  8.83422266e-02 6.86516626e-02 9.99855947e-02 9.13609710e-02
  3.93261555e-01 1.00000000e-01]
 [5.24546778e-01 6.32989716e-02 7.98894008e-02 1.01025166e-01
  3.62139825e-02 4.84658509e-02 1.36918631e-02 3.21894788e-02
  6.78508184e-04 1.00000000e-01]]

2023-02-22 14:10 - DEBUG - TrainingManager : 134 - 14: logL = -606.2
2023-02-22 14:10 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -6.062e+02
2023-02-22 14:10 - INFO - TrainingManager : 71 -  >> BIC: 1.309e+03
2023-02-22 14:10 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:10 - INFO - cli : 125 - Training phase done in 00:00:00
2023-02-22 14:10 - INFO - cli : 155 - Process done in 00:00:00
2023-02-22 14:10 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_28
