2023-02-22 14:13 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/90.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/90.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:13 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/90.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/90.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_90
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:13 - INFO - cli : 50 - Loading input data
2023-02-22 14:13 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 104 - Spawning training set
2023-02-22 14:13 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:13 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:13 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.67 0.33]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11577153 0.04650978 0.0623506  0.07368434 0.07696432 0.09594558
  0.09515888 0.33361498 0.1       ]
 [0.33997769 0.09743326 0.08762113 0.07631272 0.07304007 0.06009452
  0.04889287 0.11662773 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -649.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.87 0.13]
A:
[[0.77 0.23]
 [0.24 0.76]]
chi:
[[0.07253474 0.03578941 0.06009332 0.07696019 0.07449041 0.10517527
  0.10255253 0.37240413 0.1       ]
 [0.38508735 0.1085884  0.09006221 0.07301936 0.07551491 0.05054119
  0.04112869 0.07605789 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -598.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.82 0.18]
 [0.19 0.81]]
chi:
[[0.03563863 0.02629192 0.05765623 0.080877   0.07179148 0.11540665
  0.109612   0.40272609 0.1       ]
 [0.42916041 0.11979887 0.09313712 0.06885417 0.07835529 0.03888228
  0.03266754 0.03914431 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -585.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[0.01587743 0.0222694  0.05595079 0.08401928 0.07055198 0.12317554
  0.11405964 0.41409593 0.1       ]
 [0.46117134 0.12666533 0.09593945 0.06508574 0.07988939 0.02834173
  0.02576681 0.01714022 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -572.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.61e-05]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.0082595  0.02261045 0.05542808 0.08549314 0.0709282  0.1271722
  0.11608649 0.41402194 0.1       ]
 [0.48046648 0.12874514 0.09748677 0.06294412 0.07967822 0.02150457
  0.0213477  0.00782699 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -565.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.08e-07]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.00521727 0.02405934 0.055618   0.08590178 0.07185286 0.12882777
  0.11700175 0.41152122 0.1       ]
 [0.49186971 0.12878217 0.09795655 0.06208765 0.07872756 0.01779825
  0.01869875 0.00407937 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -562.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 8.44e-10]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.00366625 0.0251875  0.05607348 0.0859548  0.07277038 0.12946852
  0.11752959 0.40934948 0.1       ]
 [0.49899125 0.12854868 0.0978629  0.06176679 0.07769335 0.01582693
  0.01700106 0.00230905 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -562.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.95e-12]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.00269812 0.02586461 0.05659547 0.08593836 0.07350687 0.12971004
  0.11792778 0.40775875 0.1       ]
 [0.503716   0.12845876 0.09752278 0.06161404 0.07682724 0.01471919
  0.0157953  0.00134669 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -562.0
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.66e-15]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.00202812 0.02624163 0.0571166  0.08592741 0.07403922 0.12978877
  0.11826921 0.40658904 0.1       ]
 [0.50700872 0.12849811 0.09708074 0.06150787 0.07618629 0.01405611
  0.01487115 0.00079101 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -561.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.14e-18]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[1.54263559e-03 2.64466092e-02 5.76165677e-02 8.59338618e-02
  7.43982925e-02 1.29795193e-01 1.18571174e-01 4.05695666e-01
  1.00000000e-01]
 [5.09399771e-01 1.28605418e-01 9.66009485e-02 6.14133975e-02
  7.57476919e-02 1.36384129e-02 1.41298672e-02 4.64493071e-04
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -561.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.02e-21]
A:
[[0.88 0.12]
 [0.15 0.85]]
chi:
[[1.18290849e-03 2.65557604e-02 5.80894052e-02 8.59557504e-02
  7.46267083e-02 1.29766762e-01 1.18838066e-01 4.04984640e-01
  1.00000000e-01]
 [5.11202523e-01 1.28741418e-01 9.61144719e-02 6.13207127e-02
  7.54660899e-02 1.33643177e-02 1.35182591e-02 2.72208225e-04
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 10: logL = -561.7
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.617e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 1.209e+03
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.68 0.32]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11579754 0.03947958 0.05335638 0.05781817 0.06341726 0.06994601
  0.07884422 0.08794049 0.33340035 0.1       ]
 [0.34001591 0.08648131 0.0786226  0.06217821 0.06857844 0.05606554
  0.04718213 0.04409599 0.11677987 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -685.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.89 0.11]
A:
[[0.77 0.23]
 [0.24 0.76]]
chi:
[[0.07274052 0.02951109 0.0512333  0.06223544 0.0594172  0.07182802
  0.0863254  0.09473605 0.37197299 0.1       ]
 [0.38500123 0.0968646  0.08093235 0.05773949 0.07265665 0.05407295
  0.03941293 0.03694158 0.07637822 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -621.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.82 0.18]
 [0.19 0.81]]
chi:
[[0.03586616 0.02062009 0.04918015 0.06740386 0.05451785 0.07354477
  0.0951214  0.10127158 0.40247414 0.1       ]
 [0.42874208 0.10727867 0.08357343 0.05226442 0.07799658 0.05198279
  0.02943945 0.02914814 0.03957443 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -608.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.99e-01 6.39e-04]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[0.01577861 0.01655296 0.04828371 0.07114584 0.05090453 0.0745183
  0.10248072 0.10540735 0.41492799 0.1       ]
 [0.45974833 0.11372073 0.0853464  0.04782861 0.08248444 0.05042188
  0.01988658 0.02296669 0.01759633 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -595.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 8.02e-06]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.00778577 0.01647032 0.04851614 0.07247411 0.04950824 0.07480237
  0.10655355 0.10742997 0.41645954 0.1       ]
 [0.47727488 0.11566999 0.08579112 0.04587974 0.08466811 0.04964013
  0.01369889 0.01910271 0.00827444 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -587.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.06e-08]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.0044774  0.01770826 0.04905198 0.07245997 0.04915148 0.07507127
  0.10816126 0.10855663 0.41536176 0.1       ]
 [0.48698424 0.11547723 0.08563681 0.04556327 0.08552153 0.04901364
  0.01067395 0.0166918  0.00443754 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -585.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.07e-10]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.00279178 0.0188856  0.04948957 0.0721404  0.0490168  0.07555348
  0.10865197 0.10932933 0.41414105 0.1       ]
 [0.4928638  0.11488224 0.08541765 0.04572187 0.08597367 0.04823605
  0.00930945 0.01504106 0.00255422 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -584.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.63e-13]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.00180012 0.01971495 0.04979963 0.0718769  0.04891519 0.07614315
  0.10872223 0.10991442 0.41311341 0.1       ]
 [0.49675523 0.11442833 0.08524817 0.04588868 0.086299   0.04738421
  0.00867597 0.01382389 0.00149651 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -584.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.49e-16]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.0011788  0.0202545  0.05003653 0.07172576 0.04883841 0.07671934
  0.10864025 0.11037244 0.41223397 0.1       ]
 [0.49951436 0.11416813 0.08510893 0.04596378 0.08654314 0.04657738
  0.00836674 0.01288435 0.0008732  0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -584.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 8.03e-20]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.00077929 0.02060044 0.05024071 0.07166651 0.04879355 0.07722001
  0.10850646 0.11073642 0.4114566  0.1       ]
 [0.50157629 0.11404955 0.08497436 0.04595339 0.08671676 0.04587894
  0.00820971 0.01213684 0.00050416 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -584.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.53e-23]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[5.19010888e-04 2.08234002e-02 5.04306909e-02 7.16701612e-02
  4.87783290e-02 7.76273222e-02 1.08360438e-01 1.11029890e-01
  4.10760757e-01 1.00000000e-01]
 [5.03180550e-01 1.14020439e-01 8.48339740e-02 4.58827703e-02
  8.68328129e-02 4.53055342e-02 8.12811633e-03 1.15279760e-02
  2.87827062e-04 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 10: logL = -584.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 4.6e-27]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[3.47892490e-04 2.09685068e-02 5.06121792e-02 7.17135391e-02
  4.87850795e-02 7.79459492e-02 1.08218324e-01 1.11270670e-01
  4.10137860e-01 1.00000000e-01]
 [5.04467982e-01 1.14044386e-01 8.46874605e-02 4.57747044e-02
  8.69063486e-02 4.48491624e-02 8.08542531e-03 1.10218538e-02
  1.62676435e-04 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 11: logL = -584.1
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -5.841e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 1.265e+03
2023-02-22 14:13 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:13 - INFO - cli : 125 - Training phase done in 00:00:00
2023-02-22 14:13 - INFO - cli : 155 - Process done in 00:00:00
2023-02-22 14:13 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_90
