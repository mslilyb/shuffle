2023-02-22 14:09 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/02.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/02.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:09 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/02.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/02.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_02
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:09 - INFO - cli : 50 - Loading input data
2023-02-22 14:09 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:09 - INFO - cli : 104 - Spawning training set
2023-02-22 14:09 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:09 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:09 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:09 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:09 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.49 0.51]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11088899 0.04947476 0.06102105 0.07653449 0.08064905 0.0948941
  0.09899337 0.3275442  0.1       ]
 [0.34036708 0.10080621 0.08913282 0.07344862 0.06928877 0.05488692
  0.05074253 0.12132706 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 0: logL = -649.9
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.48 0.52]
A:
[[0.77 0.23]
 [0.24 0.76]]
chi:
[[0.06659093 0.03978094 0.0565865  0.08386647 0.08374217 0.10622824
  0.10587927 0.35732549 0.1       ]
 [0.39202017 0.11213357 0.09441446 0.06565155 0.06578261 0.0420742
  0.04244213 0.08548132 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 1: logL = -599.6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.48 0.52]
A:
[[0.82 0.18]
 [0.2  0.8 ]]
chi:
[[0.03262207 0.03069407 0.05223549 0.09240682 0.0879435  0.11620592
  0.1108731  0.37701903 0.1       ]
 [0.44661697 0.12603988 0.10122443 0.05494756 0.06008925 0.0275313
  0.03367463 0.04987597 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 2: logL = -587.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.47 0.53]
A:
[[0.86 0.14]
 [0.18 0.82]]
chi:
[[0.01637097 0.02564766 0.05035102 0.09924713 0.092929   0.12131864
  0.11266918 0.38146642 0.1       ]
 [0.49159786 0.13806518 0.10649785 0.04401566 0.05208933 0.01581145
  0.02686422 0.02505845 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 3: logL = -574.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.49 0.51]
A:
[[0.88 0.12]
 [0.17 0.83]]
chi:
[[0.01054432 0.02440509 0.0507073  0.10283151 0.09706877 0.12271775
  0.11308062 0.37864464 0.1       ]
 [0.52244817 0.14517471 0.10869376 0.03639793 0.04439081 0.00881589
  0.02218251 0.01189622 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 4: logL = -566.7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.57 0.43]
A:
[[0.88 0.12]
 [0.17 0.83]]
chi:
[[0.00839439 0.0247306  0.05164395 0.10435704 0.09976033 0.12279568
  0.11361116 0.37470686 0.1       ]
 [0.54266432 0.1487229  0.10925296 0.03194626 0.03868759 0.00490495
  0.01837457 0.00544646 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 5: logL = -564.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.7 0.3]
A:
[[0.89 0.11]
 [0.18 0.82]]
chi:
[[0.00736686 0.02533988 0.05249515 0.10511013 0.10166944 0.12250336
  0.11434346 0.37117171 0.1       ]
 [0.55647655 0.15063722 0.10927708 0.02913933 0.03437984 0.00264773
  0.01507606 0.00236619 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 6: logL = -562.8
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.83 0.17]
A:
[[0.89 0.11]
 [0.18 0.82]]
chi:
[[0.00671919 0.02587962 0.05319247 0.10562746 0.10328031 0.12207081
  0.11502665 0.36820349 0.1       ]
 [0.56648089 0.15184446 0.10911593 0.02708608 0.03075797 0.00136191
  0.01238186 0.00097089 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 7: logL = -562.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.93 0.07]
A:
[[0.88 0.12]
 [0.18 0.82]]
chi:
[[6.24419050e-03 2.63047329e-02 5.37857966e-02 1.06002182e-01
  1.04673064e-01 1.21600047e-01 1.15571017e-01 3.65818970e-01
  1.00000000e-01]
 [5.73937880e-01 1.52673929e-01 1.08838823e-01 2.55483498e-02
  2.76684286e-02 6.68161396e-04 1.02850808e-02 3.79346859e-04
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 8: logL = -561.6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.97 0.03]
A:
[[0.88 0.12]
 [0.19 0.81]]
chi:
[[5.87573281e-03 2.66336644e-02 5.43147267e-02 1.06221328e-01
  1.05810095e-01 1.21162699e-01 1.15997454e-01 3.63984301e-01
  1.00000000e-01]
 [5.79512574e-01 1.53250001e-01 1.08465894e-01 2.44882364e-02
  2.51535528e-02 3.15177283e-04 8.67182493e-03 1.42740283e-04
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 9: logL = -561.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.88 0.12]
 [0.19 0.81]]
chi:
[[5.58285006e-03 2.68935927e-02 5.47884827e-02 1.06305008e-01
  1.06699829e-01 1.20789301e-01 1.16340563e-01 3.62600373e-01
  1.00000000e-01]
 [5.83701047e-01 1.53643892e-01 1.08041594e-01 2.38228732e-02
  2.31774239e-02 1.44091653e-04 7.41684568e-03 5.22329469e-05
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 10: logL = -561.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.88 0.12]
 [0.19 0.81]]
chi:
[[5.34525970e-03 2.71057797e-02 5.52024216e-02 1.06298308e-01
  1.07389450e-01 1.20482390e-01 1.16623585e-01 3.61552806e-01
  1.00000000e-01]
 [5.86898119e-01 1.53909420e-01 1.07618037e-01 2.34336246e-02
  2.16358836e-02 6.42557767e-05 6.42193514e-03 1.87247134e-05
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 11: logL = -561.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.47e-04]
A:
[[0.88 0.12]
 [0.19 0.81]]
chi:
[[5.14867207e-03 2.72835318e-02 5.55541334e-02 1.06241945e-01
  1.07928691e-01 1.20233726e-01 1.16861272e-01 3.60748028e-01
  1.00000000e-01]
 [5.89389053e-01 1.54086894e-01 1.07230239e-01 2.32185396e-02
  2.04228703e-02 2.80872940e-05 5.61770619e-03 6.61006215e-06
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 12: logL = -561.0
2023-02-22 14:09 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.610e+02
2023-02-22 14:09 - INFO - TrainingManager : 71 -  >> BIC: 1.208e+03
2023-02-22 14:09 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.46 0.54]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11063988 0.04167003 0.0524382  0.05627163 0.07304411 0.07015786
  0.07986443 0.08796941 0.32794444 0.1       ]
 [0.34048912 0.09057016 0.07366607 0.0697948  0.06491596 0.04974185
  0.04596908 0.0438137  0.12103926 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 0: logL = -685.2
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.41 0.59]
A:
[[0.77 0.23]
 [0.24 0.76]]
chi:
[[0.0660142  0.03158496 0.05326757 0.05365376 0.07894833 0.07750029
  0.0877244  0.0940136  0.35729289 0.1       ]
 [0.39277366 0.10231731 0.07327039 0.07286285 0.05850179 0.04153239
  0.03690897 0.03643796 0.08539469 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 1: logL = -622.6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.36 0.64]
A:
[[0.83 0.17]
 [0.2  0.8 ]]
chi:
[[0.03169185 0.02175365 0.05611357 0.04993039 0.08637087 0.08546905
  0.09482723 0.09831899 0.37552441 0.1       ]
 [0.44917233 0.11731085 0.07098594 0.07815635 0.04885565 0.03046449
  0.02609114 0.02852086 0.0504424  0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 2: logL = -610.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.27 0.73]
A:
[[0.87 0.13]
 [0.17 0.83]]
chi:
[[0.01508419 0.01528905 0.06095475 0.04631698 0.09298469 0.09085646
  0.09914423 0.10011989 0.37924977 0.1       ]
 [0.4948685  0.13119418 0.06562938 0.08444775 0.0381652  0.02033083
  0.01653286 0.02213535 0.02669594 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 3: logL = -596.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.2 0.8]
A:
[[0.88 0.12]
 [0.17 0.83]]
chi:
[[0.00892367 0.01224515 0.06485811 0.04370882 0.09656136 0.09292139
  0.10141953 0.10112457 0.3782374  0.1       ]
 [0.52156108 0.13977762 0.06044978 0.08947681 0.0311725  0.01481595
  0.01026985 0.01779212 0.01468428 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 4: logL = -588.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.14 0.86]
A:
[[0.89 0.11]
 [0.17 0.83]]
chi:
[[0.00638204 0.01102469 0.06687571 0.04207981 0.0979104  0.09350059
  0.1027893  0.10222475 0.3772127  0.1       ]
 [0.53580756 0.144158   0.05748992 0.09274207 0.0278983  0.01237246
  0.00643184 0.01449954 0.00860031 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 5: logL = -585.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.11 0.89]
A:
[[0.88 0.12]
 [0.17 0.83]]
chi:
[[0.00492737 0.01058364 0.06777953 0.04113579 0.09825871 0.09365468
  0.10370409 0.1034019  0.37655429 0.1       ]
 [0.54423752 0.14638702 0.05606681 0.09471624 0.02655729 0.01118049
  0.00395461 0.01174478 0.00515523 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 6: logL = -584.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.09 0.91]
A:
[[0.88 0.12]
 [0.18 0.82]]
chi:
[[0.00389444 0.01051196 0.06818827 0.04059809 0.09822116 0.09368794
  0.10430926 0.10446961 0.37611926 0.1       ]
 [0.54967557 0.14747968 0.05538145 0.09589538 0.02609109 0.010532
  0.0023407  0.0095105  0.00309363 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 7: logL = -583.8
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.07 0.93]
A:
[[0.88 0.12]
 [0.18 0.82]]
chi:
[[0.00310474 0.01064662 0.06839294 0.04028049 0.09805295 0.09367865
  0.10467948 0.10534736 0.37581676 0.1       ]
 [0.55332561 0.1479032  0.05502038 0.09661674 0.02601202 0.01016764
  0.00132928 0.00777998 0.00184516 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 8: logL = -583.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.06 0.94]
A:
[[0.88 0.12]
 [0.18 0.82]]
chi:
[[0.00248886 0.01090046 0.06851356 0.04007825 0.09785387 0.09364883
  0.10488211 0.10604181 0.37559224 0.1       ]
 [0.55584099 0.14792483 0.05480216 0.09708123 0.02609858 0.00996919
  0.00072753 0.00646378 0.00109171 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 9: logL = -583.2
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.05 0.95]
A:
[[0.88 0.12]
 [0.19 0.81]]
chi:
[[2.00502437e-03 1.12149851e-02 6.85977611e-02 3.99373956e-02
  9.76607293e-02 9.36069191e-02 1.04976745e-01 1.06588439e-01
  3.75412002e-01 1.00000000e-01]
 [5.57626586e-01 1.47719117e-01 5.46501968e-02 9.74009337e-02
  2.62487204e-02 9.87082223e-03 3.86116946e-04 5.45695972e-03
  6.40546628e-04 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 10: logL = -583.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.04 0.96]
A:
[[0.88 0.12]
 [0.19 0.81]]
chi:
[[1.62272200e-03 1.15495017e-02 6.86641226e-02 3.98313579e-02
  9.74856919e-02 9.35582330e-02 1.05008191e-01 1.07022914e-01
  3.75257265e-01 1.00000000e-01]
 [5.58938039e-01 1.47400815e-01 5.45324154e-02 9.76359799e-02
  2.64152923e-02 9.83209301e-03 1.99821082e-04 4.67276207e-03
  3.72782121e-04 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 11: logL = -583.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.03 0.97]
A:
[[0.88 0.12]
 [0.19 0.81]]
chi:
[[1.31883838e-03 1.18775025e-02 6.87197517e-02 3.97472325e-02
  9.73316267e-02 9.35069038e-02 1.05005913e-01 1.07373305e-01
  3.75118927e-01 1.00000000e-01]
 [5.59935139e-01 1.47041810e-01 5.44353725e-02 9.78181709e-02
  2.65768595e-02 9.82751612e-03 1.01291252e-04 4.04854436e-03
  2.15295782e-04 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 12: logL = -582.9
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #14
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.02 0.98]
A:
[[0.88 0.12]
 [0.19 0.81]]
chi:
[[1.07583150e-03 1.21835929e-02 6.87673832e-02 3.96785402e-02
  9.71980149e-02 9.34560532e-02 1.04987449e-01 1.07660087e-01
  3.74993049e-01 1.00000000e-01]
 [5.60717486e-01 1.46684050e-01 5.43532719e-02 9.79646130e-02
  2.67242297e-02 9.84113527e-03 5.04719773e-05 3.54126825e-03
  1.23472916e-04 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 13: logL = -582.9
2023-02-22 14:09 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -5.829e+02
2023-02-22 14:09 - INFO - TrainingManager : 71 -  >> BIC: 1.263e+03
2023-02-22 14:09 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:09 - INFO - cli : 125 - Training phase done in 00:00:00
2023-02-22 14:09 - INFO - cli : 155 - Process done in 00:00:00
2023-02-22 14:09 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_02
