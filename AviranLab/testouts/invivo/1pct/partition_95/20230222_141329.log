2023-02-22 14:13 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/95.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/95.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:13 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/95.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/95.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_95
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:13 - INFO - cli : 50 - Loading input data
2023-02-22 14:13 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 104 - Spawning training set
2023-02-22 14:13 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:13 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:13 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:13 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.57 0.43]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11948105 0.04802758 0.05832544 0.07318599 0.08135239 0.08929943
  0.10216217 0.32816595 0.1       ]
 [0.33068619 0.10201517 0.09170099 0.07681689 0.06863754 0.0606779
  0.04779478 0.12167054 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -650.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.69 0.31]
A:
[[0.75 0.25]
 [0.25 0.75]]
chi:
[[0.08304922 0.03622825 0.05047175 0.07571727 0.08564173 0.09406729
  0.11426964 0.36055484 0.1       ]
 [0.36777514 0.11399691 0.09967069 0.07427856 0.06429646 0.05582198
  0.0355023  0.08865794 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -601.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.84 0.16]
A:
[[0.79 0.21]
 [0.21 0.79]]
chi:
[[0.04933412 0.02379218 0.04200606 0.07899742 0.09118569 0.09917515
  0.12684315 0.38866622 0.1       ]
 [0.40409527 0.12720751 0.10863805 0.07092454 0.05849833 0.05035289
  0.02214475 0.05813865 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -592.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.95 0.05]
A:
[[0.82 0.18]
 [0.18 0.82]]
chi:
[[0.0277837  0.01436301 0.03567201 0.08229242 0.09634534 0.10300185
  0.13583393 0.40470774 0.1       ]
 [0.43033972 0.13813466 0.11594793 0.0674072  0.05277544 0.04584474
  0.0116603  0.03789002 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -581.8
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.01750159 0.00898924 0.03240822 0.08469019 0.09962611 0.10520163
  0.1403968  0.41118624 0.1       ]
 [0.44506033 0.14500705 0.12017028 0.06472317 0.04888303 0.04296996
  0.00564409 0.02754208 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -575.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.01262279 0.00610847 0.03092014 0.08608519 0.10125367 0.10657258
  0.14244993 0.41398722 0.1       ]
 [0.45281047 0.14889781 0.1222831  0.06310926 0.0468385  0.04113307
  0.00264854 0.02227924 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -573.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.56e-04]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.009843   0.00440551 0.03010382 0.08681481 0.10199626 0.10762166
  0.14338392 0.41583101 0.1       ]
 [0.45713348 0.15116459 0.12343861 0.06225296 0.04587366 0.0398044
  0.00122039 0.0191119  0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -572.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.92e-05]
A:
[[0.83 0.17]
 [0.17 0.83]]
chi:
[[0.00798062 0.00328353 0.02951872 0.08715171 0.10233948 0.10850264
  0.14382831 0.41739499 0.1       ]
 [0.45972767 0.15256837 0.12419245 0.06185674 0.04542968 0.03876362
  0.00055545 0.01690601 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -572.0
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.38e-06]
A:
[[0.83 0.17]
 [0.18 0.82]]
chi:
[[6.61429277e-03 2.49003847e-03 2.90318027e-02 8.72565110e-02
  1.02506911e-01 1.09252584e-01 1.44059764e-01 4.18788096e-01
  1.00000000e-01]
 [4.61376852e-01 1.53483508e-01 1.24755169e-01 6.17337679e-02
  4.52270030e-02 3.79256050e-02 2.50924829e-04 1.52471694e-02
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -571.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.95e-07]
A:
[[0.83 0.17]
 [0.18 0.82]]
chi:
[[5.56225447e-03 1.90551236e-03 2.86080507e-02 8.72256109e-02
  1.02594288e-01 1.09885310e-01 1.44199508e-01 4.20019465e-01
  1.00000000e-01]
 [4.62473622e-01 1.54102220e-01 1.25204965e-01 6.17695501e-02
  4.51377007e-02 3.72474205e-02 1.12893850e-04 1.39516286e-02
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -571.6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.69e-08]
A:
[[0.83 0.17]
 [0.18 0.82]]
chi:
[[4.72813774e-03 1.46489774e-03 2.82383850e-02 8.71197286e-02
  1.02643164e-01 1.10413156e-01 1.44298806e-01 4.21093726e-01
  1.00000000e-01]
 [4.63232434e-01 1.54531022e-01 1.25574473e-01 6.18920505e-02
  4.51028624e-02 3.66993193e-02 5.06942997e-05 1.29171437e-02
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 10: logL = -571.5
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.65e-09]
A:
[[0.83 0.17]
 [0.18 0.82]]
chi:
[[4.05311777e-03 1.12846153e-03 2.79189294e-02 8.69776040e-02
  1.02672420e-01 1.10849536e-01 1.44378165e-01 4.22021766e-01
  1.00000000e-01]
 [4.63778152e-01 1.54833258e-01 1.25880695e-01 6.20557569e-02
  4.50943082e-02 3.62572672e-02 2.27486418e-05 1.20778141e-02
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 11: logL = -571.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.88e-10]
A:
[[0.82 0.18]
 [0.18 0.82]]
chi:
[[3.49822415e-03 8.69786595e-04 2.76459224e-02 8.68234885e-02
  1.02691149e-01 1.11207961e-01 1.44445261e-01 4.22818207e-01
  1.00000000e-01]
 [4.64186544e-01 1.55048792e-01 1.26134841e-01 6.22325206e-02
  4.50979814e-02 3.59011841e-02 1.02083907e-05 1.13879289e-02
  1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 12: logL = -571.4
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.714e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 1.228e+03
2023-02-22 14:13 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.55 0.45]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11948734 0.04120894 0.04888422 0.05638583 0.06613537 0.07168845
  0.07824914 0.08929954 0.32866116 0.1       ]
 [0.33060888 0.09081366 0.07712865 0.07562294 0.05986177 0.05430363
  0.04773695 0.04267921 0.12124431 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 0: logL = -685.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.66 0.34]
A:
[[0.75 0.25]
 [0.25 0.75]]
chi:
[[0.08325819 0.03059523 0.04402866 0.05066623 0.07080856 0.07645487
  0.08481728 0.09783423 0.36153676 0.1       ]
 [0.36760707 0.1016209  0.08208715 0.08142738 0.05514377 0.04946299
  0.04104954 0.03397144 0.08762976 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 1: logL = -624.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.82 0.18]
A:
[[0.79 0.21]
 [0.21 0.79]]
chi:
[[0.05002852 0.01960052 0.03871513 0.04383155 0.07694395 0.08187252
  0.09225222 0.10678822 0.38996738 0.1       ]
 [0.40376923 0.11340658 0.08781197 0.08864962 0.0487534  0.04371786
  0.03311286 0.02432648 0.05645201 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 2: logL = -615.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.95 0.05]
A:
[[0.83 0.17]
 [0.18 0.82]]
chi:
[[0.02901068 0.01149502 0.03469585 0.03767069 0.08296487 0.08603888
  0.09831522 0.11377875 0.40603003 0.1       ]
 [0.43011415 0.12304261 0.09262193 0.09564826 0.04210561 0.03888848
  0.02604058 0.01599678 0.03554161 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 3: logL = -605.0
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.01906431 0.00704063 0.03259665 0.03351162 0.08728473 0.08795795
  0.10205391 0.11802879 0.41246141 0.1       ]
 [0.44539094 0.1290979  0.09553745 0.10076884 0.03701065 0.03629018
  0.02120477 0.01031915 0.02438011 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 4: logL = -598.7
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.99e-01 8.76e-04]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.01441004 0.00470865 0.03157257 0.03114307 0.08997694 0.08839272
  0.10423294 0.12047939 0.41508368 0.1       ]
 [0.45403985 0.13266111 0.09718081 0.10391076 0.0336596  0.03538261
  0.01815463 0.00674764 0.01826299 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 5: logL = -596.3
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 7.93e-05]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.01181685 0.00332789 0.03094413 0.02988722 0.09166733 0.08825171
  0.10560867 0.12195362 0.41654258 0.1       ]
 [0.4594212  0.13491572 0.09824939 0.10571046 0.03147673 0.03523263
  0.0161465  0.00447208 0.01437528 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 6: logL = -595.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 6.57e-06]
A:
[[0.83 0.17]
 [0.18 0.82]]
chi:
[[0.0101136  0.00241117 0.03047279 0.0292427  0.09278302 0.08796734
  0.10655814 0.12287183 0.41757941 0.1       ]
 [0.46307986 0.1364522  0.09903799 0.10672464 0.03000239 0.03533784
  0.01474048 0.00298978 0.01163481 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 7: logL = -594.9
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.19e-07]
A:
[[0.83 0.17]
 [0.18 0.82]]
chi:
[[0.00888118 0.00176505 0.03009294 0.028921   0.0935534  0.08768698
  0.1072549  0.12345312 0.41839143 0.1       ]
 [0.4657112  0.13754431 0.09965159 0.10729826 0.0289699  0.03550386
  0.01370929 0.00200923 0.00960237 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 8: logL = -594.6
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.96e-08]
A:
[[0.83 0.17]
 [0.19 0.81]]
chi:
[[0.00794145 0.00129746 0.02978205 0.02876567 0.09410343 0.0874507
  0.10778622 0.12382266 0.41905036 0.1       ]
 [0.46767148 0.13833745 0.10013767 0.10762799 0.02822636 0.03566411
  0.01292901 0.00135426 0.00805168 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 9: logL = -594.4
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.96e-09]
A:
[[0.83 0.17]
 [0.19 0.81]]
chi:
[[0.00720171 0.00095512 0.02952669 0.0286929  0.09450607 0.08726395
  0.10820144 0.12405656 0.41959556 0.1       ]
 [0.46916838 0.13892023 0.10052611 0.10782408 0.02767931 0.03579828
  0.01232576 0.0009142  0.00684365 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 10: logL = -594.2
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.18e-10]
A:
[[0.83 0.17]
 [0.19 0.81]]
chi:
[[0.00660611 0.00070323 0.02931605 0.02865837 0.09480665 0.08712183
  0.10853139 0.12420279 0.42005357 0.1       ]
 [0.47033397 0.13935148 0.10083904 0.10794792 0.02726982 0.03590261
  0.01185206 0.00061758 0.00588552 0.1       ]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 11: logL = -594.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.59e-11]
A:
[[0.83 0.17]
 [0.19 0.81]]
chi:
[[6.11794270e-03 5.17502582e-04 2.91412182e-02 2.86393068e-02
  9.50347215e-02 8.70169754e-02 1.08796705e-01 1.24292275e-01
  4.20443354e-01 1.00000000e-01]
 [4.71256908e-01 1.39672175e-01 1.01093387e-01 1.08033271e-01
  2.69588025e-02 3.59793015e-02 1.14756537e-02 4.17304694e-04
  5.11319657e-03 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 12: logL = -594.1
2023-02-22 14:13 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #14
2023-02-22 14:13 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.14e-12]
A:
[[0.82 0.18]
 [0.19 0.81]]
chi:
[[5.71182747e-03 3.80503055e-04 2.89950238e-02 2.86246684e-02
  9.52102094e-02 8.69419871e-02 1.09011900e-01 1.24345163e-01
  4.20778717e-01 1.00000000e-01]
 [4.71998776e-01 1.39911581e-01 1.01302054e-01 1.08098309e-01
  2.67195103e-02 3.60325560e-02 1.11737526e-02 2.81982880e-04
  4.48147855e-03 1.00000000e-01]]

2023-02-22 14:13 - DEBUG - TrainingManager : 134 - 13: logL = -594.0
2023-02-22 14:13 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -5.940e+02
2023-02-22 14:13 - INFO - TrainingManager : 71 -  >> BIC: 1.285e+03
2023-02-22 14:13 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:13 - INFO - cli : 125 - Training phase done in 00:00:00
2023-02-22 14:13 - INFO - cli : 155 - Process done in 00:00:00
2023-02-22 14:13 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_95
