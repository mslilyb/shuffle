2023-02-22 14:09 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/11.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/11.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:09 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/11.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/11.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_11
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:09 - INFO - cli : 50 - Loading input data
2023-02-22 14:09 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:09 - INFO - cli : 104 - Spawning training set
2023-02-22 14:09 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:09 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:09 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:09 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:09 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.58 0.42]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.1199681  0.04813392 0.06036459 0.07408628 0.07840619 0.0901033
  0.09910558 0.32983204 0.1       ]
 [0.32948161 0.10172532 0.08955873 0.08189322 0.06562737 0.05997583
  0.05102072 0.1207172  0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 0: logL = -650.5
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.67 0.33]
A:
[[0.75 0.25]
 [0.24 0.76]]
chi:
[[0.08410151 0.03666866 0.05496651 0.07383551 0.08235089 0.09622181
  0.1070386  0.36481651 0.1       ]
 [0.36415656 0.11285745 0.09478581 0.082113   0.06177708 0.05404056
  0.04335749 0.08691204 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 1: logL = -602.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.78 0.22]
A:
[[0.79 0.21]
 [0.2  0.8 ]]
chi:
[[0.04985662 0.02480151 0.04843278 0.07367049 0.08682422 0.10356691
  0.11541474 0.39743272 0.1       ]
 [0.39589387 0.12398052 0.10092262 0.08222446 0.05753546 0.04712621
  0.03556585 0.05675102 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 2: logL = -593.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.88 0.12]
A:
[[0.82 0.18]
 [0.17 0.83]]
chi:
[[0.02596313 0.01592507 0.04220822 0.07352619 0.09033563 0.1102846
  0.12178004 0.41997713 0.1       ]
 [0.41569874 0.13160014 0.10641805 0.08228639 0.0544325  0.04119356
  0.03017969 0.03819093 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 3: logL = -583.9
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.95 0.05]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.01304866 0.01081092 0.03740209 0.07307365 0.09192096 0.11510016
  0.12530131 0.43334225 0.1       ]
 [0.42333319 0.13506485 0.11018219 0.08260983 0.05335898 0.03747633
  0.02793062 0.030044   0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 4: logL = -578.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.00662001 0.00786567 0.03373165 0.0723664  0.09210655 0.11834156
  0.12709967 0.4418685  0.1       ]
 [0.42426445 0.13625783 0.11265599 0.08314047 0.05365345 0.03545228
  0.02746079 0.02711474 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 5: logL = -575.8
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.0033653  0.00588958 0.0307279  0.07167755 0.09164735 0.1206301
  0.12816752 0.44789471 0.1       ]
 [0.42267545 0.13663942 0.11448618 0.08363898 0.05447658 0.03430262
  0.02758002 0.02620074 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 6: logL = -575.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.00169276 0.00441297 0.02819966 0.07114043 0.090945   0.1223293
  0.12890816 0.45237171 0.1       ]
 [0.42043055 0.13677525 0.11595799 0.08400325 0.05542001 0.03357908
  0.0278215  0.02601238 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 7: logL = -574.6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.99e-01 6.02e-04]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.00083872 0.00327125 0.02606741 0.07077363 0.09017862 0.12363058
  0.12944923 0.45579056 0.1       ]
 [0.41818866 0.13681791 0.11717152 0.0842279  0.05633314 0.03308877
  0.02807408 0.02609803 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 8: logL = -574.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 1.8e-04]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[4.09464264e-04 2.39007898e-03 2.42702084e-02 7.05522828e-02
  8.94333324e-02 1.24646722e-01 1.29836992e-01 4.58460919e-01
  1.00000000e-01]
 [4.16148099e-01 1.36798011e-01 1.18175921e-01 8.43387221e-02
  5.71625611e-02 3.27458755e-02 2.83284570e-02 2.63023540e-02
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 9: logL = -574.2
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.35e-05]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[1.97318895e-04 1.71978574e-03 2.27509060e-02 7.04416062e-02
  8.87502607e-02 1.25451546e-01 1.30099296e-01 4.60589280e-01
  1.00000000e-01]
 [4.14347732e-01 1.36722762e-01 1.19008583e-01 8.43663152e-02
  5.78915211e-02 3.25054628e-02 2.85907375e-02 2.65668866e-02
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 10: logL = -574.1
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.59e-05]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[9.40390174e-05 1.21906188e-03 2.14585901e-02 7.04092132e-02
  8.81458558e-02 1.26096342e-01 1.30260335e-01 4.62316562e-01
  1.00000000e-01]
 [4.12773799e-01 1.36599644e-01 1.19701678e-01 8.43375415e-02
  5.85198384e-02 3.23397064e-02 2.88631922e-02 2.68645999e-02
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 11: logL = -574.0
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.72e-06]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[4.43967633e-05 8.51890532e-04 2.03505907e-02 7.04288591e-02
  8.76220805e-02 1.26618040e-01 1.30342487e-01 4.63741655e-01
  1.00000000e-01]
 [4.11397327e-01 1.36438832e-01 1.20282285e-01 8.42734175e-02
  5.90556056e-02 3.22294951e-02 2.91434331e-02 2.71796047e-02
  1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 12: logL = -573.9
2023-02-22 14:09 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.739e+02
2023-02-22 14:09 - INFO - TrainingManager : 71 -  >> BIC: 1.233e+03
2023-02-22 14:09 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.58 0.42]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12028572 0.0423934  0.04995264 0.05341327 0.06976171 0.06918956
  0.07782403 0.08729442 0.32988525 0.1       ]
 [0.32918724 0.08948778 0.08196659 0.06655358 0.06225722 0.05684159
  0.04825058 0.04481276 0.12064265 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 0: logL = -685.9
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.67 0.33]
A:
[[0.75 0.25]
 [0.24 0.76]]
chi:
[[0.08474056 0.03319899 0.04325195 0.05138621 0.07470097 0.07073494
  0.08377185 0.09334529 0.36486924 0.1       ]
 [0.36351761 0.09839367 0.08846555 0.06850682 0.05740708 0.05536112
  0.04248611 0.0389943  0.08686774 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 1: logL = -625.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.78 0.22]
A:
[[0.79 0.21]
 [0.2  0.8 ]]
chi:
[[0.05055577 0.02332193 0.0355793  0.04911695 0.08028526 0.07296186
  0.09080823 0.09973372 0.39763699 0.1       ]
 [0.39501528 0.10759452 0.09564835 0.07060674 0.05207743 0.05329106
  0.03589779 0.03312274 0.05674608 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 2: logL = -616.9
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.88 0.12]
A:
[[0.82 0.18]
 [0.17 0.83]]
chi:
[[0.026444   0.0154204  0.02876576 0.0470073  0.08474312 0.07531217
  0.09694869 0.10466319 0.42069537 0.1       ]
 [0.41464326 0.11430919 0.10156288 0.07240948 0.04809821 0.0512405
  0.03057519 0.02907232 0.03808897 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 3: logL = -607.5
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.95 0.05]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.01326554 0.01042523 0.02388466 0.04512228 0.086979   0.07690846
  0.10089871 0.10759029 0.43492585 0.1       ]
 [0.42191294 0.11768451 0.10516725 0.07383627 0.04648954 0.05006514
  0.02775422 0.02732106 0.02976907 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 4: logL = -601.6
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.0066303  0.00731892 0.02042942 0.04334834 0.08767013 0.07752048
  0.1032959  0.10935858 0.44442793 0.1       ]
 [0.42235607 0.11903422 0.10718534 0.07504927 0.04641518 0.04987682
  0.02658176 0.0268138  0.02668753 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 5: logL = -599.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.00327173 0.00520116 0.01781341 0.04175209 0.08771674 0.07743065
  0.10494007 0.11061525 0.45125889 0.1       ]
 [0.4203189  0.11955728 0.10844723 0.07607446 0.04686987 0.05028814
  0.02605528 0.02669874 0.0256901  0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 6: logL = -598.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[0.00157972 0.0036733  0.01578144 0.04041459 0.08754978 0.07697251
  0.10617431 0.11158756 0.45626679 0.1       ]
 [0.41773494 0.11976653 0.10932137 0.07689548 0.04740994 0.05094653
  0.0257554  0.0266736  0.02549622 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 7: logL = -597.9
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.91e-04]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[0.0007459  0.00255989 0.0142006  0.03934894 0.08732054 0.07638066
  0.10712218 0.11234858 0.45997273 0.1       ]
 [0.41526861 0.11982583 0.10994926 0.07752141 0.04791057 0.05164717
  0.02556449 0.0266755  0.02563716 0.1       ]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 8: logL = -597.7
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 1.4e-04]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[3.45403244e-04 1.75735372e-03 1.29696104e-02 3.85235724e-02
  8.70790812e-02 7.57886243e-02 1.07845382e-01 1.12937289e-01
  4.62753683e-01 1.00000000e-01]
 [4.13099596e-01 1.19789310e-01 1.10401472e-01 7.79818593e-02
  4.83508323e-02 5.22922954e-02 2.54516997e-02 2.67001803e-02
  2.59327548e-02 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 9: logL = -597.5
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.e+00 4.e-05]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[1.57392585e-04 1.18889816e-03 1.20059284e-02 3.78923092e-02
  8.68430821e-02 7.52587356e-02 1.08389541e-01 1.13385851e-01
  4.64878262e-01 1.00000000e-01]
 [4.11242625e-01 1.19684619e-01 1.10724609e-01 7.83123404e-02
  4.87351659e-02 5.28457898e-02 2.54027344e-02 2.67491416e-02
  2.63029755e-02 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 10: logL = -597.4
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.15e-05]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[7.07806816e-05 7.93540520e-04 1.12449331e-02 3.74104596e-02
  8.66194402e-02 7.48109456e-02 1.08793108e-01 1.13722840e-01
  4.66533953e-01 1.00000000e-01]
 [4.09662092e-01 1.19533113e-01 1.10952742e-01 7.85455308e-02
  4.90718794e-02 5.33034656e-02 2.54048350e-02 2.68205665e-02
  2.67057764e-02 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 11: logL = -597.3
2023-02-22 14:09 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:09 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.32e-06]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[3.14863942e-05 5.23257416e-04 1.06377862e-02 3.70407347e-02
  8.64109163e-02 7.44434451e-02 1.09088319e-01 1.13972818e-01
  4.67851237e-01 1.00000000e-01]
 [4.08312179e-01 1.19352730e-01 1.11111060e-01 7.87080089e-02
  4.93684747e-02 5.36754824e-02 2.54456327e-02 2.69100777e-02
  2.71163556e-02 1.00000000e-01]]

2023-02-22 14:09 - DEBUG - TrainingManager : 134 - 12: logL = -597.3
2023-02-22 14:09 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -5.973e+02
2023-02-22 14:09 - INFO - TrainingManager : 71 -  >> BIC: 1.292e+03
2023-02-22 14:09 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:09 - INFO - cli : 125 - Training phase done in 00:00:01
2023-02-22 14:09 - INFO - cli : 155 - Process done in 00:00:01
2023-02-22 14:09 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_11
