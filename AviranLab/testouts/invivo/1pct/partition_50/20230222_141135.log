2023-02-22 14:11 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/50.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/50.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-02-22 14:11 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: data/Manfredonia_2020/XML/datapartitions/1pct_shape/50.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/data/Manfredonia_2020/XML/datapartitions/1pct_fa/50.fa

Configuration parameters:
	output: testouts/invivo/1pct/partition_50
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-02-22 14:11 - INFO - cli : 50 - Loading input data
2023-02-22 14:11 - INFO - cli : 66 -  ... done in 00:00:00
2023-02-22 14:11 - INFO - cli : 104 - Spawning training set
2023-02-22 14:11 - INFO - Dataset : 102 -  ... sorting
2023-02-22 14:11 - INFO - Dataset : 105 -  ... selecting
2023-02-22 14:11 - INFO - cli : 107 -  ... done in 00:00:00
2023-02-22 14:11 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-02-22 14:11 - INFO - TrainingManager : 104 - Training with k=6
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.28 0.72]
A:
[[0.71 0.29]
 [0.29 0.71]]
chi:
[[0.13502485 0.05453441 0.07122636 0.06711496 0.08412903 0.08743739
  0.09054537 0.30998762 0.1       ]
 [0.31474768 0.09541385 0.08475651 0.07687269 0.07188646 0.06858646
  0.0475091  0.14022724 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 0: logL = -653.5
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.11 0.89]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11759077 0.05132385 0.07673578 0.06543254 0.08661896 0.08554466
  0.09603983 0.32071362 0.1       ]
 [0.33294755 0.09879482 0.07927056 0.07860038 0.06933784 0.07041753
  0.04182465 0.12880668 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 1: logL = -608.9
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.03 0.97]
A:
[[0.74 0.26]
 [0.27 0.73]]
chi:
[[0.09921029 0.04760071 0.08343131 0.06362665 0.08925126 0.08353251
  0.10169452 0.33165275 0.1       ]
 [0.35300955 0.10288281 0.07247284 0.08052112 0.06655019 0.07236986
  0.03572852 0.11646512 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 2: logL = -607.3
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.76 0.24]
 [0.25 0.75]]
chi:
[[0.08172574 0.04365414 0.09099917 0.06189874 0.09187711 0.08146214
  0.10697979 0.34140317 0.1       ]
 [0.37327373 0.10743965 0.06454724 0.08245373 0.06363866 0.07441705
  0.02969493 0.10453501 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 3: logL = -605.3
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.23e-04 9.99e-01]
A:
[[0.78 0.22]
 [0.23 0.77]]
chi:
[[0.06689017 0.03997767 0.09871787 0.06060131 0.09423047 0.07955069
  0.11137485 0.34865698 0.1       ]
 [0.3916997  0.11192504 0.05615656 0.08401796 0.06088775 0.07636507
  0.02432299 0.09462492 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 4: logL = -603.1
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.19e-05 1.00e+00]
A:
[[0.8  0.2 ]
 [0.22 0.78]]
chi:
[[0.05572997 0.03705431 0.10562766 0.06003321 0.09603564 0.07806791
  0.11463186 0.35281945 0.1       ]
 [0.4064859  0.11568416 0.04837851 0.08483041 0.05866277 0.07792719
  0.02007498 0.08795609 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 5: logL = -601.1
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.09e-06 1.00e+00]
A:
[[0.82 0.18]
 [0.21 0.79]]
chi:
[[0.04819507 0.03511184 0.11102471 0.06020791 0.09716577 0.07715555
  0.11687454 0.35426461 0.1       ]
 [0.41682686 0.11827719 0.0421694  0.08479398 0.05720584 0.0789162
  0.01705789 0.08475264 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 6: logL = -599.8
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.4e-07 1.0e+00]
A:
[[0.83 0.17]
 [0.2  0.8 ]]
chi:
[[0.04350839 0.03407072 0.1147907  0.06087223 0.09769226 0.07675781
  0.11841188 0.35389601 0.1       ]
 [0.42307822 0.11966983 0.03784697 0.08414474 0.05650806 0.07935572
  0.01507234 0.08432412 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 7: logL = -599.0
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.24e-09 1.00e+00]
A:
[[0.83 0.17]
 [0.19 0.81]]
chi:
[[0.04075687 0.0336856  0.11723188 0.06172536 0.09778926 0.07670998
  0.11952101 0.35258003 0.1       ]
 [0.42623658 0.12012498 0.03514961 0.08322231 0.0563855  0.079409
  0.01381924 0.08565277 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 8: logL = -598.6
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.72e-10 1.00e+00]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.03922129 0.03370309 0.11875158 0.06256725 0.09762609 0.07684907
  0.12037605 0.35090558 0.1       ]
 [0.42734361 0.11997913 0.03361482 0.08227381 0.05662396 0.07925355
  0.01304303 0.08786809 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 9: logL = -598.4
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.19e-12 1.00e+00]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.03842825 0.03393478 0.11967608 0.06330877 0.09732425 0.07706171
  0.1210696  0.34919656 0.1       ]
 [0.42720329 0.11950579 0.03283217 0.0814194  0.05705671 0.07901691
  0.01256785 0.09039788 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 10: logL = -598.3
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.49e-13 1.00e+00]
A:
[[0.85 0.15]
 [0.17 0.83]]
chi:
[[0.03809037 0.034263   0.12022676 0.06392856 0.09695952 0.07728403
  0.1216485  0.34759926 0.1       ]
 [0.4263535  0.11888504 0.03251007 0.08069518 0.05757534 0.0787713
  0.01228296 0.0929266  0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 11: logL = -598.2
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.11e-15 1.00e+00]
A:
[[0.85 0.15]
 [0.17 0.83]]
chi:
[[0.03803711 0.03462228 0.12054389 0.06443551 0.09657616 0.07748641
  0.12213753 0.34616111 0.1       ]
 [0.42513006 0.11822138 0.03245989 0.08009723 0.05811559 0.07854976
  0.01212017 0.09530592 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 12: logL = -598.2
2023-02-22 14:11 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.982e+02
2023-02-22 14:11 - INFO - TrainingManager : 71 -  >> BIC: 1.282e+03
2023-02-22 14:11 - INFO - TrainingManager : 104 - Training with k=7
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.28 0.72]
A:
[[0.71 0.29]
 [0.29 0.71]]
chi:
[[0.1351208  0.05192655 0.05278611 0.05777501 0.06436784 0.07436223
  0.06670869 0.08711537 0.3098374  0.1       ]
 [0.31471148 0.092036   0.06720043 0.06222084 0.06762911 0.05765338
  0.05330383 0.04492404 0.14032091 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 0: logL = -688.9
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.11 0.89]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11785079 0.04941561 0.05565327 0.06093731 0.06280619 0.07737618
  0.0634218  0.09210894 0.32042991 0.1       ]
 [0.33271237 0.09470309 0.06436958 0.05905776 0.06921059 0.05456402
  0.05656022 0.03975384 0.12906853 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 1: logL = -632.0
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.03 0.97]
A:
[[0.74 0.26]
 [0.27 0.73]]
chi:
[[0.09967171 0.0466018  0.05860723 0.0644627  0.06143025 0.08061112
  0.06023541 0.09718659 0.3311932  0.1       ]
 [0.35248145 0.09783455 0.0614167  0.05546063 0.07064826 0.05113786
  0.05976055 0.03427762 0.11698238 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 2: logL = -630.4
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.76 0.24]
 [0.25 0.75]]
chi:
[[0.08238902 0.04378903 0.06153336 0.06817151 0.06041652 0.08392539
  0.05729306 0.10177069 0.34071141 0.1       ]
 [0.37249865 0.10117784 0.05841409 0.05154843 0.07177484 0.04746026
  0.06279971 0.02900335 0.10532284 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 3: logL = -628.5
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.75e-04 9.99e-01]
A:
[[0.78 0.22]
 [0.24 0.76]]
chi:
[[0.06769131 0.04141916 0.06424595 0.0717784  0.06001977 0.08705447
  0.05487929 0.10530971 0.34760193 0.1       ]
 [0.39113379 0.10429644 0.05551585 0.04756083 0.07231572 0.04376436
  0.06540798 0.02448499 0.09552004 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 4: logL = -626.6
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.23e-05 1.00e+00]
A:
[[0.8  0.2 ]
 [0.22 0.78]]
chi:
[[0.056563   0.03986258 0.06655745 0.07496648 0.06040349 0.08972109
  0.05328546 0.10753509 0.35110536 0.1       ]
 [0.40719945 0.10676327 0.05290676 0.04381065 0.07205379 0.04034074
  0.06726316 0.02107121 0.08859097 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 5: logL = -624.9
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.96e-06 1.00e+00]
A:
[[0.81 0.19]
 [0.21 0.79]]
chi:
[[0.04899286 0.03923003 0.06837833 0.07751952 0.06149279 0.09177188
  0.05262023 0.10856216 0.35143221 0.1       ]
 [0.42031839 0.10836545 0.05070242 0.04055826 0.07100174 0.03740046
  0.06818947 0.01876798 0.08469583 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 6: logL = -623.7
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.66e-07 1.00e+00]
A:
[[0.83 0.17]
 [0.2  0.8 ]]
chi:
[[0.04430708 0.03937852 0.06974076 0.07939081 0.06301261 0.0932189
  0.05275102 0.108731   0.3494693  0.1       ]
 [0.4307613  0.10914722 0.04890786 0.03791901 0.06940185 0.03500489
  0.06825466 0.01734072 0.08326248 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 7: logL = -623.0
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.2e-08 1.0e+00]
A:
[[0.84 0.16]
 [0.2  0.8 ]]
chi:
[[0.04169648 0.04005353 0.070735   0.08066183 0.06465373 0.09417405
  0.05340922 0.108393   0.34622316 0.1       ]
 [0.4390304  0.10930161 0.04746551 0.03587466 0.06757195 0.03310317
  0.06769558 0.01650073 0.0834564  0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 8: logL = -622.6
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.83e-10 1.00e+00]
A:
[[0.84 0.16]
 [0.19 0.81]]
chi:
[[0.04050361 0.0410122  0.0714478  0.08146244 0.06619422 0.09476789
  0.05432378 0.10780891 0.34247915 0.1       ]
 [0.44558277 0.10904882 0.04631308 0.03433964 0.06576779 0.03160528
  0.06678645 0.01601352 0.08454264 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 9: logL = -622.3
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.84e-11 1.00e+00]
A:
[[0.85 0.15]
 [0.19 0.81]]
chi:
[[0.04026849 0.04207406 0.07194407 0.08191777 0.0675225  0.09510809
  0.05529295 0.10714145 0.33873062 0.1       ]
 [0.45075839 0.10857217 0.04540328 0.03321452 0.06413937 0.03042731
  0.06575243 0.01572148 0.08601103 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 10: logL = -622.2
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.89e-13 1.00e+00]
A:
[[0.86 0.14]
 [0.18 0.82]]
chi:
[[0.04068089 0.04312487 0.07227231 0.08212912 0.06860876 0.0952714
  0.05619687 0.10648032 0.33523545 0.1       ]
 [0.45480665 0.10800114 0.04469904 0.0324097  0.06274743 0.0295048
  0.06474169 0.01552967 0.08755988 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 11: logL = -622.0
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.6e-14 1.0e+00]
A:
[[0.86 0.14]
 [0.18 0.82]]
chi:
[[0.0415262  0.04410323 0.07247203 0.0821728  0.06946946 0.09530935
  0.0569812  0.10586869 0.33209704 0.1       ]
 [0.45792537 0.10741576 0.04416639 0.03185098 0.06159542 0.02879092
  0.06383245 0.01538553 0.08903717 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 12: logL = -621.9
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #14
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.01e-15 1.00e+00]
A:
[[0.87 0.13]
 [0.18 0.82]]
chi:
[[0.04264909 0.04498398 0.07257705 0.08210473 0.07014097 0.09525632
  0.05763379 0.10532296 0.32933111 0.1       ]
 [0.46028267 0.10685808 0.04377216 0.03147884 0.06065701 0.02825132
  0.06305307 0.0152626  0.09038426 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 13: logL = -621.9
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #15
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.09e-17 1.00e+00]
A:
[[0.87 0.13]
 [0.17 0.83]]
chi:
[[0.04393332 0.04576357 0.07261603 0.08196547 0.07066397 0.09513608
  0.0581647  0.10484569 0.32691117 0.1       ]
 [0.46202334 0.10634451 0.04348513 0.03124634 0.05989468 0.02785974
  0.06240248 0.01514948 0.09159431 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 14: logL = -621.8
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #16
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.73e-18 1.00e+00]
A:
[[0.88 0.12]
 [0.17 0.83]]
chi:
[[0.04529124 0.04644929 0.07261229 0.08178424 0.07107549 0.09496592
  0.05859272 0.10443319 0.32479563 0.1       ]
 [0.46326891 0.1058767  0.04327785 0.03111712 0.05927061 0.0275952
  0.06186586 0.01504292 0.09268483 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 15: logL = -621.7
2023-02-22 14:11 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #17
2023-02-22 14:11 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.72e-20 1.00e+00]
A:
[[0.88 0.12]
 [0.17 0.83]]
chi:
[[0.0466579  0.0470522  0.07258384 0.08158189 0.07140581 0.0947592
  0.05893762 0.10407952 0.32294202 0.1       ]
 [0.46411761 0.10544952 0.04312783 0.03106343 0.05875199 0.02744023
  0.06142442 0.01494372 0.09368125 0.1       ]]

2023-02-22 14:11 - DEBUG - TrainingManager : 134 - 16: logL = -621.7
2023-02-22 14:11 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -6.217e+02
2023-02-22 14:11 - INFO - TrainingManager : 71 -  >> BIC: 1.340e+03
2023-02-22 14:11 - INFO - TrainingManager : 75 - Optimal k=6
2023-02-22 14:11 - INFO - cli : 125 - Training phase done in 00:00:02
2023-02-22 14:11 - INFO - cli : 155 - Process done in 00:00:02
2023-02-22 14:11 - INFO - cli : 156 - Output written to  -> testouts/invivo/1pct/partition_50
