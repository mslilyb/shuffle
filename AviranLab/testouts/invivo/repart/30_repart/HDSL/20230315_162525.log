2023-03-15 16:25 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/30_repart.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/30_repart.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-03-15 16:25 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/30_repart.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/30_repart.fa

Configuration parameters:
	output: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/30_repart/HDSL
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-03-15 16:25 - INFO - cli : 50 - Loading input data
2023-03-15 16:25 - INFO - cli : 66 -  ... done in 00:00:00
2023-03-15 16:25 - INFO - cli : 104 - Spawning training set
2023-03-15 16:25 - INFO - Dataset : 102 -  ... sorting
2023-03-15 16:25 - INFO - Dataset : 105 -  ... selecting
2023-03-15 16:25 - INFO - cli : 107 -  ... done in 00:00:00
2023-03-15 16:25 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     100
       KL div                     0
2023-03-15 16:25 - INFO - TrainingManager : 104 - Training with k=6
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.28 0.72]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.1221813  0.05409094 0.05985032 0.06505478 0.08077375 0.0927083
  0.09905166 0.32628894 0.1       ]
 [0.32736912 0.10779139 0.08409656 0.07891485 0.06326461 0.0693429
  0.04506662 0.12415395 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 0: logL = -217.0
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.09 0.91]
A:
[[0.75 0.25]
 [0.26 0.74]]
chi:
[[0.08791833 0.04388883 0.05708972 0.06133538 0.08810956 0.09303394
  0.11158377 0.35704047 0.1       ]
 [0.36219061 0.11814066 0.08692213 0.0826731  0.05587764 0.0689565
  0.03238477 0.09285459 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 1: logL = -200.7
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.79 0.21]
 [0.22 0.78]]
chi:
[[0.05627783 0.03131802 0.05381131 0.05736338 0.09635309 0.09347868
  0.12481586 0.38658183 0.1       ]
 [0.39451418 0.1309152  0.09027407 0.08670533 0.04753259 0.06846274
  0.01893622 0.06265968 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 2: logL = -197.9
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.74e-04 9.99e-01]
A:
[[0.83 0.17]
 [0.19 0.81]]
chi:
[[0.03507644 0.01886323 0.05125542 0.05308983 0.10291254 0.09391771
  0.13543687 0.40944796 0.1       ]
 [0.41439636 0.14296429 0.092687   0.09085768 0.04117327 0.06811815
  0.00873922 0.04106404 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 3: logL = -194.7
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.57e-05 1.00e+00]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.02391464 0.00982773 0.05037934 0.04848698 0.10622644 0.09449531
  0.14188801 0.42478154 0.1       ]
 [0.42242374 0.15087627 0.09322696 0.09508486 0.0383968  0.06775043
  0.0033846  0.02885634 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 4: logL = -192.4
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.01e-07 1.00e+00]
A:
[[0.85 0.15]
 [0.16 0.84]]
chi:
[[0.01849574 0.0047043  0.0507949  0.04376135 0.10726625 0.09536348
  0.14516811 0.43444587 0.1       ]
 [0.42479963 0.15481859 0.09251663 0.09932182 0.03787874 0.06710286
  0.00120746 0.02235427 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 5: logL = -191.4
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.82e-09 1.00e+00]
A:
[[0.85 0.15]
 [0.16 0.84]]
chi:
[[1.56403466e-02 2.12014311e-03 5.16038480e-02 3.94087509e-02
  1.07405817e-01 9.64501886e-02 1.46746956e-01 4.40623950e-01
  1.00000000e-01]
 [4.25485610e-01 1.56536408e-01 9.15316285e-02 1.03209817e-01
  3.80949148e-02 6.62046924e-02 4.21313332e-04 1.85156158e-02
  1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 6: logL = -191.0
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.37e-11 1.00e+00]
A:
[[0.85 0.15]
 [0.16 0.84]]
chi:
[[1.38782092e-02 9.05443849e-04 5.22926698e-02 3.58131438e-02
  1.07283055e-01 9.75941733e-02 1.47494665e-01 4.44738640e-01
  1.00000000e-01]
 [4.25936465e-01 1.57230487e-01 9.07565729e-02 1.06441063e-01
  3.84191348e-02 6.52063933e-02 1.47487796e-04 1.58623950e-02
  1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 7: logL = -190.8
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.12e-14 1.00e+00]
A:
[[0.84 0.16]
 [0.16 0.84]]
chi:
[[1.26293768e-02 3.70613277e-04 5.27481700e-02 3.30416468e-02
  1.07105126e-01 9.86622915e-02 1.47835785e-01 4.47606991e-01
  1.00000000e-01]
 [4.26482719e-01 1.57495646e-01 9.02648192e-02 1.08961020e-01
  3.86946584e-02 6.42432261e-02 5.21950974e-05 1.38057163e-02
  1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 8: logL = -190.7
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.55e-16 1.00e+00]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[1.16610773e-02 1.47337372e-04 5.30191600e-02 3.09714301e-02
  1.06931673e-01 9.95902383e-02 1.47976524e-01 4.49702561e-01
  1.00000000e-01]
 [4.27120540e-01 1.57601042e-01 8.99827365e-02 1.10871091e-01
  3.89052019e-02 6.33873254e-02 1.86859058e-05 1.21133760e-02
  1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 9: logL = -190.6
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.15e-18 1.00e+00]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[1.08686971e-02 5.74979139e-05 5.31788397e-02 2.94374288e-02
  1.06776240e-01 1.00367526e-01 1.48016677e-01 4.51297093e-01
  1.00000000e-01]
 [4.27797695e-01 1.57658352e-01 8.98249881e-02 1.12309806e-01
  3.90644078e-02 6.26575640e-02 6.75716305e-06 1.06804292e-02
  1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 10: logL = -190.6
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.67e-20 1.00e+00]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[1.01984516e-02 2.21867851e-05 5.32824736e-02 2.82970054e-02
  1.06638603e-01 1.01009552e-01 1.48004425e-01 4.52547302e-01
  1.00000000e-01]
 [4.28477393e-01 1.57708732e-01 8.97307543e-02 1.13399010e-01
  3.91875149e-02 6.20453344e-02 2.46357495e-06 9.44879861e-03
  1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 11: logL = -190.5
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.37e-23 1.00e+00]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[9.61930569e-03 8.50512156e-06 5.33635821e-02 2.74427973e-02
  1.06515427e-01 1.01539065e-01 1.47963677e-01 4.53547640e-01
  1.00000000e-01]
 [4.29139872e-01 1.57764510e-01 8.96637742e-02 1.14231741e-01
  3.92859496e-02 6.15328784e-02 9.04011801e-07 8.38037146e-03
  1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 12: logL = -190.5
2023-03-15 16:25 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -1.905e+02
2023-03-15 16:25 - INFO - TrainingManager : 71 -  >> BIC: 4.501e+02
2023-03-15 16:25 - INFO - TrainingManager : 104 - Training with k=7
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.28 0.72]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12264971 0.04095191 0.04649934 0.05484283 0.07262692 0.07602849
  0.07196401 0.08860527 0.32583152 0.1       ]
 [0.32734891 0.08504779 0.07950044 0.07115705 0.07137309 0.04997168
  0.05403611 0.03739508 0.12416985 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 0: logL = -228.7
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.09 0.91]
A:
[[0.76 0.24]
 [0.25 0.75]]
chi:
[[0.08845638 0.03271718 0.03837527 0.05010604 0.07435134 0.08829433
  0.0687604  0.10143505 0.35750401 0.1       ]
 [0.36222773 0.09343454 0.08774811 0.07595856 0.06963687 0.03757894
  0.05721074 0.02437238 0.09183212 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 1: logL = -208.2
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.8  0.2 ]
 [0.21 0.79]]
chi:
[[0.05656369 0.02307317 0.02852165 0.04307941 0.07697903 0.1038272
  0.06332017 0.1146558  0.38997988 0.1       ]
 [0.39390922 0.10303893 0.09757515 0.08297652 0.06700699 0.02205817
  0.06267894 0.01119917 0.05955692 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 2: logL = -204.7
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.09e-04 9.99e-01]
A:
[[0.84 0.16]
 [0.18 0.82]]
chi:
[[0.03551181 0.0148826  0.01963824 0.03504029 0.07981029 0.11728492
  0.05636079 0.12399266 0.4174784  0.1       ]
 [0.41078629 0.11017736 0.10551463 0.09041348 0.0643423  0.00977561
  0.0695095  0.00319891 0.03628191 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 3: logL = -200.3
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.24e-05 1.00e+00]
A:
[[0.85 0.15]
 [0.16 0.84]]
chi:
[[0.02511554 0.01022935 0.01457866 0.02898086 0.08172113 0.12498803
  0.0503874  0.12827743 0.43572159 0.1       ]
 [0.41602168 0.11343083 0.10927436 0.09551075 0.0627099  0.00376049
  0.07505336 0.00061694 0.02362169 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 4: logL = -197.2
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.47e-07 1.00e+00]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[2.05059964e-02 7.67937854e-03 1.27499943e-02 2.53010293e-02
  8.23633247e-02 1.28587363e-01 4.67744016e-02 1.29936413e-01
  4.46102099e-01 1.00000000e-01]
 [4.17168596e-01 1.14986298e-01 1.10221302e-01 9.84267516e-02
  6.22613010e-02 1.36576472e-03 7.82476376e-02 9.80261209e-05
  1.72243236e-02 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 5: logL = -196.1
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.37e-09 1.00e+00]
A:
[[0.85 0.15]
 [0.16 0.84]]
chi:
[[1.81937563e-02 5.84122285e-03 1.24638447e-02 2.27855646e-02
  8.22176159e-02 1.30285575e-01 4.49435379e-02 1.30781187e-01
  4.52487695e-01 1.00000000e-01]
 [4.17173909e-01 1.16114575e-01 1.09960529e-01 1.00369110e-01
  6.25053196e-02 4.75137268e-04 7.97788982e-02 1.45917645e-05
  1.36079312e-02 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 6: logL = -195.8
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.14e-11 1.00e+00]
A:
[[0.85 0.15]
 [0.16 0.84]]
chi:
[[1.67855628e-02 4.31924727e-03 1.27836165e-02 2.07939619e-02
  8.17283550e-02 1.31187655e-01 4.40712650e-02 1.31359977e-01
  4.56970360e-01 1.00000000e-01]
 [4.16882218e-01 1.17077869e-01 1.09277440e-01 1.01895421e-01
  6.30347315e-02 1.60945100e-04 8.04439760e-02 2.14010161e-06
  1.12252602e-02 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 7: logL = -195.6
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.97e-14 1.00e+00]
A:
[[0.84 0.16]
 [0.16 0.84]]
chi:
[[1.58050653e-02 3.06816296e-03 1.33055246e-02 1.91469274e-02
  8.11411800e-02 1.31735154e-01 4.36602445e-02 1.31793459e-01
  4.60344283e-01 1.00000000e-01]
 [4.16576575e-01 1.17884388e-01 1.08509216e-01 1.03159775e-01
  6.36286886e-02 5.37084686e-05 8.07109647e-02 3.14195831e-07
  9.47637041e-03 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 8: logL = -195.6
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.75e-16 1.00e+00]
A:
[[0.84 0.16]
 [0.16 0.84]]
chi:
[[1.50734191e-02 2.09280564e-03 1.38568196e-02 1.78047717e-02
  8.05803914e-02 1.32092083e-01 4.34612164e-02 1.32111503e-01
  4.62926990e-01 1.00000000e-01]
 [4.16362716e-01 1.18521154e-01 1.07797436e-01 1.04198602e-01
  6.41783749e-02 1.77485652e-05 8.08109636e-02 4.63549206e-08
  8.11295882e-03 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 9: logL = -195.5
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.91e-18 1.00e+00]
A:
[[0.84 0.16]
 [0.16 0.84]]
chi:
[[1.45083768e-02 1.37633878e-03 1.43657597e-02 1.67462205e-02
  8.01035374e-02 1.32323761e-01 4.33580591e-02 1.32330156e-01
  4.64887790e-01 1.00000000e-01]
 [4.16272767e-01 1.18997137e-01 1.07193710e-01 1.05030596e-01
  6.46363530e-02 5.81820077e-06 8.08485410e-02 6.87268722e-09
  7.01507174e-03 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 10: logL = -195.5
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.47e-20 1.00e+00]
A:
[[0.84 0.16]
 [0.16 0.84]]
chi:
[[1.40638375e-02 8.77860403e-04 1.48081380e-02 1.59404822e-02
  7.97287087e-02 1.32463549e-01 4.33012221e-02 1.32465635e-01
  4.66350566e-01 1.00000000e-01]
 [4.16302908e-01 1.19340012e-01 1.06706320e-01 1.05679370e-01
  6.49906545e-02 1.89281759e-06 8.08652794e-02 1.02280584e-09
  6.11356286e-03 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 11: logL = -195.4
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.4e-22 1.0e+00]
A:
[[0.84 0.16]
 [0.16 0.84]]
chi:
[[1.37102132e-02 5.46454132e-04 1.51821248e-02 1.53483139e-02
  7.94512020e-02 1.32534198e-01 4.32726088e-02 1.32534872e-01
  4.67420013e-01 1.00000000e-01]
 [4.16432818e-01 1.19584175e-01 1.06323961e-01 1.06173391e-01
  6.52490604e-02 6.11177948e-07 8.08734152e-02 1.52583874e-10
  5.36256812e-03 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 12: logL = -195.4
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #14
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.63e-24 1.00e+00]
A:
[[0.84 0.16]
 [0.16 0.84]]
chi:
[[1.34269658e-02 3.33912509e-04 1.54952471e-02 1.49287132e-02
  7.92553024e-02 1.32553566e-01 4.32672235e-02 1.32553782e-01
  4.68185287e-01 1.00000000e-01]
 [4.16637330e-01 1.19761306e-01 1.06028565e-01 1.06541717e-01
  6.54283365e-02 1.95886779e-07 8.08734337e-02 2.27903823e-11
  4.72911608e-03 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 13: logL = -195.4
2023-03-15 16:25 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -1.954e+02
2023-03-15 16:25 - INFO - TrainingManager : 71 -  >> BIC: 4.691e+02
2023-03-15 16:25 - INFO - TrainingManager : 75 - Optimal k=6
2023-03-15 16:25 - INFO - cli : 125 - Training phase done in 00:00:01
2023-03-15 16:25 - INFO - cli : 155 - Process done in 00:00:01
2023-03-15 16:25 - INFO - cli : 156 - Output written to  -> /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/30_repart/HDSL
