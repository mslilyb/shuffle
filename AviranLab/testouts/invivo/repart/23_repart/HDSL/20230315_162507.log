2023-03-15 16:25 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/23_repart.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/23_repart.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-03-15 16:25 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/23_repart.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/23_repart.fa

Configuration parameters:
	output: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/23_repart/HDSL
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-03-15 16:25 - INFO - cli : 50 - Loading input data
2023-03-15 16:25 - INFO - cli : 66 -  ... done in 00:00:00
2023-03-15 16:25 - INFO - cli : 104 - Spawning training set
2023-03-15 16:25 - INFO - Dataset : 102 -  ... sorting
2023-03-15 16:25 - INFO - Dataset : 105 -  ... selecting
2023-03-15 16:25 - INFO - cli : 107 -  ... done in 00:00:00
2023-03-15 16:25 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     89
       KL div                     0
2023-03-15 16:25 - INFO - TrainingManager : 104 - Training with k=6
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.69 0.31]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.1256322  0.04748909 0.05514042 0.06484571 0.09147269 0.08706675
  0.10711526 0.3212379  0.1       ]
 [0.3395941  0.09409653 0.08644106 0.07673053 0.07031936 0.05449749
  0.05466834 0.12365259 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 0: logL = -193.1
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.88 0.12]
A:
[[0.75 0.25]
 [0.24 0.76]]
chi:
[[0.09071599 0.0382169  0.04762496 0.06080075 0.10045008 0.09430694
  0.11625123 0.35163315 0.1       ]
 [0.37499271 0.10348014 0.09403626 0.08081031 0.06127323 0.04717654
  0.04541192 0.0928189  0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 1: logL = -178.0
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.78 0.22]
 [0.2  0.8 ]]
chi:
[[0.05895253 0.02659318 0.03895996 0.05538572 0.10982532 0.10226296
  0.12636839 0.38165194 0.1       ]
 [0.40718342 0.11522608 0.1027904  0.08627313 0.05181126 0.0391347
  0.03517602 0.06240499 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 2: logL = -175.4
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.81 0.19]
 [0.17 0.83]]
chi:
[[0.0383792  0.01527294 0.03117135 0.04960122 0.11658171 0.10931198
  0.13464253 0.40503906 0.1       ]
 [0.4263589  0.12617706 0.11031388 0.09192486 0.04529513 0.03234644
  0.02727434 0.0403094  0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 3: logL = -172.5
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.27e-05]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.02829302 0.00735183 0.0258729  0.04472971 0.11968461 0.11394183
  0.13942788 0.42069822 0.1       ]
 [0.43346941 0.13316357 0.1149513  0.09640888 0.04275981 0.02835073
  0.02334571 0.02755059 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 4: logL = -170.6
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 9.71e-07]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[0.02371341 0.00318076 0.02304834 0.04126602 0.12058712 0.11654743
  0.14145553 0.43020139 0.1       ]
 [0.4356647  0.13651807 0.11720127 0.09948863 0.04231089 0.02629422
  0.022021   0.02050122 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 5: logL = -169.8
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.23e-08]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[0.02135336 0.00131787 0.02184809 0.03899983 0.12067001 0.11812317
  0.14202603 0.43566165 0.1       ]
 [0.43697756 0.13800644 0.11814079 0.10154426 0.04241515 0.02498217
  0.02175043 0.0161832  0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 6: logL = -169.5
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 1.2e-10]
A:
[[0.83 0.17]
 [0.14 0.86]]
chi:
[[0.01987112 0.000541   0.02153146 0.03754718 0.12050768 0.11920416
  0.14198297 0.43881442 0.1       ]
 [0.43839535 0.13875272 0.11844336 0.10294731 0.04257529 0.02393992
  0.02179683 0.01314923 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 7: logL = -169.4
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 9.6e-13]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[1.87902212e-02 2.23115262e-04 2.16626398e-02 3.66061860e-02
  1.20287752e-01 1.19998919e-01 1.41723504e-01 4.40707663e-01
  1.00000000e-01]
 [4.39948941e-01 1.39227882e-01 1.18433103e-01 1.03938951e-01
  4.26945332e-02 2.30540672e-02 2.19034133e-02 1.07991087e-02
  1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 8: logL = -169.3
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 6.34e-15]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[1.79370579e-02 9.28504300e-05 2.20077912e-02 3.59829025e-02
  1.20070975e-01 1.20598054e-01 1.41410265e-01 4.41900103e-01
  1.00000000e-01]
 [4.41517657e-01 1.39598346e-01 1.18266772e-01 1.04663673e-01
  4.27695236e-02 2.23009432e-02 2.19982768e-02 8.88480976e-03
  1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 9: logL = -169.3
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.47e-17]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[1.72391374e-02 3.90177848e-05 2.24400776e-02 3.55592324e-02
  1.19876964e-01 1.21053815e-01 1.41105685e-01 4.42686071e-01
  1.00000000e-01]
 [4.43004866e-01 1.39916154e-01 1.18027364e-01 1.05208220e-01
  4.28121438e-02 2.16687373e-02 2.20688841e-02 7.29363067e-03
  1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 10: logL = -169.2
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.57e-19]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[1.66590762e-02 1.65449849e-05 2.28892530e-02 3.52635696e-02
  1.19710696e-01 1.21402612e-01 1.40832181e-01 4.43226067e-01
  1.00000000e-01]
 [4.44355569e-01 1.40195040e-01 1.17762350e-01 1.05626086e-01
  4.28337057e-02 2.11441564e-02 2.21185478e-02 5.96454575e-03
  1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 11: logL = -169.2
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.85e-22]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[1.61732034e-02 7.07145977e-06 2.33169696e-02 3.50519659e-02
  1.19571583e-01 1.21671329e-01 1.40596197e-01 4.43611680e-01
  1.00000000e-01]
 [4.45546033e-01 1.40437833e-01 1.17499463e-01 1.05951507e-01
  4.28425610e-02 2.07127403e-02 2.21530515e-02 4.85681201e-03
  1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 12: logL = -169.2
2023-03-15 16:25 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -1.692e+02
2023-03-15 16:25 - INFO - TrainingManager : 71 -  >> BIC: 4.057e+02
2023-03-15 16:25 - INFO - TrainingManager : 104 - Training with k=7
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.7 0.3]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12494052 0.03861469 0.04203759 0.05791605 0.06866531 0.07477137
  0.07239846 0.09913691 0.3215191  0.1       ]
 [0.34014414 0.08271644 0.0792962  0.06343011 0.07290607 0.04658793
  0.04895899 0.04245822 0.1235019  0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 0: logL = -203.4
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.9 0.1]
A:
[[0.75 0.25]
 [0.24 0.76]]
chi:
[[0.08799401 0.02799141 0.03089961 0.06046774 0.06454453 0.08729703
  0.07489816 0.11295451 0.35295301 0.1       ]
 [0.37783335 0.09350582 0.09058437 0.06088152 0.07705695 0.03392998
  0.04638535 0.02842639 0.09139628 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 1: logL = -184.3
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.8  0.2 ]
 [0.19 0.81]]
chi:
[[0.05442521 0.01531209 0.01906216 0.06374897 0.05855046 0.10048703
  0.07812972 0.1267624  0.38352197 0.1       ]
 [0.41361926 0.10676848 0.10295788 0.05754971 0.08322009 0.02021861
  0.04293682 0.01390705 0.0588221  0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 2: logL = -180.6
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.99e-01 6.84e-04]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.03439333 0.00575003 0.01036997 0.0676614  0.0535642  0.10915494
  0.08042383 0.13475406 0.40392823 0.1       ]
 [0.43761074 0.1174926  0.11271331 0.05344592 0.08860282 0.01052129
  0.04024332 0.00461276 0.03475723 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 3: logL = -176.2
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 1.2e-05]
A:
[[0.85 0.15]
 [0.14 0.86]]
chi:
[[0.02579254 0.00157841 0.00571949 0.07118627 0.05156618 0.11287621
  0.08067477 0.13667562 0.4139305  0.1       ]
 [0.45112772 0.12312825 0.11875183 0.04956466 0.09109912 0.00550552
  0.03953693 0.00115301 0.02013296 0.1       ]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 4: logL = -173.5
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.01e-07]
A:
[[0.85 0.15]
 [0.14 0.86]]
chi:
[[2.21361523e-02 3.63712002e-04 3.41962166e-03 7.37277677e-02
  5.11320931e-02 1.14467918e-01 8.01556560e-02 1.36238938e-01
  4.18358142e-01 1.00000000e-01]
 [4.59382691e-01 1.25670290e-01 1.22376958e-01 4.66063753e-02
  9.19679478e-02 2.70100904e-03 3.96790863e-02 2.48914056e-04
  1.13667279e-02 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 5: logL = -172.5
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.56e-10]
A:
[[0.85 0.15]
 [0.14 0.86]]
chi:
[[2.02555894e-02 7.76262881e-05 2.19440184e-03 7.54192042e-02
  5.11109399e-02 1.15167300e-01 7.97700400e-02 1.35534436e-01
  4.20470463e-01 1.00000000e-01]
 [4.64552018e-01 1.26875486e-01 1.24562922e-01 4.45652863e-02
  9.22819610e-02 1.14074145e-03 3.98120255e-02 4.98226734e-05
  6.15973616e-03 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 6: logL = -172.0
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.11e-12]
A:
[[0.85 0.15]
 [0.14 0.86]]
chi:
[[1.91361014e-02 1.60261795e-05 1.47218809e-03 7.65282029e-02
  5.11679535e-02 1.15405494e-01 7.95900853e-02 1.35073506e-01
  4.21610442e-01 1.00000000e-01]
 [4.67580704e-01 1.27455918e-01 1.25852752e-01 4.32195958e-02
  9.23856361e-02 4.17518878e-04 3.98486067e-02 9.55330794e-06
  3.22971455e-03 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 7: logL = -171.8
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.42e-15]
A:
[[0.85 0.15]
 [0.14 0.86]]
chi:
[[1.84271917e-02 3.25285455e-06 1.01390838e-03 7.72387229e-02
  5.12306067e-02 1.15452165e-01 7.95167870e-02 1.34838750e-01
  4.22278615e-01 1.00000000e-01]
 [4.69251290e-01 1.27722150e-01 1.26605265e-01 4.23684986e-02
  9.23979388e-02 1.38460571e-04 3.98509883e-02 1.78592532e-06
  1.66362364e-03 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 8: logL = -171.7
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 9.39e-19]
A:
[[0.85 0.15]
 [0.14 0.86]]
chi:
[[1.79653156e-02 6.53575788e-07 7.09340846e-04 7.76736122e-02
  5.12830464e-02 1.15450331e-01 7.94870248e-02 1.34737467e-01
  4.22693208e-01 1.00000000e-01]
 [4.70142235e-01 1.27832597e-01 1.27048163e-01 4.18577581e-02
  9.23745670e-02 4.33684958e-05 3.98505234e-02 3.28965977e-07
  8.50458552e-04 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 9: logL = -171.6
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.17e-22]
A:
[[0.85 0.15]
 [0.14 0.86]]
chi:
[[1.76578028e-02 1.30467358e-07 5.00965513e-04 7.79233014e-02
  5.13233295e-02 1.15449139e-01 7.94751248e-02 1.34704498e-01
  4.22965708e-01 1.00000000e-01]
 [4.70606226e-01 1.27868072e-01 1.27313418e-01 4.15714610e-02
  9.23411723e-02 1.31856035e-05 3.98528823e-02 6.00906667e-08
  4.33522716e-04 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 10: logL = -171.6
2023-03-15 16:25 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-03-15 16:25 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.46e-26]
A:
[[0.85 0.15]
 [0.14 0.86]]
chi:
[[1.74491882e-02 2.59321614e-08 3.55760040e-04 7.80542383e-02
  5.13534692e-02 1.15456812e-01 7.94713617e-02 1.34703767e-01
  4.23155377e-01 1.00000000e-01]
 [4.70840149e-01 1.27869003e-01 1.27475037e-01 4.14262204e-02
  9.23080550e-02 3.95164006e-06 3.98567972e-02 1.09265109e-08
  2.20775807e-04 1.00000000e-01]]

2023-03-15 16:25 - DEBUG - TrainingManager : 134 - 11: logL = -171.6
2023-03-15 16:25 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -1.716e+02
2023-03-15 16:25 - INFO - TrainingManager : 71 -  >> BIC: 4.195e+02
2023-03-15 16:25 - INFO - TrainingManager : 75 - Optimal k=6
2023-03-15 16:25 - INFO - cli : 125 - Training phase done in 00:00:01
2023-03-15 16:25 - INFO - cli : 155 - Process done in 00:00:01
2023-03-15 16:25 - INFO - cli : 156 - Output written to  -> /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/23_repart/HDSL
