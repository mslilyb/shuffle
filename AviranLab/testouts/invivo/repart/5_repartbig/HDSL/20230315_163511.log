2023-03-15 16:35 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/5_repart.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/5_repart.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-03-15 16:35 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/5_repart.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/5_repart.fa

Configuration parameters:
	output: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/5_repartbig/HDSL
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-03-15 16:35 - INFO - cli : 50 - Loading input data
2023-03-15 16:35 - INFO - cli : 66 -  ... done in 00:00:00
2023-03-15 16:35 - INFO - cli : 104 - Spawning training set
2023-03-15 16:35 - INFO - Dataset : 102 -  ... sorting
2023-03-15 16:35 - INFO - Dataset : 105 -  ... selecting
2023-03-15 16:35 - INFO - cli : 107 -  ... done in 00:00:00
2023-03-15 16:35 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     300
       KL div                     0
2023-03-15 16:35 - INFO - TrainingManager : 104 - Training with k=6
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.69 0.31]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.1174855  0.04865542 0.06094556 0.07145027 0.08016745 0.08952907
  0.1007776  0.33098914 0.1       ]
 [0.33251439 0.10134456 0.08905442 0.07854972 0.06983256 0.06047095
  0.04922243 0.11901097 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 0: logL = -650.2
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.88 0.12]
A:
[[0.76 0.24]
 [0.24 0.76]]
chi:
[[0.07880387 0.03737991 0.05602682 0.07150316 0.08224492 0.09428547
  0.11163889 0.36811695 0.1       ]
 [0.37122823 0.11262835 0.09397734 0.07849761 0.06775349 0.05571029
  0.03835306 0.08185163 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 1: logL = -600.9
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.81 0.19]
 [0.19 0.81]]
chi:
[[0.04370373 0.02516849 0.04993739 0.07195026 0.08473865 0.09909541
  0.12223055 0.4031755  0.1       ]
 [0.40613211 0.12478639 0.10003991 0.07804697 0.06527016 0.05092641
  0.02781222 0.04698583 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 2: logL = -590.2
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.02177113 0.01604848 0.04469956 0.07325633 0.08710751 0.10235301
  0.1285697  0.42619428 0.1       ]
 [0.42759159 0.13376666 0.10520543 0.0767382  0.06293045 0.04773277
  0.02159828 0.02443662 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 3: logL = -578.2
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.02e-05]
A:
[[0.86 0.14]
 [0.13 0.87]]
chi:
[[0.0115134  0.01130834 0.04210341 0.07501349 0.08858026 0.10363756
  0.13043186 0.43741168 0.1       ]
 [0.43785572 0.13850345 0.10779938 0.07498655 0.06145987 0.04644707
  0.01973194 0.01321602 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 4: logL = -571.1
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.37e-06]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[0.00687802 0.00904547 0.04151142 0.07634301 0.08925206 0.10383081
  0.13030327 0.44283594 0.1       ]
 [0.44261049 0.14079987 0.10841005 0.07366014 0.06078136 0.0462368
  0.01982641 0.00767488 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 5: logL = -568.8
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.58e-08]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[0.00446667 0.00780296 0.04169185 0.07704197 0.08958945 0.10362911
  0.1298659  0.4459121  0.1       ]
 [0.44496573 0.14202409 0.10822242 0.07296329 0.0604481  0.04644458
  0.02027531 0.00465647 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 6: logL = -568.0
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 9.61e-10]
A:
[[0.86 0.14]
 [0.13 0.87]]
chi:
[[0.00302398 0.00700434 0.04203194 0.07729755 0.089818   0.10333162
  0.12961698 0.44787559 0.1       ]
 [0.44621967 0.14276397 0.10785573 0.07271028 0.06023249 0.04676492
  0.02056912 0.00288382 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 7: logL = -567.6
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.65e-11]
A:
[[0.86 0.14]
 [0.13 0.87]]
chi:
[[0.00208634 0.00643808 0.04233879 0.07730797 0.089998   0.10304503
  0.12957298 0.44921281 0.1       ]
 [0.44690449 0.14325152 0.10751335 0.07270247 0.0600699  0.04708193
  0.02067408 0.00180224 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 8: logL = -567.4
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 7.4e-13]
A:
[[0.86 0.14]
 [0.13 0.87]]
chi:
[[0.00145112 0.00601465 0.04257391 0.07720269 0.09014127 0.10280147
  0.12965148 0.45016341 0.1       ]
 [0.44726395 0.14358883 0.10723971 0.07280997 0.05994576 0.04735833
  0.02066265 0.0011308  0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 9: logL = -567.3
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.08e-14]
A:
[[0.86 0.14]
 [0.13 0.87]]
chi:
[[0.00101227 0.00568819 0.04274282 0.07705499 0.0902515  0.10260568
  0.12978255 0.450862   0.1       ]
 [0.44742802 0.14382916 0.10703256 0.07295932 0.0598547  0.04758655
  0.02059892 0.00071076 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 10: logL = -567.2
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.85e-16]
A:
[[0.86 0.14]
 [0.13 0.87]]
chi:
[[7.06444340e-04 5.43143865e-03 4.28599547e-02 7.69030743e-02
  9.03328783e-02 1.02452943e-01 1.29924091e-01 4.51389176e-01
  1.00000000e-01]
 [4.47474272e-01 1.44004279e-01 1.06879352e-01 7.31123618e-02
  5.97914893e-02 4.77697326e-02 2.05214081e-02 4.47105991e-04
  1.00000000e-01]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 11: logL = -567.1
2023-03-15 16:35 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -5.671e+02
2023-03-15 16:35 - INFO - TrainingManager : 71 -  >> BIC: 1.220e+03
2023-03-15 16:35 - INFO - TrainingManager : 104 - Training with k=7
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.7 0.3]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11689491 0.04134171 0.04793541 0.0565225  0.0673255  0.06800196
  0.08066231 0.08938612 0.33192958 0.1       ]
 [0.33308556 0.09065384 0.07806187 0.06947633 0.06467474 0.05799894
  0.04534088 0.0426181  0.11808974 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 0: logL = -685.3
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.89 0.11]
A:
[[0.76 0.24]
 [0.23 0.77]]
chi:
[[0.07729454 0.03045621 0.04122574 0.05478839 0.06956864 0.06728582
  0.08978505 0.09886064 0.37073497 0.1       ]
 [0.3724597  0.10148465 0.08473803 0.07119795 0.0624373  0.05872131
  0.03625952 0.03319404 0.07950751 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 1: logL = -623.1
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.81 0.19]
 [0.18 0.82]]
chi:
[[0.04184354 0.01925468 0.03277488 0.05303421 0.07318916 0.06646518
  0.09894597 0.10769102 0.40680137 0.1       ]
 [0.40714206 0.11248642 0.09305772 0.07291059 0.05885066 0.05955401
  0.02725312 0.02453988 0.04420553 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 2: logL = -611.0
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1. 0.]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[0.02086319 0.01196911 0.02524635 0.05227843 0.07769097 0.06654207
  0.10500444 0.11190814 0.42849729 0.1       ]
 [0.42784202 0.11968818 0.10051419 0.07365356 0.05438319 0.05948039
  0.02126198 0.02038304 0.02279344 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 3: logL = -597.9
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.48e-05]
A:
[[0.86 0.14]
 [0.13 0.87]]
chi:
[[0.01190429 0.00878288 0.02102682 0.05257378 0.0812941  0.06741029
  0.10767571 0.11190539 0.43742675 0.1       ]
 [0.43783057 0.12314592 0.10492096 0.07341325 0.05072493 0.0585952
  0.01837988 0.02015173 0.01283756 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 4: logL = -591.0
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.44e-06]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[0.00818278 0.00745974 0.01957452 0.05312641 0.08328255 0.06815238
  0.10867774 0.11059409 0.44094978 0.1       ]
 [0.44281136 0.12480867 0.10662459 0.07291886 0.0486382  0.05782399
  0.01711283 0.02120144 0.00806006 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 5: logL = -589.0
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.81e-08]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[0.00632251 0.00680751 0.0195117  0.05359759 0.08418321 0.06856744
  0.1090274  0.10945702 0.44252563 0.1       ]
 [0.44579384 0.12576536 0.10690918 0.07249341 0.04764081 0.05737868
  0.01652715 0.0221224  0.00536917 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 6: logL = -588.4
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 1.7e-09]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[0.00519259 0.00642308 0.01997625 0.0539778  0.08454628 0.06878661
  0.10910452 0.10874689 0.44324597 0.1       ]
 [0.44792909 0.12642302 0.10663477 0.07215033 0.04719033 0.05713121
  0.0162407  0.02264602 0.00365452 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 7: logL = -588.2
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 6.31e-11]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[0.00441227 0.00617179 0.02056335 0.05430228 0.08466984 0.06891973
  0.10906231 0.10836297 0.44353545 0.1       ]
 [0.44959273 0.12691446 0.10620713 0.07185563 0.04699118 0.05697279
  0.01610138 0.02286788 0.00249681 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 8: logL = -588.1
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 2.4e-12]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[0.00383089 0.00600013 0.0211056  0.0545883  0.08468978 0.06901808
  0.10897325 0.1081822  0.44361177 0.1       ]
 [0.45091159 0.12728644 0.10579273 0.07159207 0.04690946 0.05685287
  0.01604095 0.02291329 0.00170059 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 9: logL = -588.0
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 9.21e-14]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[0.00337668 0.00588118 0.02154693 0.05484034 0.08466455 0.06910052
  0.10887334 0.1081204  0.44359606 0.1       ]
 [0.45194755 0.1275631  0.10544893 0.07135569 0.04688706 0.05675292
  0.0160246  0.02286771 0.00115243 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 10: logL = -587.9
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.56e-15]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[0.00300999 0.0057986  0.02188081 0.05505931 0.0846191  0.06917291
  0.10877929 0.10812661 0.44355337 0.1       ]
 [0.45274874 0.1277631  0.10518587 0.07114668 0.0468979  0.05666695
  0.01603313 0.02278057 0.00077705 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 11: logL = -587.9
2023-03-15 16:35 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -5.879e+02
2023-03-15 16:35 - INFO - TrainingManager : 71 -  >> BIC: 1.273e+03
2023-03-15 16:35 - INFO - TrainingManager : 75 - Optimal k=6
2023-03-15 16:35 - INFO - cli : 125 - Training phase done in 00:00:03
2023-03-15 16:35 - INFO - cli : 155 - Process done in 00:00:03
2023-03-15 16:35 - INFO - cli : 156 - Output written to  -> /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/5_repartbig/HDSL
