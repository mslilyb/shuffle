2023-03-15 16:24 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/19_repart.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/19_repart.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-03-15 16:24 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/19_repart.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/19_repart.fa

Configuration parameters:
	output: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/19_repart/HDSL
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-03-15 16:24 - INFO - cli : 50 - Loading input data
2023-03-15 16:24 - INFO - cli : 66 -  ... done in 00:00:00
2023-03-15 16:24 - INFO - cli : 104 - Spawning training set
2023-03-15 16:24 - INFO - Dataset : 102 -  ... sorting
2023-03-15 16:24 - INFO - Dataset : 105 -  ... selecting
2023-03-15 16:24 - INFO - cli : 107 -  ... done in 00:00:00
2023-03-15 16:24 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     82
       KL div                     0
2023-03-15 16:24 - INFO - TrainingManager : 104 - Training with k=6
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.51 0.49]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11943567 0.05393449 0.04921126 0.07390446 0.08415469 0.0929266
  0.09193789 0.33449493 0.1       ]
 [0.34105619 0.09962432 0.08242356 0.07974134 0.06953576 0.06080205
  0.03988305 0.12693374 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 0: logL = -177.7
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.53 0.47]
A:
[[0.76 0.24]
 [0.24 0.76]]
chi:
[[0.0798859  0.04710845 0.03963773 0.07514905 0.08874288 0.09996938
  0.10438517 0.36512145 0.1       ]
 [0.38213239 0.10675586 0.0922511  0.07852112 0.06483317 0.05352895
  0.02705538 0.09492203 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 1: logL = -163.1
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.54 0.46]
A:
[[0.8 0.2]
 [0.2 0.8]]
chi:
[[0.04624857 0.03845226 0.02895395 0.0770948  0.09293632 0.10804317
  0.11615865 0.39211228 0.1       ]
 [0.41988791 0.11628129 0.10378699 0.0765563  0.06027103 0.04474101
  0.01413953 0.06433594 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 2: logL = -160.4
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.52 0.48]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.02709037 0.03010896 0.02005414 0.07963692 0.09467102 0.11465714
  0.12391156 0.40986989 0.1       ]
 [0.44234823 0.12549353 0.11355881 0.07390479 0.05824516 0.03742745
  0.00538008 0.04364196 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 3: logL = -157.4
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.45 0.55]
A:
[[0.85 0.15]
 [0.16 0.84]]
chi:
[[0.01909994 0.02384748 0.01400799 0.08219985 0.09376889 0.11814577
  0.12797602 0.42095406 0.1       ]
 [0.44907868 0.13161641 0.11946597 0.07127569 0.05931243 0.03410491
  0.00161448 0.03353143 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 4: logL = -155.7
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.33 0.67]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[1.59500425e-02 1.92193921e-02 9.35174159e-03 8.45262285e-02
  9.14839796e-02 1.19551333e-01 1.30616465e-01 4.29300818e-01
  1.00000000e-01]
 [4.47198576e-01 1.35022663e-01 1.22927872e-01 6.90543472e-02
  6.20261225e-02 3.36744807e-02 4.34882509e-04 2.96610560e-02
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 5: logL = -155.1
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.18 0.82]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[1.45008256e-02 1.53852909e-02 5.25066056e-03 8.67154210e-02
  8.86823497e-02 1.20183000e-01 1.32933352e-01 4.36349101e-01
  1.00000000e-01]
 [4.42162148e-01 1.37046387e-01 1.25246590e-01 6.71405135e-02
  6.52128588e-02 3.43411857e-02 1.13353179e-04 2.87369650e-02
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 6: logL = -154.8
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.07 0.93]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[1.36935399e-02 1.20558052e-02 2.26541369e-03 8.87234655e-02
  8.63745053e-02 1.20320617e-01 1.34839683e-01 4.41726970e-01
  1.00000000e-01]
 [4.37345845e-01 1.38634001e-01 1.26527495e-01 6.54802119e-02
  6.77215134e-02 3.53312371e-02 2.94360449e-05 2.89302603e-02
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 7: logL = -154.5
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.02 0.98]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[1.31860487e-02 9.25301352e-03 7.73320516e-04 9.04387054e-02
  8.52448899e-02 1.19934279e-01 1.36094148e-01 4.45075595e-01
  1.00000000e-01]
 [4.34194390e-01 1.40177712e-01 1.26862339e-01 6.40712860e-02
  6.89401579e-02 3.64210605e-02 7.66414089e-06 2.93253907e-02
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 8: logL = -154.3
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[1.28561190e-02 7.00961303e-03 2.29485891e-04 9.18859117e-02
  8.49633078e-02 1.19251975e-01 1.36841351e-01 4.46962237e-01
  1.00000000e-01]
 [4.32373637e-01 1.41597407e-01 1.26729862e-01 6.28619870e-02
  6.92837341e-02 3.74758836e-02 1.99151716e-06 2.96754983e-02
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 9: logL = -154.2
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.56e-04 9.99e-01]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[1.26435461e-02 5.26599114e-03 6.32954578e-05 9.31243793e-02
  8.50091903e-02 1.18531446e-01 1.37303329e-01 4.48058823e-01
  1.00000000e-01]
 [4.31268709e-01 1.42787121e-01 1.26490779e-01 6.18105244e-02
  6.92900650e-02 3.83935483e-02 5.14018134e-07 2.99587386e-02
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 10: logL = -154.1
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.76e-04 1.00e+00]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[1.25092590e-02 3.92990768e-03 1.67664341e-05 9.41866929e-02
  8.51267417e-02 1.17897325e-01 1.37603985e-01 4.48729322e-01
  1.00000000e-01]
 [4.30551786e-01 1.43737396e-01 1.26279746e-01 6.08983634e-02
  6.92137227e-02 3.91363893e-02 1.31566932e-07 3.01824650e-02
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 11: logL = -154.1
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.6e-05 1.0e+00]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[1.24269271e-02 2.91621021e-03 4.33629621e-06 9.50908903e-02
  8.52354501e-02 1.17380387e-01 1.37802945e-01 4.49142855e-01
  1.00000000e-01]
 [4.30074209e-01 1.44480291e-01 1.26124119e-01 6.01148007e-02
  6.91352719e-02 3.97137070e-02 3.34028452e-08 3.03575678e-02
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 12: logL = -154.1
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #14
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.38e-06 1.00e+00]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[1.23790165e-02 2.15369320e-03 1.10521522e-06 9.58522923e-02
  8.53191901e-02 1.16973167e-01 1.37933134e-01 4.49388402e-01
  1.00000000e-01]
 [4.29757566e-01 1.45054781e-01 1.26018234e-01 5.94493475e-02
  6.90726588e-02 4.01527770e-02 8.41891525e-09 3.04946271e-02
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 13: logL = -154.1
2023-03-15 16:24 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -1.541e+02
2023-03-15 16:24 - INFO - TrainingManager : 71 -  >> BIC: 3.742e+02
2023-03-15 16:24 - INFO - TrainingManager : 104 - Training with k=7
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.5 0.5]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11996439 0.04460381 0.04045305 0.06013827 0.05837756 0.08341273
  0.06522474 0.09291007 0.33491537 0.1       ]
 [0.34092741 0.08708739 0.06929211 0.07156471 0.07332408 0.0483079
  0.0445392  0.03881776 0.12613944 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 0: logL = -187.4
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.45 0.55]
A:
[[0.76 0.24]
 [0.24 0.76]]
chi:
[[0.08024517 0.03605642 0.03236376 0.06032266 0.04663775 0.10146332
  0.06742741 0.10662413 0.36885937 0.1       ]
 [0.38104532 0.09571335 0.07743952 0.07139625 0.08510984 0.03016936
  0.04230239 0.02499774 0.09182623 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 1: logL = -168.9
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.33 0.67]
A:
[[0.82 0.18]
 [0.19 0.81]]
chi:
[[0.04595727 0.02484388 0.02177483 0.06121619 0.03036564 0.12091825
  0.07060514 0.1208115  0.4035073  0.1       ]
 [0.41349017 0.10652381 0.08770712 0.07045272 0.10104779 0.01124508
  0.0392812  0.01135095 0.05890116 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 2: logL = -164.9
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.15 0.85]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[0.02820136 0.01538852 0.01215284 0.06160162 0.01551186 0.13249072
  0.07328687 0.13088882 0.4304774  0.1       ]
 [0.42401421 0.1141334  0.09575304 0.06992156 0.1140154  0.00210232
  0.03726642 0.00363486 0.03915878 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 3: logL = -160.0
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.03 0.97]
A:
[[0.87 0.13]
 [0.14 0.86]]
chi:
[[2.28133858e-02 9.17372436e-03 5.94638304e-03 6.06113923e-02
  6.63357826e-03 1.37300798e-01 7.37861348e-02 1.36477860e-01
  4.47256744e-01 1.00000000e-01]
 [4.21183918e-01 1.17899756e-01 9.98093336e-02 7.06673462e-02
  1.20232234e-01 2.47640237e-04 3.75157827e-02 1.00329899e-03
  3.14406892e-02 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 4: logL = -157.2
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[2.15577680e-02 5.11934363e-03 2.62556602e-03 5.94994632e-02
  2.64355765e-03 1.39546377e-01 7.29698308e-02 1.39270869e-01
  4.56767225e-01 1.00000000e-01]
 [4.17122947e-01 1.20107023e-01 1.01554676e-01 7.15297986e-02
  1.22318618e-01 2.46794048e-05 3.87168382e-02 2.70788544e-04
  2.83546303e-02 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 5: logL = -156.3
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.21e-05 1.00e+00]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[2.12605765e-02 2.71200861e-03 1.08948100e-03 5.88187798e-02
  1.05246916e-03 1.40637512e-01 7.20356203e-02 1.40556752e-01
  4.61836801e-01 1.00000000e-01]
 [4.14723926e-01 1.21453366e-01 1.02241851e-01 7.20482575e-02
  1.22914682e-01 2.34872814e-06 3.97698601e-02 7.34618368e-05
  2.67722463e-02 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 6: logL = -155.9
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.83e-07 1.00e+00]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[2.11735265e-02 1.39927985e-03 4.40343564e-04 5.84830994e-02
  4.22617966e-04 1.41135187e-01 7.13836959e-02 1.41112530e-01
  4.64449720e-01 1.00000000e-01]
 [4.13588031e-01 1.22235915e-01 1.02498098e-01 7.23011454e-02
  1.23090262e-01 2.20329586e-07 4.04395320e-02 2.00395932e-05
  2.58267567e-02 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 7: logL = -155.7
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.39e-09 1.00e+00]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[2.11334357e-02 7.12931267e-04 1.76323762e-04 5.83520910e-02
  1.70521185e-04 1.41338295e-01 7.09996422e-02 1.41332034e-01
  4.65784726e-01 1.00000000e-01]
 [4.13130889e-01 1.22683155e-01 1.02600443e-01 7.23981096e-02
  1.23156359e-01 2.05538302e-08 4.08133911e-02 5.48333353e-06
  2.52121495e-02 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 8: logL = -155.7
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.87e-12 1.00e+00]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[2.11028797e-02 3.61033546e-04 7.04211092e-05 5.83327517e-02
  6.89519793e-05 1.41403121e-01 7.07874362e-02 1.41401400e-01
  4.66472005e-01 1.00000000e-01]
 [4.13000856e-01 1.22941144e-01 1.02651819e-01 7.24093533e-02
  1.23195741e-01 1.91309036e-09 4.10104275e-02 1.50233993e-06
  2.47891548e-02 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 9: logL = -155.7
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.31e-15 1.00e+00]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[2.10742126e-02 1.82285569e-04 2.81260121e-05 5.83706717e-02
  2.79052146e-05 1.41406653e-01 7.06722061e-02 1.41406181e-01
  4.66831758e-01 1.00000000e-01]
 [4.13017315e-01 1.23094277e-01 1.02686452e-01 7.23759951e-02
  1.23228838e-01 1.77928806e-10 4.11115126e-02 4.11745814e-07
  2.44851972e-02 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 10: logL = -155.6
2023-03-15 16:24 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -1.556e+02
2023-03-15 16:24 - INFO - TrainingManager : 71 -  >> BIC: 3.862e+02
2023-03-15 16:24 - INFO - TrainingManager : 75 - Optimal k=6
2023-03-15 16:24 - INFO - cli : 125 - Training phase done in 00:00:02
2023-03-15 16:24 - INFO - cli : 155 - Process done in 00:00:02
2023-03-15 16:24 - INFO - cli : 156 - Output written to  -> /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/19_repart/HDSL
