2023-03-15 16:24 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/9_repart.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/9_repart.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-03-15 16:24 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/9_repart.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/9_repart.fa

Configuration parameters:
	output: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/9_repart/HDSL
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-03-15 16:24 - INFO - cli : 50 - Loading input data
2023-03-15 16:24 - INFO - cli : 66 -  ... done in 00:00:00
2023-03-15 16:24 - INFO - cli : 104 - Spawning training set
2023-03-15 16:24 - INFO - Dataset : 102 -  ... sorting
2023-03-15 16:24 - INFO - Dataset : 105 -  ... selecting
2023-03-15 16:24 - INFO - cli : 107 -  ... done in 00:00:00
2023-03-15 16:24 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     66
       KL div                     0
2023-03-15 16:24 - INFO - TrainingManager : 104 - Training with k=6
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.74 0.26]
A:
[[0.71 0.29]
 [0.27 0.73]]
chi:
[[0.12723643 0.04346416 0.05970952 0.06859488 0.07908448 0.08750129
  0.09325187 0.34115738 0.1       ]
 [0.33603141 0.09281237 0.10384894 0.06777021 0.05731757 0.0761551
  0.04320011 0.12286428 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 0: logL = -143.1
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.94 0.06]
A:
[[0.75 0.25]
 [0.23 0.77]]
chi:
[[0.09040049 0.03014993 0.04590629 0.07232282 0.0894833  0.07974511
  0.10594569 0.38604636 0.1       ]
 [0.36943283 0.10519094 0.11676432 0.06415217 0.04745318 0.08383551
  0.0314335  0.08173754 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 1: logL = -130.7
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.79 0.21]
 [0.18 0.82]]
chi:
[[0.0523812  0.01556345 0.03179803 0.07649424 0.1026697  0.07088342
  0.12031354 0.42989642 0.1       ]
 [0.40109483 0.11782076 0.12900602 0.06034007 0.03564676 0.09213378
  0.01900197 0.0449558  0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 2: logL = -127.6
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.47e-04]
A:
[[0.82 0.18]
 [0.14 0.86]]
chi:
[[0.02713243 0.00596862 0.02378113 0.07992609 0.11454661 0.06387237
  0.13030399 0.45446877 0.1       ]
 [0.42425686 0.12667258 0.13638267 0.05714025 0.02459119 0.09869023
  0.00977664 0.02248957 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 3: logL = -124.2
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.31e-06]
A:
[[0.84 0.16]
 [0.13 0.87]]
chi:
[[0.01555631 0.00194201 0.02260671 0.08177011 0.12252965 0.06034529
  0.13415178 0.46109814 0.1       ]
 [0.4401701  0.13199885 0.13886395 0.05509053 0.0158218  0.10250568
  0.00462476 0.01092433 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 4: logL = -122.2
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.02e-09]
A:
[[0.84 0.16]
 [0.13 0.87]]
chi:
[[0.01027084 0.00059253 0.02466873 0.08274197 0.12768362 0.05897474
  0.13472812 0.46033947 0.1       ]
 [0.45177766 0.13528669 0.13855804 0.05372603 0.00910648 0.1044979
  0.00211247 0.00493474 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 5: logL = -121.3
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 8.58e-12]
A:
[[0.84 0.16]
 [0.13 0.87]]
chi:
[[7.39106459e-03 1.76701197e-04 2.72797928e-02 8.34639165e-02
  1.30741972e-01 5.86083848e-02 1.34360429e-01 4.57977740e-01
  1.00000000e-01]
 [4.59823213e-01 1.37271102e-01 1.37226045e-01 5.26560861e-02
  4.62430343e-03 1.05397999e-01 9.48159654e-04 2.05309049e-03
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 6: logL = -120.9
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 6.17e-15]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[5.60882559e-03 5.22957683e-05 2.92652314e-02 8.39323041e-02
  1.32329276e-01 5.86433541e-02 1.33992178e-01 4.56176535e-01
  1.00000000e-01]
 [4.64730136e-01 1.38330023e-01 1.35928280e-01 5.19646444e-02
  2.13366654e-03 1.05679681e-01 4.21493490e-04 8.12076127e-04
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 7: logL = -120.7
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.77e-18]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[4.40535905e-03 1.54501529e-05 3.04693482e-02 8.41010131e-02
  1.33111043e-01 5.87438054e-02 1.33828296e-01 4.55325685e-01
  1.00000000e-01]
 [4.67367833e-01 1.38787178e-01 1.35004276e-01 5.16930347e-02
  9.29426322e-04 1.05718159e-01 1.86509780e-04 3.13583438e-04
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 8: logL = -120.6
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.98e-22]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[3.52998925e-03 4.56671306e-06 3.11208553e-02 8.40306918e-02
  1.33532947e-01 5.87604752e-02 1.33833205e-01 4.55187270e-01
  1.00000000e-01]
 [4.68618976e-01 1.38901320e-01 1.34405953e-01 5.17419585e-02
  3.93821654e-04 1.05735684e-01 8.23676154e-05 1.19919861e-04
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 9: logL = -120.5
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 8.49e-27]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[2.85546300e-03 1.35132139e-06 3.14585558e-02 8.38113383e-02
  1.33812506e-01 5.86628875e-02 1.33937003e-01 4.55460895e-01
  1.00000000e-01]
 [4.69104020e-01 1.38840742e-01 1.34008452e-01 5.19841428e-02
  1.65361726e-04 1.05815204e-01 3.63389926e-05 4.57385663e-05
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 10: logL = -120.5
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.39e-31]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[2.31597408e-03 4.00313391e-07 3.16359294e-02 8.35159158e-02
  1.34036087e-01 5.84736396e-02 1.34087790e-01 4.55934264e-01
  1.00000000e-01]
 [4.69189714e-01 1.38701086e-01 1.33721117e-01 5.23219348e-02
  6.94938189e-05 1.05963177e-01 1.60188499e-05 1.74582005e-05
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 11: logL = -120.5
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 8.72e-37]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[1.87584158e-03 1.18697972e-07 3.17351915e-02 8.31931941e-02
  1.34232485e-01 5.82283072e-02 1.34254111e-01 4.56480751e-01
  1.00000000e-01]
 [4.69077462e-01 1.38533111e-01 1.33494851e-01 5.26927688e-02
  2.93689467e-05 1.06158704e-01 7.05522788e-06 6.67894790e-06
  1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 12: logL = -120.5
2023-03-15 16:24 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -1.205e+02
2023-03-15 16:24 - INFO - TrainingManager : 71 -  >> BIC: 3.038e+02
2023-03-15 16:24 - INFO - TrainingManager : 104 - Training with k=7
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.74 0.26]
A:
[[0.72 0.28]
 [0.27 0.73]]
chi:
[[0.12614589 0.03206709 0.05160611 0.05817241 0.05983052 0.07183444
  0.0855398  0.07306625 0.3417375  0.1       ]
 [0.33718786 0.07695945 0.08471006 0.07816256 0.04927552 0.06453966
  0.05087354 0.0360777  0.12221364 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 0: logL = -150.8
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.94 0.06]
A:
[[0.75 0.25]
 [0.23 0.77]]
chi:
[[0.08807559 0.02010007 0.0440443  0.05251185 0.06813954 0.06883231
  0.0933473  0.07991305 0.38503599 0.1       ]
 [0.3728493  0.08834108 0.09186402 0.0835562  0.0412078  0.0675436
  0.04349104 0.02965638 0.08149058 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 1: logL = -135.6
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.79 0.21]
 [0.18 0.82]]
chi:
[[0.04975004 0.00860076 0.03562528 0.04757417 0.08010196 0.0653787
  0.10235586 0.08760005 0.42301318 0.1       ]
 [0.40920256 0.09930821 0.09990083 0.08825933 0.0296464  0.07091282
  0.03488692 0.0223412  0.04554174 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 2: logL = -132.7
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.59e-04]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.0253223  0.00246737 0.0300543  0.04557211 0.09240386 0.06352159
  0.10939706 0.093238   0.43802341 0.1       ]
 [0.44007984 0.10706886 0.10663537 0.09098487 0.01636332 0.07288189
  0.02661414 0.01552204 0.02384966 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 3: logL = -129.6
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.66e-06]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.01469534 0.00058986 0.02890548 0.04494113 0.10010529 0.0647676
  0.11363068 0.0960399  0.4363247  0.1       ]
 [0.46394485 0.11222953 0.11017226 0.09302851 0.0058373  0.07183197
  0.01959231 0.01018362 0.01317966 0.1       ]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 4: logL = -127.6
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 8.65e-09]
A:
[[0.85 0.15]
 [0.14 0.86]]
chi:
[[9.88121335e-03 1.40444581e-04 2.99888154e-02 4.38049137e-02
  1.02261867e-01 6.74474270e-02 1.16404738e-01 9.75867578e-02
  4.32483823e-01 1.00000000e-01]
 [4.79901631e-01 1.15359940e-01 1.10874354e-01 9.54305753e-02
  1.20755284e-03 6.90027282e-02 1.42777369e-02 6.43343857e-03
  7.51204382e-03 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 5: logL = -126.7
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.55e-11]
A:
[[0.85 0.15]
 [0.14 0.86]]
chi:
[[7.07947194e-03 3.51137370e-05 3.13616914e-02 4.23341187e-02
  1.01974645e-01 6.97697872e-02 1.18475258e-01 9.86395730e-02
  4.30330341e-01 1.00000000e-01]
 [4.89462885e-01 1.17037139e-01 1.10393107e-01 9.78141093e-02
  1.71734909e-04 6.63613405e-02 1.05244680e-02 3.99512410e-03
  4.24009199e-03 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 6: logL = -126.3
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.29e-14]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[5.18320921e-03 9.20484493e-06 3.24175332e-02 4.09663786e-02
  1.01458129e-01 7.12882821e-02 1.20078193e-01 9.93485131e-02
  4.29250557e-01 1.00000000e-01]
 [4.95229897e-01 1.17931467e-01 1.09749682e-01 9.98135895e-02
  2.01189742e-05 6.45712589e-02 7.86406157e-03 2.47206807e-03
  2.34785701e-03 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 7: logL = -126.1
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.05e-17]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[3.81596559e-03 2.50232912e-06 3.31012748e-02 3.98559054e-02
  1.01133333e-01 7.21937756e-02 1.21338195e-01 9.98286637e-02
  4.28730385e-01 1.00000000e-01]
 [4.98754698e-01 1.18402315e-01 1.09252814e-01 1.01344744e-01
  2.09890207e-06 6.34847677e-02 5.94830877e-03 1.52955708e-03
  1.28069692e-03 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 8: logL = -126.0
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 2.1e-20]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[2.80866888e-03 6.98592325e-07 3.35025172e-02 3.90067337e-02
  1.00961576e-01 7.27310666e-02 1.22334083e-01 1.00156241e-01
  4.28498415e-01 1.00000000e-01]
 [5.00935486e-01 1.18642956e-01 1.08934710e-01 1.02466508e-01
  2.02946926e-07 6.28358330e-02 4.54554704e-03 9.46581297e-04
  6.92175017e-04 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 9: logL = -125.9
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.95e-24]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[2.06303486e-03 1.98839670e-07 3.37198239e-02 3.83756691e-02
  1.00875952e-01 7.30599021e-02 1.23120282e-01 1.00378419e-01
  4.28406719e-01 1.00000000e-01]
 [5.02311603e-01 1.18762222e-01 1.08754327e-01 1.03272946e-01
  1.86601314e-08 6.24387930e-02 3.50212224e-03 5.85769859e-04
  3.72198184e-04 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 10: logL = -125.9
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 9.09e-28]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[1.51180522e-03 5.74014935e-08 3.38269353e-02 3.79135205e-02
  1.00834577e-01 7.32696737e-02 1.23738835e-01 1.00527036e-01
  4.28377559e-01 1.00000000e-01]
 [5.03203012e-01 1.18819808e-01 1.08664388e-01 1.03848902e-01
  1.65943189e-09 6.21864705e-02 2.71540819e-03 3.62396441e-04
  1.99613211e-04 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 11: logL = -125.9
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 7.48e-32]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[1.10554159e-03 1.67444968e-08 3.38719012e-02 3.75778875e-02
  1.00814809e-01 7.34090794e-02 1.24223832e-01 1.00624692e-01
  4.28372241e-01 1.00000000e-01]
 [5.03797899e-01 1.18847318e-01 1.08628677e-01 1.04259808e-01
  1.44321517e-10 6.20195680e-02 2.11568915e-03 2.24122313e-04
  1.06918319e-04 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 12: logL = -125.9
2023-03-15 16:24 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #14
2023-03-15 16:24 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.31e-36]
A:
[[0.85 0.15]
 [0.15 0.85]]
chi:
[[8.07080917e-04 4.92257235e-09 3.38838247e-02 3.73354547e-02
  1.00805034e-01 7.35051357e-02 1.24603086e-01 1.00687527e-01
  4.28372852e-01 1.00000000e-01]
 [5.04207289e-01 1.18860919e-01 1.08623164e-01 1.04553288e-01
  1.23637031e-11 6.19050042e-02 1.65454400e-03 1.38554281e-04
  5.72369037e-05 1.00000000e-01]]

2023-03-15 16:24 - DEBUG - TrainingManager : 134 - 13: logL = -125.8
2023-03-15 16:24 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -1.258e+02
2023-03-15 16:24 - INFO - TrainingManager : 71 -  >> BIC: 3.229e+02
2023-03-15 16:24 - INFO - TrainingManager : 75 - Optimal k=6
2023-03-15 16:24 - INFO - cli : 125 - Training phase done in 00:00:00
2023-03-15 16:24 - INFO - cli : 155 - Process done in 00:00:00
2023-03-15 16:24 - INFO - cli : 156 - Output written to  -> /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/9_repart/HDSL
