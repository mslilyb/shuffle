2023-03-15 16:35 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/9_repart.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/9_repart.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-03-15 16:35 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/9_repart.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/9_repart.fa

Configuration parameters:
	output: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/9_repartbig/HDSL
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-03-15 16:35 - INFO - cli : 50 - Loading input data
2023-03-15 16:35 - INFO - cli : 66 -  ... done in 00:00:00
2023-03-15 16:35 - INFO - cli : 104 - Spawning training set
2023-03-15 16:35 - INFO - Dataset : 102 -  ... sorting
2023-03-15 16:35 - INFO - Dataset : 105 -  ... selecting
2023-03-15 16:35 - INFO - cli : 107 -  ... done in 00:00:00
2023-03-15 16:35 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     500
       KL div                     0
2023-03-15 16:35 - INFO - TrainingManager : 104 - Training with k=6
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.43 0.57]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11614424 0.05223583 0.05696147 0.07343089 0.07982384 0.08975146
  0.09995685 0.33169542 0.1       ]
 [0.33424434 0.102654   0.08709221 0.07777685 0.06775466 0.06139802
  0.0511562  0.11792371 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 0: logL = -1083.5
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.35 0.65]
A:
[[0.76 0.24]
 [0.24 0.76]]
chi:
[[0.07715522 0.04351453 0.05048247 0.07529225 0.08331944 0.0940498
  0.10813183 0.36805446 0.1       ]
 [0.37497898 0.11177462 0.09382814 0.0759122  0.06414314 0.05688387
  0.04259856 0.07988049 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 1: logL = -1001.5
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.26 0.74]
A:
[[0.81 0.19]
 [0.2  0.8 ]]
chi:
[[0.04393697 0.03441716 0.04299919 0.07741968 0.08745725 0.09824957
  0.11659225 0.39892793 0.1       ]
 [0.41231476 0.12186695 0.10200215 0.07371749 0.05967119 0.05216839
  0.03319237 0.0450667  0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 2: logL = -984.7
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.15 0.85]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.02461263 0.02764596 0.03666749 0.07910643 0.09117123 0.10080077
  0.1231245  0.41687098 0.1       ]
 [0.43603963 0.12979888 0.10921073 0.07190717 0.05550534 0.0490596
  0.02554917 0.02292947 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 3: logL = -966.9
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.07 0.93]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[0.01574204 0.02381691 0.0329097  0.07988695 0.09349336 0.10149159
  0.12712151 0.42553792 0.1       ]
 [0.44725318 0.13431067 0.11351786 0.07104682 0.05288365 0.0481005
  0.02087893 0.01200839 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 4: logL = -956.9
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.02 0.98]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[0.01149331 0.02170956 0.03117803 0.08017661 0.09458321 0.10132346
  0.12939048 0.43014534 0.1       ]
 [0.45221246 0.13666541 0.11544248 0.0707296  0.05168264 0.04822526
  0.01835651 0.00668564 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 5: logL = -953.5
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[0.00901652 0.02036687 0.03047241 0.08036312 0.09503477 0.10101521
  0.1307282  0.4330029  0.1       ]
 [0.45463051 0.1380368  0.11615153 0.07053592 0.0512235  0.04857892
  0.0169885  0.00385433 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 6: logL = -952.4
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[0.00731129 0.01939405 0.03019868 0.08053209 0.09522138 0.10079524
  0.13157316 0.43497412 0.1       ]
 [0.45593124 0.1389346  0.1163442  0.07036788 0.05107551 0.04887207
  0.01622186 0.00225265 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 7: logL = -951.8
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.96e-04 1.00e+00]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[0.00602796 0.01864369 0.03009096 0.0806711  0.0953016  0.1006841
  0.13213856 0.43644203 0.1       ]
 [0.45664303 0.13955629 0.11633414 0.07023545 0.05105419 0.04906439
  0.0157898  0.00132272 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 8: logL = -951.5
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.24e-04 1.00e+00]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[0.00502061 0.01804896 0.03004028 0.08076757 0.09533419 0.10065164
  0.13253126 0.43760549 0.1       ]
 [0.45699876 0.13999391 0.11625234 0.07015008 0.05108921 0.04917957
  0.01555809 0.00077804 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 9: logL = -951.3
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.01e-05 1.00e+00]
A:
[[0.85 0.15]
 [0.16 0.84]]
chi:
[[0.00421215 0.01757036 0.03000391 0.0808217  0.09534062 0.10066677
  0.13280989 0.43857459 0.1       ]
 [0.45712552 0.14030194 0.11615263 0.07011016 0.05115325 0.04924603
  0.01545232 0.00045815 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 10: logL = -951.2
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.14e-06 1.00e+00]
A:
[[0.85 0.15]
 [0.16 0.84]]
chi:
[[3.55393358e-03 1.71806484e-02 2.99664638e-02 8.08407499e-02
  9.53298295e-02 1.00707414e-01 1.33009892e-01 4.39411069e-01
  1.00000000e-01]
 [4.57103483e-01 1.40517496e-01 1.16056462e-01 7.01070313e-02
  5.12340159e-02 4.92842554e-02 1.54271725e-02 2.70084117e-04
  1.00000000e-01]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 11: logL = -951.1
2023-03-15 16:35 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -9.511e+02
2023-03-15 16:35 - INFO - TrainingManager : 71 -  >> BIC: 1.995e+03
2023-03-15 16:35 - INFO - TrainingManager : 104 - Training with k=7
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.41 0.59]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11636749 0.04297647 0.05094298 0.05560538 0.06647084 0.07120095
  0.07950411 0.08556327 0.33136851 0.1       ]
 [0.33399074 0.0866955  0.08230865 0.06681307 0.06312365 0.05477201
  0.0500474  0.04396826 0.11828073 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 0: logL = -1142.5
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.3 0.7]
A:
[[0.76 0.24]
 [0.24 0.76]]
chi:
[[0.07770291 0.0357835  0.04490577 0.05460541 0.06879308 0.07516113
  0.08448618 0.09146849 0.36709354 0.1       ]
 [0.37447697 0.09424592 0.08861529 0.06789218 0.06074783 0.05065889
  0.04482248 0.03773684 0.0808036  0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 1: logL = -1040.4
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.18 0.82]
A:
[[0.81 0.19]
 [0.2  0.8 ]]
chi:
[[0.04460885 0.02843321 0.03815809 0.05312558 0.07141663 0.07959079
  0.08951631 0.09767755 0.397473   0.1       ]
 [0.41177861 0.1024545  0.09604901 0.06956033 0.05794908 0.04582175
  0.03920852 0.0307583  0.04641992 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 2: logL = -1024.2
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.07 0.93]
A:
[[0.84 0.16]
 [0.17 0.83]]
chi:
[[0.0250371  0.02313339 0.03262221 0.05164034 0.0733901  0.08307838
  0.09313841 0.10254381 0.41541626 0.1       ]
 [0.43571491 0.10870702 0.10240477 0.07127369 0.05574801 0.041842
  0.03493783 0.0250267  0.02434506 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 3: logL = -1007.1
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.02 0.98]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[0.01583599 0.0203152  0.02938809 0.0506832  0.07418291 0.08481637
  0.09499659 0.10545486 0.4243268  0.1       ]
 [0.44715504 0.11204772 0.10612312 0.07237    0.05483432 0.03982863
  0.03272793 0.02162009 0.01329315 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 4: logL = -997.5
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0. 1.]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[0.01133972 0.01890869 0.02782506 0.05029756 0.07424261 0.0854395
  0.09574008 0.10700572 0.42920106 0.1       ]
 [0.45229623 0.11362013 0.10784959 0.07279824 0.05475475 0.03912839
  0.0318853  0.01990068 0.00776668 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 5: logL = -994.2
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.14e-04 9.99e-01]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[0.00869734 0.01806618 0.02705865 0.05024759 0.07406427 0.08566936
  0.09599588 0.10787091 0.43232981 0.1       ]
 [0.45482533 0.11445549 0.10861337 0.07283712 0.05495655 0.03891341
  0.03165384 0.01903641 0.00470848 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 6: logL = -993.1
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.34e-04 1.00e+00]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[0.0068833  0.017443   0.02663249 0.05032849 0.07385172 0.08580075
  0.09607996 0.10840827 0.43457202 0.1       ]
 [0.45616092 0.11498913 0.10895773 0.07272166 0.05520695 0.03883568
  0.03164938 0.01858378 0.00289477 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 7: logL = -992.6
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.09e-05 1.00e+00]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[0.0055303  0.01693025 0.02635993 0.05043035 0.07365765 0.08590898
  0.09611485 0.10877296 0.43629474 0.1       ]
 [0.45684802 0.11536965 0.10910965 0.07257707 0.05544277 0.03879893
  0.03171896 0.01834692 0.00178802 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 8: logL = -992.3
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.14e-06 1.00e+00]
A:
[[0.85 0.15]
 [0.16 0.84]]
chi:
[[0.00448142 0.01649439 0.02616454 0.05050813 0.07348853 0.08600476
  0.09614076 0.10903346 0.43768401 0.1       ]
 [0.45714115 0.11565159 0.10916664 0.07245539 0.05565354 0.03878276
  0.03180741 0.01823519 0.00110635 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 9: logL = -992.1
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.58e-07 1.00e+00]
A:
[[0.85 0.15]
 [0.16 0.84]]
chi:
[[0.00365224 0.01612192 0.02601186 0.05054987 0.07334092 0.0860867
  0.09616813 0.10922421 0.43884414 0.1       ]
 [0.45718565 0.11586151 0.10917547 0.07237159 0.05584089 0.0387829
  0.03189599 0.01820064 0.00068537 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 10: logL = -991.9
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.52e-08 1.00e+00]
A:
[[0.85 0.15]
 [0.16 0.84]]
chi:
[[2.98896214e-03 1.58041715e-02 2.58847700e-02 5.05578858e-02
  7.32107836e-02 8.61537795e-02 9.61978494e-02 1.09365428e-01
  4.39836370e-01 1.00000000e-01]
 [4.57074790e-01 1.16016808e-01 1.09160850e-01 7.23245209e-02
  5.60079559e-02 3.87966605e-02 3.19788872e-02 1.82144232e-02
  4.25104782e-04 1.00000000e-01]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 11: logL = -991.8
2023-03-15 16:35 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -9.918e+02
2023-03-15 16:35 - INFO - TrainingManager : 71 -  >> BIC: 2.089e+03
2023-03-15 16:35 - INFO - TrainingManager : 75 - Optimal k=6
2023-03-15 16:35 - INFO - cli : 125 - Training phase done in 00:00:01
2023-03-15 16:35 - INFO - cli : 155 - Process done in 00:00:01
2023-03-15 16:35 - INFO - cli : 156 - Output written to  -> /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/9_repartbig/HDSL
