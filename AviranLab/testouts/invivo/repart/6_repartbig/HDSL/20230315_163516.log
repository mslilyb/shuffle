2023-03-15 16:35 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/6_repart.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/6_repart.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-03-15 16:35 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/6_repart.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/6_repart.fa

Configuration parameters:
	output: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/6_repartbig/HDSL
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-03-15 16:35 - INFO - cli : 50 - Loading input data
2023-03-15 16:35 - INFO - cli : 66 -  ... done in 00:00:00
2023-03-15 16:35 - INFO - cli : 104 - Spawning training set
2023-03-15 16:35 - INFO - Dataset : 102 -  ... sorting
2023-03-15 16:35 - INFO - Dataset : 105 -  ... selecting
2023-03-15 16:35 - INFO - cli : 107 -  ... done in 00:00:00
2023-03-15 16:35 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     350
       KL div                     0
2023-03-15 16:35 - INFO - TrainingManager : 104 - Training with k=6
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.36 0.64]
A:
[[0.73 0.27]
 [0.27 0.73]]
chi:
[[0.1158332  0.05049326 0.05389071 0.07166486 0.08107014 0.09108362
  0.10014694 0.33581726 0.1       ]
 [0.33671474 0.10378679 0.09010544 0.07747738 0.0680741  0.05806275
  0.04900135 0.11677746 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 0: logL = -757.9
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.19 0.81]
A:
[[0.77 0.23]
 [0.23 0.77]]
chi:
[[0.07373485 0.03959144 0.04312827 0.07275763 0.08545006 0.09894604
  0.11054095 0.37585077 0.1       ]
 [0.37969774 0.11490625 0.10103472 0.07639547 0.06363139 0.05005922
  0.03839886 0.07587636 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 1: logL = -697.6
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.06 0.94]
A:
[[0.83 0.17]
 [0.18 0.82]]
chi:
[[0.03795132 0.02819505 0.03149173 0.07433669 0.09107066 0.10687552
  0.12116274 0.40891627 0.1       ]
 [0.41811805 0.12699978 0.11326063 0.07481052 0.05776575 0.04166735
  0.02711477 0.04026315 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 2: logL = -681.6
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.87 0.13]
 [0.14 0.86]]
chi:
[[0.01938079 0.02024195 0.02362471 0.07605629 0.09609523 0.11157576
  0.12817135 0.42485393 0.1       ]
 [0.44059254 0.13607937 0.12210588 0.07303345 0.05227763 0.03624329
  0.01905401 0.02061384 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 3: logL = -664.9
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.33e-04 9.99e-01]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[0.01250396 0.01628068 0.02059748 0.07752237 0.09884    0.11292955
  0.131379   0.42994697 0.1       ]
 [0.45079821 0.14106    0.12598266 0.07147237 0.0490847  0.03428793
  0.01491241 0.01240171 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 4: logL = -657.2
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[7.61e-05 1.00e+00]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[0.00974568 0.01438036 0.02005912 0.07859576 0.09994237 0.11287935
  0.13276324 0.43163412 0.1       ]
 [0.45570778 0.14363911 0.12703086 0.07030769 0.04769116 0.03398456
  0.01291777 0.00872107 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 5: logL = -655.5
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[5.69e-06 1.00e+00]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[0.00824263 0.01333637 0.02031936 0.07932849 0.10035738 0.11250963
  0.13344138 0.43246476 0.1       ]
 [0.45852308 0.14510305 0.12704498 0.06950469 0.04710685 0.03416351
  0.01186912 0.00668471 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 6: logL = -655.1
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.02e-07 1.00e+00]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[0.00721217 0.01267657 0.02072794 0.07981672 0.10051941 0.11215209
  0.13382627 0.43306884 0.1       ]
 [0.46033836 0.14601702 0.12677778 0.06896749 0.04684926 0.0344212
  0.01126505 0.00536384 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 7: logL = -654.9
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.68e-08 1.00e+00]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[0.00642513 0.0122173  0.02109173 0.08013705 0.10058421 0.11187504
  0.13406993 0.43359962 0.1       ]
 [0.46157139 0.1466235  0.12647992 0.06861533 0.04673363 0.03465065
  0.01089859 0.00442697 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 8: logL = -654.8
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.68e-09 1.00e+00]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.00579428 0.01187697 0.02137211 0.08034262 0.10060772 0.11167578
  0.13423571 0.43409481 0.1       ]
 [0.46242664 0.14704103 0.12622123 0.06839062 0.0466872  0.03483358
  0.01067245 0.00372726 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 9: logL = -654.8
2023-03-15 16:35 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -6.548e+02
2023-03-15 16:35 - INFO - TrainingManager : 71 -  >> BIC: 1.397e+03
2023-03-15 16:35 - INFO - TrainingManager : 104 - Training with k=7
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.36 0.64]
A:
[[0.73 0.27]
 [0.28 0.72]]
chi:
[[0.11602501 0.04249905 0.04555403 0.05851072 0.06733637 0.06964724
  0.07965331 0.08562598 0.3351483  0.1       ]
 [0.33655085 0.09121621 0.07787519 0.07006094 0.06123494 0.05378101
  0.0489175  0.04294459 0.11741875 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 0: logL = -799.3
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.19 0.81]
A:
[[0.77 0.23]
 [0.23 0.77]]
chi:
[[0.07468237 0.03257122 0.03777522 0.0578565  0.07162017 0.07365583
  0.08545896 0.09279608 0.37358365 0.1       ]
 [0.37935465 0.10147451 0.08588477 0.07077709 0.05688036 0.0496573
  0.04290779 0.03549973 0.07756381 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 1: logL = -725.2
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.06 0.94]
A:
[[0.82 0.18]
 [0.18 0.82]]
chi:
[[0.03961987 0.0223039  0.02947718 0.056975   0.07681888 0.07848559
  0.09068632 0.10039959 0.40523367 0.1       ]
 [0.4183067  0.11268855 0.09487622 0.07180616 0.05139299 0.04446184
  0.03712772 0.02713579 0.04220403 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 2: logL = -710.7
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.01 0.99]
A:
[[0.86 0.14]
 [0.15 0.85]]
chi:
[[0.02066584 0.01466708 0.02372535 0.05609779 0.08140094 0.08269124
  0.09314716 0.10589427 0.42171033 0.1       ]
 [0.4416506  0.12152067 0.10150364 0.07286169 0.04635934 0.03974317
  0.03405642 0.02070519 0.02159927 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 3: logL = -695.4
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.96e-04 9.99e-01]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[0.01298715 0.01007702 0.02147938 0.05547821 0.08416458 0.08521492
  0.09329248 0.10876906 0.4285372  0.1       ]
 [0.45178721 0.12688569 0.10425105 0.0735971  0.04326957 0.03686917
  0.03361945 0.01725745 0.0124633  0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 4: logL = -687.6
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.41e-05 1.00e+00]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[0.00966929 0.00730026 0.02109053 0.05508808 0.085501   0.08644283
  0.09278081 0.11011647 0.43201074 0.1       ]
 [0.45579481 0.12995876 0.1047559  0.07403078 0.04180773 0.03551394
  0.03409464 0.01572719 0.00831625 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 5: logL = -685.5
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[6.38e-06 1.00e+00]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[0.00781164 0.00547261 0.02123569 0.05479897 0.08612543 0.08702567
  0.09235472 0.11073653 0.43443872 0.1       ]
 [0.45739259 0.1317911  0.10453347 0.07432101 0.04118316 0.03493932
  0.03459368 0.01514897 0.0060967  0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 6: logL = -684.9
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[4.45e-07 1.00e+00]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[0.00653441 0.00418154 0.0214301  0.05454098 0.08642931 0.08731495
  0.09212375 0.11100188 0.43644309 0.1       ]
 [0.45796722 0.13293538 0.10418549 0.07455949 0.04093995 0.03472378
  0.03493636 0.01503335 0.00471898 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 7: logL = -684.6
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[2.82e-08 1.00e+00]
A:
[[0.88 0.12]
 [0.14 0.86]]
chi:
[[0.00556118 0.00322573 0.02156284 0.05429609 0.08658114 0.08746576
  0.09203511 0.11108577 0.43818637 0.1       ]
 [0.45805965 0.13367392 0.1038757  0.07477542 0.04087418 0.0346737
  0.03514719 0.01514286 0.00377737 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 8: logL = -684.5
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.62e-09 1.00e+00]
A:
[[0.87 0.13]
 [0.14 0.86]]
chi:
[[0.00478427 0.00249772 0.02163211 0.05406654 0.08665361 0.08754719
  0.09202821 0.11107633 0.43971402 0.1       ]
 [0.45792    0.13416077 0.10363007 0.07497238 0.04089458 0.03469962
  0.0352741  0.01535461 0.00309388 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 9: logL = -684.4
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[8.42e-11 1.00e+00]
A:
[[0.87 0.13]
 [0.14 0.86]]
chi:
[[0.00414922 0.00193454 0.02165725 0.05385835 0.08668096 0.08759213
  0.09206206 0.1110218  0.44104368 0.1       ]
 [0.45768018 0.13448552 0.10344078 0.07514765 0.0409571  0.03475793
  0.03535174 0.01560181 0.00257729 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 10: logL = -684.3
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[3.92e-12 1.00e+00]
A:
[[0.87 0.13]
 [0.14 0.86]]
chi:
[[0.00362245 0.00149586 0.02165597 0.0536757  0.08668128 0.08761743
  0.09211278 0.11094941 0.44218912 0.1       ]
 [0.45741306 0.13470299 0.10329534 0.07529905 0.04103882 0.03482649
  0.03540086 0.0158482  0.0021752  0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 11: logL = -684.2
2023-03-15 16:35 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -6.842e+02
2023-03-15 16:35 - INFO - TrainingManager : 71 -  >> BIC: 1.468e+03
2023-03-15 16:35 - INFO - TrainingManager : 75 - Optimal k=6
2023-03-15 16:35 - INFO - cli : 125 - Training phase done in 00:00:01
2023-03-15 16:35 - INFO - cli : 155 - Process done in 00:00:01
2023-03-15 16:35 - INFO - cli : 156 - Output written to  -> /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/6_repartbig/HDSL
