2023-03-15 16:35 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/3_repart.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/3_repart.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-03-15 16:35 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/3_repart.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/bigdata/3_repart.fa

Configuration parameters:
	output: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/3_repartbig/HDSL
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-03-15 16:35 - INFO - cli : 50 - Loading input data
2023-03-15 16:35 - INFO - cli : 66 -  ... done in 00:00:00
2023-03-15 16:35 - INFO - cli : 104 - Spawning training set
2023-03-15 16:35 - INFO - Dataset : 102 -  ... sorting
2023-03-15 16:35 - INFO - Dataset : 105 -  ... selecting
2023-03-15 16:35 - INFO - cli : 107 -  ... done in 00:00:00
2023-03-15 16:35 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     200
       KL div                     0
2023-03-15 16:35 - INFO - TrainingManager : 104 - Training with k=6
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.75 0.25]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.1184386  0.05668354 0.05576967 0.0683074  0.08278433 0.08255239
  0.10289358 0.3325705  0.1       ]
 [0.33055521 0.10508686 0.08807708 0.07565774 0.07027501 0.06154725
  0.05035564 0.11844522 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 0: logL = -433.6
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.94 0.06]
A:
[[0.75 0.25]
 [0.24 0.76]]
chi:
[[0.081675   0.04926278 0.047471   0.06753817 0.08623862 0.08274426
  0.11334714 0.37172304 0.1       ]
 [0.36573322 0.11216331 0.09608543 0.07638115 0.06693749 0.06145004
  0.04031918 0.08093019 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 1: logL = -400.7
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.79 0.21]
 [0.2  0.8 ]]
chi:
[[0.04884966 0.03987066 0.03762248 0.06651583 0.09054479 0.08294009
  0.12477697 0.40887951 0.1       ]
 [0.39467353 0.12061706 0.1051135  0.07728252 0.06297162 0.06146216
  0.02999811 0.04788149 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 2: logL = -394.4
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.91e-04]
A:
[[0.82 0.18]
 [0.16 0.84]]
chi:
[[0.02795306 0.03032225 0.02874497 0.06579913 0.09461097 0.08326031
  0.13396748 0.43534182 0.1       ]
 [0.41022133 0.12863636 0.11265912 0.07782873 0.05947595 0.06141547
  0.02248138 0.02728167 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 3: logL = -387.8
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.55e-06]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.01752433 0.02261205 0.02289613 0.06573213 0.09725163 0.08399723
  0.13924361 0.45074289 0.1       ]
 [0.41640251 0.13486463 0.11729979 0.0777823  0.057356   0.0609322
  0.01861714 0.01674543 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 4: logL = -383.8
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.74e-08]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.01236777 0.0172148  0.01979747 0.065931   0.09852145 0.08496604
  0.14165934 0.45954212 0.1       ]
 [0.41881699 0.13914103 0.11958328 0.07753197 0.05642717 0.06018129
  0.01710643 0.01121186 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 5: logL = -382.3
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 7.46e-11]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.00936983 0.01353714 0.01833334 0.06600127 0.09903758 0.08581816
  0.14262518 0.46527749 0.1       ]
 [0.41979787 0.14194518 0.12048185 0.07741918 0.0561398  0.05951683
  0.01676326 0.00793603 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 6: logL = -381.8
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.22e-13]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.00732118 0.0109275  0.01770561 0.06586333 0.09923976 0.08642775
  0.14291697 0.4695979  0.1       ]
 [0.42008402 0.14379906 0.1206587  0.07749969 0.0561206  0.05906983
  0.01697703 0.00579107 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 7: logL = -381.5
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.81e-16]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.00578656 0.008969   0.01748969 0.06557668 0.09933295 0.08681508
  0.14288598 0.47314405 0.1       ]
 [0.41996943 0.1450647  0.12048172 0.07771293 0.05619227 0.0588234
  0.017456   0.00429955 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 8: logL = -381.3
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 7.72e-19]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.00458976 0.00742876 0.01747279 0.06521246 0.0993966  0.08703622
  0.14269671 0.47616669 0.1       ]
 [0.41961533 0.1459611  0.12014581 0.07799319 0.05628302 0.05872349
  0.01805038 0.00322768 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 9: logL = -381.2
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #11
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 9.3e-22]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.00364191 0.00617793 0.01754696 0.06482075 0.09945703 0.08714218
  0.1424349  0.47877832 0.1       ]
 [0.41912559 0.14661711 0.11975397 0.07829602 0.05636725 0.05872068
  0.01867672 0.00244266 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 10: logL = -381.1
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #12
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 8.47e-25]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.00288746 0.00514233 0.0176563  0.06443166 0.09952041 0.0871714
  0.14214917 0.48104126 0.1       ]
 [0.41857057 0.14710978 0.11936041 0.07859579 0.05643777 0.05877816
  0.0192869  0.00186063 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 11: logL = -381.0
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #13
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.86e-28]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.00228641 0.00427627 0.01777194 0.06406195 0.09958602 0.08715136
  0.14186777 0.48299828 0.1       ]
 [0.41799797 0.14748685 0.11899267 0.07887891 0.05649424 0.05887021
  0.01985395 0.00142521 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 12: logL = -380.9
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #14
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 3.1e-31]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.00180794 0.00354912 0.0178796  0.06372038 0.09965145 0.0871014
  0.14160632 0.48468378 0.1       ]
 [0.41743926 0.14777921 0.11866335 0.0791388  0.0565385  0.05897936
  0.02036444 0.00109707 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 13: logL = -380.9
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #15
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.26e-34]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[0.0014276  0.00293849 0.01797312 0.06341091 0.0997144  0.08703498
  0.14137239 0.48612811 0.1       ]
 [0.41691406 0.14800782 0.11837656 0.07937285 0.05657281 0.059094
  0.02081369 0.00084821 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 14: logL = -380.9
2023-03-15 16:35 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -3.809e+02
2023-03-15 16:35 - INFO - TrainingManager : 71 -  >> BIC: 8.412e+02
2023-03-15 16:35 - INFO - TrainingManager : 104 - Training with k=7
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.75 0.25]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.11845107 0.04695963 0.04510026 0.05804539 0.06085155 0.07266657
  0.07754321 0.08773097 0.33265136 0.1       ]
 [0.33073842 0.08788412 0.08076358 0.06791692 0.06513211 0.05340696
  0.05753319 0.03845716 0.11816754 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 0: logL = -457.1
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.94 0.06]
A:
[[0.75 0.25]
 [0.24 0.76]]
chi:
[[0.08142889 0.04141401 0.03442446 0.05813187 0.05719609 0.07955593
  0.07562229 0.09903799 0.37318849 0.1       ]
 [0.36588803 0.09309849 0.09104152 0.06777716 0.06869545 0.04675347
  0.0595295  0.0276355  0.07958088 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 1: logL = -415.8
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.99 0.01]
A:
[[0.8  0.2 ]
 [0.19 0.81]]
chi:
[[0.04841873 0.0345707  0.02175263 0.05825418 0.05210845 0.08873699
  0.07285512 0.11094039 0.41236282 0.1       ]
 [0.39414024 0.09904168 0.10250923 0.06754583 0.07343259 0.03834756
  0.06237055 0.01707979 0.04553254 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 2: logL = -408.5
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.68e-04]
A:
[[0.83 0.17]
 [0.16 0.84]]
chi:
[[0.02811748 0.02829178 0.0115426  0.05872067 0.04731604 0.09692629
  0.06979818 0.11990535 0.4393816  0.1       ]
 [0.40889061 0.10412094 0.11106182 0.06699694 0.077649   0.03131244
  0.06535347 0.00984973 0.02476503 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 3: logL = -400.6
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.92e-06]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.01877524 0.02410265 0.00600868 0.05939271 0.04451665 0.10121953
  0.06777144 0.12487109 0.45334201 0.1       ]
 [0.41523504 0.10753252 0.11557247 0.0663276  0.08005023 0.02774384
  0.06724961 0.00592611 0.01436258 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 4: logL = -396.1
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.08e-08]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.01454747 0.02179617 0.00332396 0.05980488 0.04328886 0.10278717
  0.06704606 0.12742524 0.45998018 0.1       ]
 [0.41854594 0.10953223 0.11788199 0.06593844 0.08112766 0.02640911
  0.06791747 0.00375033 0.00889682 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 5: logL = -394.5
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.63e-11]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.01221692 0.02059542 0.00192131 0.05988918 0.04280128 0.10330353
  0.06707472 0.12882961 0.46336802 0.1       ]
 [0.42076678 0.11065361 0.11919422 0.06586205 0.08158342 0.02591955
  0.06789127 0.00243479 0.00569431 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 6: logL = -394.0
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 7.76e-14]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.01065706 0.01997766 0.0011334  0.05980118 0.04262277 0.10347237
  0.06739586 0.12966194 0.46527777 0.1       ]
 [0.42241892 0.11127009 0.11998176 0.06594625 0.08176829 0.02572323
  0.06759592 0.00160154 0.00369401 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 7: logL = -393.7
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.08e-16]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[0.0094918  0.01966999 0.00067435 0.05965786 0.0425749  0.10351468
  0.06778054 0.13018587 0.46645003 0.1       ]
 [0.4236749  0.11159402 0.1204574  0.06608108 0.0818297  0.02564992
  0.06724137 0.00106201 0.00240959 0.1       ]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 8: logL = -393.5
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 9.95e-20]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[8.57321083e-03 1.95304292e-02 4.02627802e-04 5.95105542e-02
  4.25828459e-02 1.03502796e-01 6.81377814e-02 1.30533711e-01
  4.67226044e-01 1.00000000e-01]
 [4.24627926e-01 1.11746213e-01 1.20738617e-01 6.62185980e-02
  8.18323919e-02 2.56409968e-02 6.69117226e-02 7.08198513e-04
  1.57533558e-03 1.00000000e-01]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 9: logL = -393.4
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 6.01e-23]
A:
[[0.84 0.16]
 [0.15 0.85]]
chi:
[[7.82756278e-03 1.94812668e-02 2.40683546e-04 5.93749927e-02
  4.26129265e-02 1.03466152e-01 6.84397445e-02 1.30777103e-01
  4.67779568e-01 1.00000000e-01]
 [4.25346049e-01 1.11798271e-01 1.20896763e-01 6.63441440e-02
  8.18074954e-02 2.56691405e-02 6.66330663e-02 4.74225769e-04
  1.03084590e-03 1.00000000e-01]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 10: logL = -393.3
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.39e-26]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[7.21036699e-03 1.94783215e-02 1.43890900e-04 5.92529107e-02
  4.26491694e-02 1.03419430e-01 6.86843150e-02 1.30956771e-01
  4.68204824e-01 1.00000000e-01]
 [4.25882995e-01 1.11793837e-01 1.20976696e-01 6.64562091e-02
  8.17710303e-02 2.57182612e-02 6.64076213e-02 3.18597451e-04
  6.74752212e-04 1.00000000e-01]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 11: logL = -393.2
2023-03-15 16:35 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-03-15 16:35 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 6.22e-30]
A:
[[0.83 0.17]
 [0.15 0.85]]
chi:
[[6.69164300e-03 1.94962736e-02 8.59814708e-05 5.91419694e-02
  4.26840753e-02 1.03370573e-01 6.88784920e-02 1.31096574e-01
  4.68554419e-01 1.00000000e-01]
 [4.26281324e-01 1.11759660e-01 1.21007019e-01 6.65571222e-02
  8.17313774e-02 2.57781437e-02 6.62290239e-02 2.14641252e-04
  4.41689358e-04 1.00000000e-01]]

2023-03-15 16:35 - DEBUG - TrainingManager : 134 - 12: logL = -393.2
2023-03-15 16:35 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -3.932e+02
2023-03-15 16:35 - INFO - TrainingManager : 71 -  >> BIC: 8.765e+02
2023-03-15 16:35 - INFO - TrainingManager : 75 - Optimal k=6
2023-03-15 16:35 - INFO - cli : 125 - Training phase done in 00:00:03
2023-03-15 16:35 - INFO - cli : 155 - Process done in 00:00:03
2023-03-15 16:35 - INFO - cli : 156 - Output written to  -> /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/3_repartbig/HDSL
