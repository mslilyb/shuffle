2023-03-15 16:21 - INFO - cli : 40 - Summarizing job ... 

       Input files:
              probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/2_repart.shape
              fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/2_repart.fa

       Configuration parameters:
              log: False
              training: True
              scoring: False
              k: auto
              DOM: True

       Using 2 parallel processes

2023-03-15 16:21 - DEBUG - cli : 41 - Summarizing configuration:
=========================================================
Running patteRNA with the following parameters:
=========================================================
Input files:
	probing: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/2_repart.shape
	fasta: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/data/2_repart.fa

Configuration parameters:
	output: /home/ashtoreth/Code/shuffle/AviranLab/testouts/invivo/repart/2_repart/HDSL
	verbose: True
	log: False
	no_vienna: False
	GMM: False
	k: -1
	KL_div: 0.001
	epsilon: 0.01
	maxiter: 250
	n_tasks: 2
	motif: None
	path: None
	hairpins: False
	posteriors: False
	viterbi: False
	HDSL: False
	SPP: False
	nan: False
	print_nan: False
	no_prompt: False
	min_cscores: 1000
	no_cscores: False
	batch_size: 100
	context: 40
	training: True
	scoring: False
	reference: False
	hdsl_params: (1.2, 0.5)
=========================================================
2023-03-15 16:21 - INFO - cli : 50 - Loading input data
2023-03-15 16:21 - INFO - cli : 66 -  ... done in 00:00:00
2023-03-15 16:21 - INFO - cli : 104 - Spawning training set
2023-03-15 16:21 - INFO - Dataset : 102 -  ... sorting
2023-03-15 16:21 - INFO - Dataset : 105 -  ... selecting
2023-03-15 16:21 - INFO - cli : 107 -  ... done in 00:00:00
2023-03-15 16:21 - INFO - cli : 109 - Training set summary: 
       Passed QC                  1
       Used transcripts           1
       # Data points (in DOM)     54
       KL div                     0
2023-03-15 16:21 - INFO - TrainingManager : 104 - Training with k=6
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #1
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.67 0.33]
A:
[[0.72 0.28]
 [0.28 0.72]]
chi:
[[0.12600442 0.04807046 0.05236    0.07618507 0.07405675 0.08634713
  0.09048376 0.34649241 0.1       ]
 [0.33924123 0.08501666 0.11389658 0.05727429 0.05937443 0.08035944
  0.04316491 0.12167247 0.1       ]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 0: logL = -117.1
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #2
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.87 0.13]
A:
[[0.76 0.24]
 [0.23 0.77]]
chi:
[[0.08114747 0.04256026 0.02783178 0.09518525 0.08210115 0.07600623
  0.10203426 0.39313358 0.1       ]
 [0.38208734 0.09022946 0.13758331 0.03879119 0.05158023 0.0904952
  0.03209662 0.07713665 0.1       ]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 1: logL = -106.3
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #3
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.82 0.18]
 [0.17 0.83]]
chi:
[[0.03575895 0.03704475 0.00811993 0.11564627 0.09526427 0.06476972
  0.11428709 0.42910901 0.1       ]
 [0.43124892 0.09633973 0.15867663 0.01760247 0.03801968 0.101929
  0.01896401 0.03721955 0.1       ]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 2: logL = -102.5
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #4
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 4.3e-04]
A:
[[0.87 0.13]
 [0.14 0.86]]
chi:
[[0.01118041 0.03741093 0.00121639 0.12513931 0.11087974 0.05676178
  0.12073541 0.43667603 0.1       ]
 [0.47182809 0.09807449 0.1714909  0.0038927  0.01920123 0.11185953
  0.00862056 0.01503251 0.1       ]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 3: logL = -98.0
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #5
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.51e-06]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[3.02080735e-03 4.08914052e-02 1.27010138e-04 1.25136959e-01
  1.20206860e-01 5.31689791e-02 1.22723432e-01 4.34724547e-01
  1.00000000e-01]
 [4.94309606e-01 9.58736394e-02 1.77617724e-01 4.11655498e-04
  5.99814647e-03 1.17513761e-01 3.14651835e-03 5.12894876e-03
  1.00000000e-01]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 4: logL = -95.3
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #6
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 4.27e-09]
A:
[[0.89 0.11]
 [0.12 0.88]]
chi:
[[7.80784555e-04 4.29456398e-02 1.19082325e-05 1.24235071e-01
  1.23014701e-01 5.20460854e-02 1.23394259e-01 4.33571551e-01
  1.00000000e-01]
 [5.02506784e-01 9.41231305e-02 1.79775688e-01 3.27549092e-05
  1.44530043e-03 1.19547499e-01 1.00597290e-03 1.56287011e-03
  1.00000000e-01]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 5: logL = -94.3
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #7
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.16e-12]
A:
[[0.89 0.11]
 [0.12 0.88]]
chi:
[[1.99648589e-04 4.37945409e-02 1.09181345e-06 1.23871848e-01
  1.23600361e-01 5.17587020e-02 1.23609526e-01 4.33164282e-01
  1.00000000e-01]
 [5.05016327e-01 9.33207626e-02 1.80444795e-01 2.44852695e-06
  3.18826448e-04 1.20128919e-01 3.08145309e-04 4.59776219e-04
  1.00000000e-01]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 6: logL = -94.0
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #8
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 3.22e-16]
A:
[[0.89 0.11]
 [0.12 0.88]]
chi:
[[5.09432578e-05 4.41201449e-02 9.97667370e-08 1.23751819e-01
  1.23693354e-01 5.16946409e-02 1.23671913e-01 4.33017085e-01
  1.00000000e-01]
 [5.05770501e-01 9.29974605e-02 1.80653453e-01 1.80685719e-07
  6.84584312e-05 1.20282354e-01 9.34983471e-05 1.34094333e-04
  1.00000000e-01]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 7: logL = -94.0
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #9
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 1.4e-20]
A:
[[0.89 0.11]
 [0.12 0.88]]
chi:
[[1.29948545e-05 4.42430326e-02 9.11593002e-09 1.23712182e-01
  1.23699719e-01 5.16848215e-02 1.23687960e-01 4.32959281e-01
  1.00000000e-01]
 [5.06004831e-01 9.28722085e-02 1.80721424e-01 1.32950386e-08
  1.45785368e-05 1.20319595e-01 2.83208528e-05 3.90277682e-05
  1.00000000e-01]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 8: logL = -93.9
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=6) EM iteration #10
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.76e-25]
A:
[[0.89 0.11]
 [0.12 0.88]]
chi:
[[3.31477896e-06 4.42894027e-02 8.33198493e-10 1.23698576e-01
  1.23695927e-01 5.16862344e-02 1.23691239e-01 4.32935305e-01
  1.00000000e-01]
 [5.06081250e-01 9.28242617e-02 1.80744686e-01 9.77558222e-10
  3.09654351e-06 1.20326775e-01 8.57646942e-06 1.13531295e-05
  1.00000000e-01]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 9: logL = -93.9
2023-03-15 16:21 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=6: -9.394e+01
2023-03-15 16:21 - INFO - TrainingManager : 71 -  >> BIC: 2.477e+02
2023-03-15 16:21 - INFO - TrainingManager : 104 - Training with k=7
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #1
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.68 0.32]
A:
[[0.72 0.28]
 [0.27 0.73]]
chi:
[[0.12483059 0.04762047 0.03298877 0.05923484 0.07343291 0.06518153
  0.05934708 0.09109139 0.34627242 0.1       ]
 [0.34037805 0.08545692 0.06678264 0.07399863 0.05999134 0.06813185
  0.04077852 0.04257016 0.12191189 0.1       ]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 0: logL = -123.4
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #2
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.88 0.12]
A:
[[0.75 0.25]
 [0.23 0.77]]
chi:
[[0.08204958 0.04270508 0.02166576 0.05712123 0.0869548  0.05569726
  0.06159544 0.10083416 0.39137669 0.1       ]
 [0.38019153 0.0899273  0.07750537 0.07593286 0.04697203 0.07731519
  0.03874377 0.03349868 0.07991327 0.1       ]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 1: logL = -110.6
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #3
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[0.98 0.02]
A:
[[0.8  0.2 ]
 [0.18 0.82]]
chi:
[[0.03834304 0.03643616 0.01037935 0.05606568 0.10688103 0.04499393
  0.06509921 0.11174655 0.43005505 0.1       ]
 [0.42177758 0.0958823  0.08829054 0.07691177 0.02780234 0.08761183
  0.03540768 0.02310017 0.04321579 0.1       ]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 2: logL = -107.9
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #4
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[9.99e-01 5.66e-04]
A:
[[0.84 0.16]
 [0.14 0.86]]
chi:
[[0.01237922 0.03235451 0.00358821 0.05717199 0.12377162 0.03818517
  0.06776459 0.12026415 0.44452054 0.1       ]
 [0.45309643 0.10079387 0.09616162 0.07611016 0.00986952 0.09499464
  0.03233117 0.01335809 0.02328449 0.1       ]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 3: logL = -104.6
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #5
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 5.66e-06]
A:
[[0.86 0.14]
 [0.13 0.87]]
chi:
[[0.00328817 0.03175958 0.00104621 0.05879071 0.12943356 0.03736119
  0.06845394 0.12490227 0.44496437 0.1       ]
 [0.47051921 0.10265729 0.10047334 0.0747871  0.00195146 0.0968818
  0.03097324 0.00662341 0.01513316 0.1       ]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 4: logL = -102.5
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #6
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.99e-08]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[8.32904397e-04 3.30938523e-02 2.87797023e-04 5.93502615e-02
  1.29207755e-01 3.94194895e-02 6.85333403e-02 1.26603906e-01
  4.42670695e-01 1.00000000e-01]
 [4.80189629e-01 1.02312453e-01 1.02781710e-01 7.44348273e-02
  2.63944795e-04 9.55962357e-02 3.03223085e-02 3.02856998e-03
  1.10703218e-02 1.00000000e-01]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 5: logL = -101.7
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #7
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 1.12e-10]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[2.11680179e-04 3.51259107e-02 7.79692395e-05 5.91328762e-02
  1.27864672e-01 4.21013304e-02 6.87731206e-02 1.26659126e-01
  4.40053314e-01 1.00000000e-01]
 [4.87177553e-01 1.01011132e-01 1.04359682e-01 7.48701481e-02
  2.86696181e-05 9.34156560e-02 2.95581059e-02 1.34137927e-03
  8.23767356e-03 1.00000000e-01]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 6: logL = -101.5
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #8
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.0e+00 3.1e-13]
A:
[[0.87 0.13]
 [0.13 0.87]]
chi:
[[5.45133800e-05 3.72483336e-02 2.11631418e-05 5.86546921e-02
  1.26551685e-01 4.46085470e-02 6.92737028e-02 1.26027375e-01
  4.37559988e-01 1.00000000e-01]
 [4.93019354e-01 9.94151599e-02 1.05636449e-01 7.55855981e-02
  2.65382667e-06 9.12217692e-02 2.85445109e-02 5.86316892e-04
  5.98818750e-03 1.00000000e-01]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 7: logL = -101.4
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #9
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 6.33e-16]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[1.42180204e-05 3.91638029e-02 5.80246988e-06 5.81581347e-02
  1.25439694e-01 4.67019716e-02 6.99712953e-02 1.25215557e-01
  4.35329524e-01 1.00000000e-01]
 [4.97988024e-01 9.78632615e-02 1.06708594e-01 7.63179244e-02
  2.15528229e-07 8.93126903e-02 2.73464897e-02 2.54455276e-04
  4.20834567e-03 1.00000000e-01]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 8: logL = -101.3
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #10
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 9.17e-19]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[3.74564178e-06 4.07525082e-02 1.61355791e-06 5.77245172e-02
  1.24539662e-01 4.83455377e-02 7.07835507e-02 1.24444301e-01
  4.33404563e-01 1.00000000e-01]
 [5.02116761e-01 9.65184159e-02 1.07595515e-01 7.69675532e-02
  1.57478054e-08 8.77716448e-02 2.60584414e-02 1.09866827e-04
  2.86178660e-03 1.00000000e-01]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 9: logL = -101.3
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #11
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 9.09e-22]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[9.93892292e-07 4.20029726e-02 4.55825378e-07 5.73700303e-02
  1.23828618e-01 4.95913309e-02 7.16397962e-02 1.23788122e-01
  4.31777680e-01 1.00000000e-01]
 [5.05463458e-01 9.54313641e-02 1.08313315e-01 7.75091192e-02
  1.06036654e-09 8.65812369e-02 2.47620049e-02 4.72310087e-05
  1.89226998e-03 1.00000000e-01]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 10: logL = -101.3
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #12
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.e+00 6.e-25]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[2.64997179e-07 4.29583054e-02 1.30826113e-07 5.70875156e-02
  1.23272600e-01 5.05223056e-02 7.24881689e-02 1.23255429e-01
  4.30415280e-01 1.00000000e-01]
 [5.08137349e-01 9.45887821e-02 1.08886488e-01 7.79483474e-02
  6.72015113e-11 8.56804108e-02 2.35149452e-02 2.02234207e-05
  1.22345440e-03 1.00000000e-01]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 11: logL = -101.3
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #13
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 2.58e-28]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[7.08674084e-08 4.36789913e-02 3.81177416e-08 5.68634284e-02
  1.22837137e-01 5.12197749e-02 7.32956823e-02 1.22829868e-01
  4.29275009e-01 1.00000000e-01]
 [5.10268006e-01 9.39498937e-02 1.09343117e-01 7.83017698e-02
  4.07680117e-12 8.50000147e-02 2.23512109e-02 8.62708143e-06
  7.77360536e-04 1.00000000e-01]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 12: logL = -101.3
2023-03-15 16:21 - DEBUG - TrainingManager : 113 - (k=7) EM iteration #14
2023-03-15 16:21 - DEBUG - TrainingManager : 133 - Current model parameters
pi:
[1.00e+00 7.06e-32]
A:
[[0.88 0.12]
 [0.13 0.87]]
chi:
[[1.89847240e-08 4.42229149e-02 1.12606445e-08 5.66844361e-02
  1.22492591e-01 5.17498086e-02 7.40447075e-02 1.22489520e-01
  4.28315992e-01 1.00000000e-01]
 [5.11977251e-01 9.34687328e-02 1.09709402e-01 7.85873298e-02
  2.39742353e-13 8.44802043e-02 2.12860913e-02 3.66743345e-06
  4.87320921e-04 1.00000000e-01]]

2023-03-15 16:21 - DEBUG - TrainingManager : 134 - 13: logL = -101.3
2023-03-15 16:21 - INFO - TrainingManager : 151 -  >> Log-likelihood of converged model with k=7: -1.013e+02
2023-03-15 16:21 - INFO - TrainingManager : 71 -  >> BIC: 2.703e+02
2023-03-15 16:21 - INFO - TrainingManager : 75 - Optimal k=6
